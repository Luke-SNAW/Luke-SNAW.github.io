<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>What&#x27;s Functional Programming All About?</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="What&#x27;s Functional Programming All About?"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://luke-snaw.github.io//notes/ibhefhzrpmuguq2tbmg1383/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="9/6/2024"/><meta property="article:modified_time" content="9/6/2024"/><link rel="canonical" href="https://luke-snaw.github.io//notes/ibhefhzrpmuguq2tbmg1383/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_buildManifest.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="whats-functional-programming-all-about">What's Functional Programming All About?<a aria-hidden="true" class="anchor-heading icon-link" href="#whats-functional-programming-all-about"></a></h1>
<blockquote>
<p><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html">https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html</a></p>
</blockquote>
<p>There are many descriptions floating around the internet, trying to explain functional programming in simple terms. Unfortunately, most discuss details only loosely related to functional programming, while others focus on topics that are completely irrelevant. So of course, I had to write my own!</p>
<p>This post is my own understanding of what is the "core" of "functional programming", how it differs from "imperative" programming, and what the main benefits of the approach are. As a worked example, we will use a kitchen recipe as a proxy for the more-abstract kind of logic you find in program source code, to try and make concrete what is normally a very abstract topic. That recipe is one of my favorite recipes available online, <a href="http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe">Michael Chu's Classic Tiramisu</a>.</p>
<hr>
<p>A topic as broad as "Functional Programming", or "FP" has too many different interpretations and facets to be summarized in one blog post. Nevertheless, this post will discuss what <em>I</em> think is the most core, basic level of functional programming. This will hopefully be something that everyone, from FP newbies to FP "experts", should be able to empathise with and agree is a useful part of functional programming.</p>
<p>It's not surprising that many people have tried to explain functional programming using kitchen/recipe/cookbook examples: learning things "by analogy" of things you already know is one of the easiest ways of learning. However, all explanations I have seen fall short. I will begin by examining some typical, <em>incorrect</em> explanations of what functional programming is about, before discussing how <a href="http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe">Michael Chu's Classic Tiramisu</a> recipe:</p>
<p><a href="https://www.lihaoyi.com/post/BasicFunctionalProgramming/Tiramisu.jpg">image - Tiramisu</a></p>
<p>Can provide insight into what I think are the core techniques and benefits of functional programming.</p>
<h2 id="what-functional-programming-is-not"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#what-functional-programming-is-not">What Functional Programming is Not</a><a aria-hidden="true" class="anchor-heading icon-link" href="#what-functional-programming-is-not"></a></h2>
<p>There are many poor explanations people have given for "what is functional programming". Here is a selection:</p>
<h3 id="helper-methods"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#helper-methods">Helper Methods</a><a aria-hidden="true" class="anchor-heading icon-link" href="#helper-methods"></a></h3>
<p>One of the most common misconceptions of what FP is is illustrated by the following example:</p>
<blockquote>
<p>FP => I'll have a Sazerac</p>
<p>Imperative => Excuse me sir, could you take some ice, add rye whiskey, add bitters, add absinthe, shake, strain into a glass, and add a lemon garnish before bringing it to me</p>
</blockquote>
<p>While this example was taken from the <a href="https://news.ycombinator.com/item?id=13281413">y-combinator message board</a>, I've seen this attitude in many places: the idea that functional programming is just taking imperative instructions, and wrapping them in a helper. In this case, the messy imperative code will all sit inside a single helper:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">sazerac</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">10000</span> lines of messy imperative code <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>But even in imperative programming you always end up factoring things into helper methods. Java has helper methods. Write assembly, and it ends up being organized with sub-procedures to encapsulate messes of imperative code.</p>
<p>Thus, while this is a useful technique, writing helper methods to wrap your messy code in a single method/function/subprocess/subroutine call does not count as functional programming.</p>
<p>Furthermore, <em>picking an easier/simpler problem</em>, despite making your code look neater, does not count as "Functional Programming" either. Calling a single method that executes a huge blob of code that <em>someone else</em> has written is convenient, but is not functional programming. The point of FP is to face the complexity, own it, and control it, not shove it inside some unmaintained helper function or say it's a problem for some "other department" to deal with.</p>
<h3 id="writing-things-in-haskell"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#writing-things-in-haskell">Writing Things in Haskell</a><a aria-hidden="true" class="anchor-heading icon-link" href="#writing-things-in-haskell"></a></h3>
<pre class="language-none"><code class="language-none">sazerac = do
    add ice
    add ryeWhisky
    add bitters
    add absinthe
    shake
    strainInto glass
    add lemonGarnish

main = serve $ makeCocktail sazerac
</code></pre>
<ul>
<li>Also from the <a href="https://news.ycombinator.com/item?id=13281413">y-combinator message board</a></li>
</ul>
<p>It's often said that you can write COBOL in any language, that you can write Java in any language. Well, you can write any language in Haskell too: the above is basically writing Bash in Haskell</p>
<p>Just because something is implemented in Haskell with Monads, doesn't mean it's functional programming. If it looks like imperative code written in Bash, and it's semantics are like imperative code written in Bash, it's imperative code. This example certainly looks exactly like imperative code written in Bash except it's run using <code>serve $ makeCocktail</code> instead of <code>bash cocktail.sh</code>.</p>
<h3 id="compile-time-ast-macros"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#compile-time-ast-macros">Compile-time AST Macros</a><a aria-hidden="true" class="anchor-heading icon-link" href="#compile-time-ast-macros"></a></h3>
<p>Some variant of Lisp (or <a href="https://en.wikipedia.org/wiki/Scheme_(programming_language)">Scheme</a>?) was probably one of the first implemented FP languages; and Lisps tend to have compile-time AST macros that allow you to transform sections of the program at compile-time.</p>
<p>But compile-time code-transformations are not unique to Lisp; apart from other FP languages that have them, like <a href="https://wiki.haskell.org/Template_Haskell">Template Haskell</a> or <a href="http://docs.scala-lang.org/overviews/macros/overview.html">Scala Macros</a>, many languages have some sort of compile-time code transformation. From <a href="http://hannesdorfmann.com/annotation-processing/annotationprocessing101">Java Annotation Processors</a>, to my own <a href="https://github.com/lihaoyi/macropy">MacroPy</a> project in Python, it turns out that compile-time ast macros are just as feasible in imperative languages, doing imperative programming. You can manipulate mutable ASTs using imperative Python code just as easily as you can elegantly transform immutable ASTs using Scala.</p>
<p>Furthermore, there are a large set of "obviously" functional programming languages that don't have AST-transforming macros at all. Purescript, non-Template Haskell, Scala 2.9, and many other "obviously" functional languages do not include support for compile-time AST transformations. So whatever is the core of functional programming, it's not AST macros.</p>
<h3 id="static-types"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#static-types">Static Types</a><a aria-hidden="true" class="anchor-heading icon-link" href="#static-types"></a></h3>
<p>There are a large number of people who use FP together with static types, e.g. in languages like Haskell, Scala, or Ocaml. Thus, if you spend all your time within this world, it might be tempting to think that FP is all about static types. <a href="http://stackoverflow.com/questions/6246719/what-is-a-higher-kinded-type-in-scala">Higher-kinded</a>, <a href="https://wiki.haskell.org/Rank-N_types">Rank-N</a>, <a href="https://en.wikipedia.org/wiki/Dependent_type">Dependent</a>, the fancier the types, the more functional the programming.</p>
<p>However, there are probably just as many people using FP without static types: in some parts of the Javascript community, Clojure, Scheme or one of the many other Lisps. It turns out, that all those using FP without types still get many of the benefits. And then there are all those people in static-typed languages like Java that use minimal FP in their code.</p>
<p>So static types, while present in many FP languages, are not the core of FP.</p>
<h2 id="step-by-step-imperative-recipes">Step by Step Imperative Recipes<a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#step-by-step-imperative-recipes"></a><a aria-hidden="true" class="anchor-heading icon-link" href="#step-by-step-imperative-recipes"></a></h2>
<p>Now that we've looked at a few common misconceptions of what FP is, let's look at what the core of FP <em>actually is</em> (according to me) in contrast to "imperative" programming, using <a href="http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe">Michael Chu's Classic Tiramisu</a>:</p>
<p><a href="https://www.lihaoyi.com/post/BasicFunctionalProgramming/Tiramisu.jpg">Tiramisu</a></p>
<p>As an example. To begin with, we'll explore an "imperative" recipe, that is probably familiar to those you already know.</p>
<p>Michael Chu's Classic Tiramisu, like all the other recipe's on his excellent recipe site has roughly four sections on the page:</p>
<ol>
<li>The backstory of the recipe</li>
<li>A step-by-step guide, with photos, of how to make the Tiramisu</li>
<li>A diagram of the overall process, showing which ingredients are combined with which others, to create the resultant Tiramisu</li>
<li>A lively and entertaining comments section</li>
</ol>
<p>For the purpose of this programming blog we will only be looking at parts <code>2.</code> and <code>3.</code>: the step by step guide, and the process diagram. The step by step guide details, in order, a series of steps that you can take to make a Tiramisu. At a high level, hiding many of the details, it looks like this:</p>
<ol>
<li>
<p>Begin by assembling four large egg yolks, 1/2 cup sweet marsala wine, 16 ounces mascarpone cheese, 12 ounces espresso, 2 tablespoons cocoa powder, 1 cup heavy cream, 1/2 cup granulated sugar, and enough lady fingers to layer a 12x8 inch pan twice (40).</p>
</li>
<li>
<p>Stir two tablespoons of granulated sugar into the espresso and put it in the refrigerator to chill.</p>
</li>
<li>
<p>Whisk the egg yolks</p>
</li>
<li>
<p>Pour in the sugar and wine and whisked briefly until it was well blended.</p>
</li>
<li>
<p>Pour some water into a saucepan and set it over high heat until it began to boil.</p>
</li>
<li>
<p>Lowering the heat to medium, place the heatproof bowl over the water and stirred as the mixture began to thicken and smooth out.</p>
</li>
<li>
<p>Whip the heavy cream until soft peaks.</p>
</li>
<li>
<p>Beat the mascarpone cheese until smooth and creamy.</p>
</li>
<li>
<p>Poured the mixture onto the cheese and beat</p>
</li>
<li>
<p>Fold in the whipped cream</p>
</li>
<li>
<p>Assemble the tiramisu.</p>
<ul>
<li>Give the each ladyfinger cookie a one second soak on each side and then arrange it on the pan</li>
<li>After the first layer of ladyfingers are done, use a spatula to spread half the cream mixture over it.</li>
<li>Cover the cream layer with another layer of soaked ladyfingers.</li>
<li>The rest of the cream is spread onto the top and cocoa powder sifted over the surface to cover the tiramisu.</li>
</ul>
</li>
<li>
<p>The tiramisu was now complete and would require a four hour chill in the refrigerator.</p>
</li>
</ol>
<p>This is, I think, something like what most people would think of when told "imperative recipe". You start with a set of inputs (the bullet <code>1.</code>) and then perform a series of steps until you have a result at the end. (For now, I'm ignoring the pictures in the recipe, though you could think of them as a sort of <code>assert</code> function for a would-be chef to check some invariants after each step to make sure his tiramisu hasn't gone terribly wrong!)</p>
<p>A simplified Python version of this recipe (ignoring the fact that I'm overloading the same functions to work on different types/number of arguments) may look something like this:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> whisk<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span> <span class="token comment"># over steam</span>
    whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cheese<span class="token punctuation">)</span>
    fold<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cream<span class="token punctuation">)</span>
    assemble<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> fingers<span class="token punctuation">)</span>
    sift<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    refrigerate<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    <span class="token keyword">return</span> mixture <span class="token comment"># it's now a tiramisu</span>
</code></pre>
<h3 id="kitchen-refactoring"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#kitchen-refactoring">Kitchen Refactoring</a><a aria-hidden="true" class="anchor-heading icon-link" href="#kitchen-refactoring"></a></h3>
<p>Like most imperative code, it works, but may be hard to understand deeply or difficult to refactor. For example, in cooking terms, you may ask the following questions:</p>
<ul>
<li>If I have two people to make this tiramisu, which parts can be done in parallel?</li>
<li>My expresso hasn't arrived yet; can I shift that step down and do other things first and include the expresso later when it arrives?
<ul>
<li>What if my eggs haven't arrived? Which steps can I do first before the eggs turn up?</li>
</ul>
</li>
<li>At step 9. I screwed up and spilled the bowl onto the floor. Which steps do I need to re-do (and which ingredients I may have to re-purchase) to recover and continue the recipe?
<ul>
<li>What if I spilled the bowl at step 10? Or step 8?</li>
</ul>
</li>
<li>Just before step 10, you realize you forgot to do step 7. How much of your ingredients have been ruined?
<ul>
<li>What if the forgotten step was step 4? Or step 2?</li>
</ul>
</li>
</ul>
<p>All four of these are things that happen regularly in a kitchen, and also happen to correspond to things you do with program code all the time: parallelizing things over the available cores to speed things up, shuffling the order of a computation around, dealing with failures and exceptions, or plain old bugs and mistakes.</p>
<p>The answers to these questions are left as an exercise to the reader; in this case, with 12 steps, it's not terribly hard to figure out. A few minutes carefully studying the recipe and you could probably figure it out, so you should definitely give it a try.</p>
<hr>
<p>In a large software project, with a codebase containing thousands or millions of lines of imperative code, that time could easily stretch to days, weeks, or months trying to figure out how to properly recover when one of those imperative steps fails, or how to make your legacy PHP monolith do something faster by using more than 1 of the 32 cores you have available on your beefy server.</p>
<p><strong>The problem in these cases often isn't that you don't know how to run stuff in a separate process in PHP - the problem is that you don't know enough about your own code to decide what to run in that other process</strong>. To move things onto a separate process, you need to know exactly what each bit of code depends on, and who depends on it, so you can pick a set with minimal dependencies to run somewhere else (since inter-process communication is expensive). That's difficult when you have a pile of imperative code and don't even understand it enough to easily move things around <em>within</em> a single process.</p>
<p>The reason that these kinds of analyses are hard on this imperative recipe is the same reason that the analyses are hard when programming in an imperative style:</p>
<ul>
<li>There is an ordering of the steps, but the ordering between some steps is required, e.g. the series 9, 10, 11, while those between other steps is entirely arbitrary: step 2 could be done anywhere before step 11, and step 7 and 8 could be swapped or done much earlier and nobody would care.</li>
<li>The instructions are based on changing the state of things, e.g. pouring stuff into <code>mixture</code>, a term that we use repeatedly throughout the recipe but means a different thing in each step. Even the meaning of <code>cheese</code> and <code>cream</code> changes as the recipe progresses (e.g. after calling <code>whip(cream)</code>), but it is entirely hidden from you and not obvious from the code.</li>
</ul>
<p>Overall, these factors make it hard to decide, given a single step <em>S</em>, what steps <em>S</em> depends on, and what <em>other</em> steps depend on <em>S</em>. Again, it is possible to figure it out, but what is somewhat-tedious to figure out in a 16-line tiramisu recipe becomes painful and difficult in a 1,000,000 line enterprise codebase.</p>
<p>So that's what an imperative Tiramisu recipe looks like. What does a "functional programming" Tiramisu recipe look like?</p>
<h2 id="functional-programming-recipes"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#functional-programming-recipes">"Functional Programming" Recipes</a><a aria-hidden="true" class="anchor-heading icon-link" href="#functional-programming-recipes"></a></h2>
<p>It turns out, there's a FP version of this recipe right underneath the imperative one! The "process diagram" mentioned above is an excellent illustration of how such a recipe would look like using "Functional Programming":</p>
<p><img src="/assets/images/dev/FP/TiramisuDiagram.avif" alt="TiramisuDiagram"></p>
<p>To read this, the raw ingredients are on the left, and each of the boxes represents a single operation that transforms and combines the ingredients. After all the combinations have taken place, you end up on the right with a single, complete Tiramisu. While this "2D" format is not how people write program source code, the underlying structure is not too different from how people structure "FP" programs, which I will demonstrate below.</p>
<p>This diagram leaves out some the <em>detail</em> that the full imperative recipe provides, even compared to the abridged version I transcribed above. For example, chilling the expresso or explicitly boiling the water are left out, and the details of <em>assemble</em> are not included. Nevertheless, it contains the same high-level steps of how to build the tiramisu I abridged above. We're not leaving out large numbers of operations or hiding things behind high-level instructions: all the same steps are still there, just organized slightly differently.</p>
<p>But even if this diagram has the same "content" as the imperative instruction-list I discussed earlier, what about this makes this presentation of the recipe more "functional"?</p>
<h3 id="tiramisu-diagram-to-functional-programming"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#tiramisu-diagram-to-functional-programming">Tiramisu Diagram to Functional Programming</a><a aria-hidden="true" class="anchor-heading icon-link" href="#tiramisu-diagram-to-functional-programming"></a></h3>
<p>While nobody actually writes their code in a 2D table-flowchart-thing like this tiramisu diagram is, it turns out underneath the 2D format the "core" of this diagram is the dependency graph between elements:</p>
<p><img src="/assets/images/dev/FP/DiagramGraph.avif" alt="TiramisuDiagram"></p>
<p>Where each box takes in some "inputs" from the left, and results in an "output" that can be used by more-rightward boxes. This can be straightforwardly represented in code by treating the boxes as functions, e.g. in the following Python code:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">return</span> refrigerate<span class="token punctuation">(</span>
        sift<span class="token punctuation">(</span>
            assemble<span class="token punctuation">(</span>
                fold<span class="token punctuation">(</span>
                    beat<span class="token punctuation">(</span>
                        whisk<span class="token punctuation">(</span> <span class="token comment"># over steam</span>
                            beat<span class="token punctuation">(</span>beat<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span><span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
                        <span class="token punctuation">)</span><span class="token punctuation">,</span>
                        beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                soak2seconds<span class="token punctuation">(</span>fingers<span class="token punctuation">,</span> dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            cocoa
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
</code></pre>
<p>(Again, forgive the fact that I'm overloading the same functions to work on different types and numbers of arguments)</p>
<p>If it's not immediately clear how this code relates to the "functional programming dependency diagram" I discussed above, we can draw the dependency graph <em>of this code</em>: showing where the input variables go, where the return value of each function goes, all the way into the "final" result that gets returned:</p>
<p><img src="/assets/images/dev/FP/CodeGraph.avif" alt="TiramisuDiagram"></p>
<p>It might look like a bit of a mess, but if you look carefully, you will see that <strong>although the graphs are laid out differently, the fundamental structure of the two graphs is identical!</strong> That is what I mean when I say the 2D box-diagram is a "FP Recipe": although people don't tend to write code in 2D box-diagrams, the underlying structure that the diagram represents is totally equivalent to some "FP"-ish Python code, not too dissimilar to what people <em>do</em> write.</p>
<p>This code looks very unlike code you are likely to see in a Python project, "in the wild", but we can fix that! If you prefer to have intermediate named values instead of one big expression, it's straightforward to pull out each function call into it's own statement:</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># FP</span>
<span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    beat_eggs <span class="token operator">=</span> beat<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>beat_eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisked <span class="token operator">=</span> whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    beat_cheese <span class="token operator">=</span> beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    cheese_mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>whisked<span class="token punctuation">,</span> beat_cheese<span class="token punctuation">)</span>
    whipped_cream <span class="token operator">=</span> whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    folded_mixture <span class="token operator">=</span> fold<span class="token punctuation">(</span>cheese_mixture<span class="token punctuation">,</span> whipped_cream<span class="token punctuation">)</span>
    sweet_espresso <span class="token operator">=</span> dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    wet_fingers <span class="token operator">=</span> soak2seconds<span class="token punctuation">(</span>fingers<span class="token punctuation">,</span> sweet_espresso<span class="token punctuation">)</span>
    assembled <span class="token operator">=</span> assemble<span class="token punctuation">(</span>folded_mixture<span class="token punctuation">,</span> wet_fingers<span class="token punctuation">)</span>
    complete <span class="token operator">=</span> sift<span class="token punctuation">(</span>assembled<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    ready_tiramisu <span class="token operator">=</span> refrigerate<span class="token punctuation">(</span>complete<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ready_tiramisu
</code></pre>
<p>That makes it look entirely "pythonic", indistinguishable from the code you might find in any random project on Github</p>
<p>Moving every expression into a separate statement is a straightforward transformation, at least for FP programs, and is the kind of thing that compilers regularly do automatically. Thus, although that block-flow-chart diagram may have looked a bit foreign at first, it really isn't <em>that</em> different from the code people write day to day, all year round.</p>
<p>In fact, it looks not too unlike the "Imperative" version we came up with earlier!</p>
<pre class="language-python"><code class="language-python"><span class="token comment"># Imperative</span>
<span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> whisk<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span> <span class="token comment"># over steam</span>
    whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cheese<span class="token punctuation">)</span>
    fold<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cream<span class="token punctuation">)</span>
    soak2seconds<span class="token punctuation">(</span>fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    assemble<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> fingers<span class="token punctuation">)</span>
    sift<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    refrigerate<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    <span class="token keyword">return</span> mixture <span class="token comment"># it's now a tiramisu</span>
</code></pre>
<p>These two snippets of code look very similar, but the top one is "Functional Programming" while the bottom one is "Imperative Programming". The difference between them?</p>
<ul>
<li>In the first, you can see that <code>beat(cheese)</code> must come before <code>beat(whisked, beat_cheese)</code>, because <code>beat_cheese</code> is defined by the <code>beat(cheese)</code> and used by <code>beat(whisked, beat_cheese)</code>. Even if you know nothing about <code>beat</code>, <code>cheese</code> or <code>whisked</code>, it is clear from the code that if you tried to reverse the order - and <code>beat(whisked, beat_cheese)</code> <em>before</em> <code>beat(cheese)</code>, it wouldn't work.</li>
<li>In the second, it's not so clear: does <code>beat(cheese)</code> <em>need</em> to come before <code>beat(mixture, cheese)</code>? Or does <code>beat(mixture, cheese)</code> need to come before <code>beat(cheese)</code>? In this case, we have a link to the "docs" (the original recipe) so we can look it up, but which one depends on the other - and whether they are currently in the right order - is not clear from the code.</li>
</ul>
<p>But how does this seemingly-trivial difference affect the way you build software?</p>
<h3 id="preventing-errors-with-functional-programming"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#preventing-errors-with-functional-programming">Preventing Errors with Functional Programming</a><a aria-hidden="true" class="anchor-heading icon-link" href="#preventing-errors-with-functional-programming"></a></h3>
<p>The difference between the two Python snippets, the <code># FP</code> and <code># Imperative</code> snippets, will become clear with the following thought experiment: what if we try to make changes to the code?</p>
<p>Changing code is something we do all day, and sometimes we do it incorrectly. It would be a nice property of a codebase if changes tended to be easier to make correctly, and incorrect changes were easier to spot. We'll discuss the latter first.</p>
<p>If I try to tidy things up and accidentally move the statement</p>
<pre class="language-python"><code class="language-python">beat_cheese <span class="token operator">=</span> beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
</code></pre>
<p>below</p>
<pre class="language-python"><code class="language-python">cheese_mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>whisked<span class="token punctuation">,</span> beat_cheese<span class="token punctuation">)</span>
</code></pre>
<p>It should be clear to me that something is wrong, because there will be no <code>beat_cheese</code> in scope to create the <code>cheese_mixture</code>. Even if it's not clear to me, it's probably clear to my linter and editor:</p>
<p><img src="/assets/images/dev/FP/FunctionalError.avif" alt="Functional Error"></p>
<p>As you can see, not only does the usage of <code>beat_cheese</code> raise an error because no such variable is defined, the <em>definition</em> of <code>beat_cheese</code> <em>also</em> raises a visual warning: it is greyed out since it is dead code! This makes it very hard to miss when you make such trivial error, and saves you time: rather than waiting 10s for your test suite to run, within less than 1s your linter would have lit up and flagged the lines as invalid. Over the days, months and years, this adds up to a significant productivity boost</p>
<p>However, in the <em>Imperative</em> case, it's not clear how</p>
<pre class="language-python"><code class="language-python">beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cheese<span class="token punctuation">)</span>
</code></pre>
<p>Relates to the things before or after it. If I remove the <code>beat(cheese)</code> earlier, I still have a <code>cheese</code> to pass in. If I remove the <code>beat(mixture, cheese)</code> entirely, I still have a <code>mixture</code> I can use in later steps of the recipe. So how do I know, from looking at the code, that removing a step or re-ordering them so that <code>beat(cheese)</code> comes after <code>beat(mixture, cheese)</code> is a problem?</p>
<p>The answer is, you often don't, and neither does your computer, or your editor and linter, who aren't going to help you spot the fact that you accidentally swapped two of the imperative statements:</p>
<p><a href="https://www.lihaoyi.com/post/BasicFunctionalProgramming/ImperativeError.png">Imperative Error</a></p>
<p>Fundamentally, in the "FP" example, the code is laid out in a way that the "correct" usage is obvious: each function, e.g. <code>beat</code>, only depends on the things that are passed into it, and it's output is only depended upon by whoever uses it's return value. In the "Imperative" example, it's not clear who depends on who: you have to memorize the fact that <code>beat(cheese)</code> must come before <code>beat(mixture, cheese)</code>, and not the other way around.</p>
<p>While this is not difficult assuming we are looking at already-correct code (the current order is the correct order!), when mistakes are made, and code happens to be incorrect, "FP" code makes the mistakes much easier for you (or your linter) to spot so you can correct them.</p>
<hr>
<p>While this example may seem contrived, the basic problem exists in all large codebases I've worked with. For example, maybe you've bumped into code similar to the following three functions:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1000</span> lines of messy code<span class="token punctuation">,</span> no <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">def</span> <span class="token function">make_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">2000</span> lines of messy code<span class="token punctuation">,</span> no <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">def</span> <span class="token function">start_server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">4000</span> lines of messy code<span class="token punctuation">,</span> no <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>Which transitively depend on a 1 million line codebase ("The App"). How could I know that <code>start_server()</code> needs to be called before <code>make_app()</code>, which itself needs to be called before <code>initialize()</code>, when all of them are global functions which don't take arguments or return anything? I have certainly spent countless days of my career puzzling over such mysteries in large codebases, and I am sure others have too. If <code>start_server</code> returned something I needed to pass to <code>make_app</code>, which returned something I needed to pass to <code>initialize</code>, that would make it clear from the outset which one needs to come before the other.</p>
<p>Re-ordering or shuffling around statements is not uncommon. When you are refactoring a piece of code to let you re-use it in a different place, a lot of time is spent shifting bits of code up and down small amounts, just like the example I showed above, so that the code you want to re-use is all in one place and you can extract it into a helper.</p>
<p>Perhaps you just want to tidy up what was previous a messy function to organize the code a bit better than it already is, grouping related lines so they can be read together easily, without changing any behavior at all.</p>
<p>Or perhaps, as mentioned earlier, someone made a mistake and the code <em>that already exists</em> is incorrect, and your job is to figure out which of the statements is out of order so you can fix it.</p>
<p>All of these are things that software engineers do day in, day out. And often, we make mistakes when doing so. With functional programming, whether in a typed language or not, it tends to be much more clear when you've made a trivial, dumb error. That means you get feedback quicker: you get corrected quietly by your linter in the privacy of your own laptop, and can quickly fix it and make progress, rather than waiting a long time only to be loudly yelled at by Jenkins CI in front of your entire team.</p>
<h3 id="refactoring-a-functional-tiramisu-recipe"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#refactoring-a-functional-tiramisu-recipe">Refactoring a Functional Tiramisu Recipe</a><a aria-hidden="true" class="anchor-heading icon-link" href="#refactoring-a-functional-tiramisu-recipe"></a></h3>
<p>Even if you haven't already-made a mistake, and are just <em>thinking</em> of making a change to a codebase, the <code># FP</code> version of the code is a lot easier to think about than the <code># Imperative</code> version. The same often applies whether you're writing dealing with Python, Javascript, Scala, or a Tiramisu recipe!</p>
<p>I have already shown above how the 2D-block-diagram version of this recipe is exactly equivalent in semantics to a "FP" Python function. For this section I will use the 2D-block-diagrams to illustrate my points, as it is much clearer visually, but the same kind of reasoning applies to "FP" code in Python or any other programming language. While working with an FP style, you quickly get used to performing the same analyses in your head, just as quickly, but on lines of source code rather than 2D-block-diagrams.</p>
<p>What is interesting is that this structure lets us very easily answer some of the questions we asked above:</p>
<blockquote>
<ul>
<li>If I have two people to make this tiramisu, which parts can be done in parallel?</li>
</ul>
</blockquote>
<p>This one is easy:</p>
<p><img src="/assets/images/dev/FP/Parallel.avif" alt="Parallel"></p>
<p>Anything vertically separated can be done in parallel. For example, preparing the ladies fingers and preparing the eggs/sugar/wine are separate and can be done independently, as can whipping the cream and mascarpone cheese. Thus, if you have three people, you might assign:</p>
<ul>
<li>one person to be the egg/wine/sugar mixture czar,</li>
<li>one to be the mascarpone/cream czar, and</li>
<li>one to be the expresso/ladyfingers czar.</li>
</ul>
<p>On the other hand, anything horizontally separated has to be done sequentially:</p>
<p><img src="/assets/images/dev/FP/Sequential.avif" alt="Sequential"></p>
<p>Thus even if you parallelize the early bits, the later beat-fold-assembly-refrigerate steps all have to be done sequentially, and how much time you can save on your Tiramisu is limited by the length of the <a href="https://en.wikipedia.org/wiki/Critical_path_method">Critical Path</a>.</p>
<p>Working with the "FP" representation of the recipe doesn't shorten the critical path, and thus doesn't affect how much you can "theoretically" speed up your recipe with parallelism. What it does do is make clear exactly which parts of the recipe can be parallelized and which can't, so you can more quickly organize your work to get maximum parallelism given the constraints of the recipe, and then move on to other things.</p>
<p>Again, while we're looking at a 2D-block-diagram, the same applies to FP-style code in Python, Javascript, Scala, or any other programming language.</p>
<blockquote>
<ul>
<li>My expresso hasn't arrived yet; can I shift that step down and do other things first and include the expresso later when it arrives?</li>
</ul>
</blockquote>
<p><img src="/assets/images/dev/FP/MissingExpresso.avif" alt="MissingExpresso"></p>
<p>If you expresso hasn't arrived, anything depending on it can't be done, but anything else involving eggs/sugar/wine/cheese/cream can be prepared: the sections marked in red make it clear which parts of the recipe depend on expresso; the rest can be done while waiting for the expresso to arrive</p>
<blockquote>
<ul>
<li>What if my eggs haven't arrived? Which steps can I do first before the eggs turn up?</li>
</ul>
</blockquote>
<p><img src="/assets/images/dev/FP/MissingEggs.avif" alt="MissingEggs"></p>
<p>In this case, the top block can't be done but you can prepare the bottom and middle blocks: preparing the expresso, beating the cream and mascarpone cheese. Again, this is obvious from looking at the diagram</p>
<blockquote>
<ul>
<li>At step 9. I screwed up and spilled the bowl onto the floor. Which steps do I need to re-do (and which ingredients I may have to re-purchase) to recover and continue the recipe?</li>
</ul>
</blockquote>
<p>Step 9 is when you beat the Mascarpone cheese into the egg mixture. Once we find it on the diagram, it's clear what we need to do:</p>
<p><img src="/assets/images/dev/FP/FailBeatCheese.avif" alt="FailBeatCheese"></p>
<p>You will need to get some new eggs/sugar/wine/cheese and beat/beat/whisk/beat them all over again</p>
<blockquote>
<ul>
<li>What if I spilled the bowl at step 10? Or step 8?</li>
</ul>
</blockquote>
<p><img src="/assets/images/dev/FP/FailFoldCream.avif" alt="FailFoldCream"></p>
<p>Spilling the bowl at step 10 (folding the whipped cream into the main mixture) is the same as spilling the bowl at step 9, except you need to get new cream too.</p>
<p><img src="/assets/images/dev/FP/FailBeatCream.avif" alt="FailBeatCream"></p>
<p>Spilling the bowl at step 8 (beating Mascarpone cheese) and you just need to get new mascarpone cheese and beat it. The rest of your ingredients are fine.</p>
<blockquote>
<ul>
<li>Just before step 10, you realize you forgot to do step 7. How much of your ingredients have been ruined?</li>
</ul>
</blockquote>
<p><img src="/assets/images/dev/FP/ForgotWhipCream.avif" alt="ForgotWhipCream"></p>
<p>In the diagram above, the red boxes represent the steps we've already done, up to step 10 (folding in the whipped cream). As you can see, not having done step 7 (whipping the heavy cream) is no big deal; we haven't needed to done it up to now, so we can do it and continue with step 10</p>
<blockquote>
<ul>
<li>What if the forgotten step was step 4? Or step 2?</li>
</ul>
</blockquote>
<p>If you forgot step 4 (whisking in wine and sugar to the beaten eggs) you've ruined your eggs/sugar/wine/cheese:</p>
<p><img src="/assets/images/dev/FP/ForgotWineSugar.avif" alt="ForgotWineSugar"></p>
<p>As you can see, the stuff we've been whisking and beating was not prepared properly before being whisked and beaten, since we forgot to mix in the wine and sugar. Assuming we don't know enough kitchen chemistry to incorporate the wine/sugar in at this stage (Our eggs may well have turned into omelettes by now without the additional liquid from the wine...) we will need to re-do all the steps in the upper red box.</p>
<p>If you forgot step 2 (dissolving sugar into expresso) you're fine. The expresso hasn't been needed yet:</p>
<p><img src="/assets/images/dev/FP/ForgotExpresso.avif" alt="ForgotExpresso"></p>
<p>According to the imperative recipe above, we <em>should</em> have done the expresso mixing first before starting on the egg/wine/cheese. But even though we didn't do it, it is trivial to see from the FP-style recipe that there really isn't any loss: no other steps so far depended on that, no other ingredients were ruined.</p>
<hr>
<p>As you can see, many of the questions that were non-trivial to answer when dealing with the imperative code back in <a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#kitchen-refactoring">Kitchen Refactoring</a> are now trivial to answer when working with the FP-style 2D-block-diagrams.</p>
<p>Again, while nobody actually codes in 2D-block-diagrams (except skilled engineers running recipe blogs) the 2D-block-diagrams are equivalent to a relatively straightforward snippet as shown above. With some experience dealing with FP code, you can often perform the same analyses just as easily when working directly with the equivalent Python code we showed earlier. And it's not just about programmers: automated tools linters or IDEs often perform the same analysis on the fly, as <a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#preventing-errors-with-functional-programming">shown earlier</a>, quickly alerting you if you make a mistake that means the recipe can no longer be completed successfully:</p>
<p><img src="/assets/images/dev/FP/FunctionalError.avif" alt="FunctionalError"></p>
<h3 id="the-core-of-functional-programming"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#the-core-of-functional-programming">The Core of Functional Programming</a><a aria-hidden="true" class="anchor-heading icon-link" href="#the-core-of-functional-programming"></a></h3>
<p><strong>The core of Functional Programming is thinking about data-flow rather than control-flow</strong>. Although, by virtue of editing plain text, you are forced to order your code in a linear sequence of statements, those statements are a thin skin over what you really care about: the shape and structure of the data-flow graph within your program.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    beat_eggs <span class="token operator">=</span> beat<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>beat_eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisked <span class="token operator">=</span> whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    beat_cheese <span class="token operator">=</span> beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    cheese_mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>whisked<span class="token punctuation">,</span> beat_cheese<span class="token punctuation">)</span>
    whipped_cream <span class="token operator">=</span> whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    folded_mixture <span class="token operator">=</span> fold<span class="token punctuation">(</span>cheese_mixture<span class="token punctuation">,</span> whipped_cream<span class="token punctuation">)</span>
    sweet_espresso <span class="token operator">=</span> dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    wet_fingers <span class="token operator">=</span> soak2seconds<span class="token punctuation">(</span>fingers<span class="token punctuation">,</span> sweet_espresso<span class="token punctuation">)</span>
    assembled <span class="token operator">=</span> assemble<span class="token punctuation">(</span>folded_mixture<span class="token punctuation">,</span> wet_fingers<span class="token punctuation">)</span>
    complete <span class="token operator">=</span> sift<span class="token punctuation">(</span>assembled<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    ready_tiramisu <span class="token operator">=</span> refrigerate<span class="token punctuation">(</span>complete<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ready_tiramisu
</code></pre>
<p><img src="/assets/images/dev/FP/CodeGraph.avif" alt="CodeGraph"></p>
<p><img src="/assets/images/dev/FP/DiagramGraph.avif" alt="DiagramGraph"></p>
<p>Similarly, when <em>executing</em> a "functional program" in a single thread, you are forced to pick a linear order in which you execute each individual instruction, which e.g. might be the same as the order in which it is written down in the code. But since we know what <em>really</em> matters is the shape of the data-flow graph, we can freely re-arrange the statements in the code, and the order of execution, as long as the graph shape is preserved. Since the data-flow graph matches the graph of definitions and usages, even your editors and linters understand it enough to warn you if you re-arrange things in an invalid order. In fact, if you have multiple cores (or multiple cooks!) you can execute parts of it in parallel, not in any linear order at all! Exactly in what order the <a href="https://en.wikipedia.org/wiki/Program_counter">program-counter</a> proceeds from instruction to instruction is irrelevant.</p>
<p>This is in contrast to an imperative program, where the exact <em>order</em> in which the program-counter executes each statement, going in and out of loops, in and out of sub-routines, is the key to understanding the program. In an imperative program, you tend to think in terms of steps that must happen "before" and "after", and make sure that the control-flow of the program executes the commands in the right order for the program to work.</p>
<p><strong>Note that none of the FP examples here are "less complex" than the "imperative" recipe we discussed above</strong>. It's about the same number of lines:</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> whisk<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span> <span class="token comment"># over steam</span>
    whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    beat<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cheese<span class="token punctuation">)</span>
    fold<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cream<span class="token punctuation">)</span>
    assemble<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> fingers<span class="token punctuation">)</span>
    sift<span class="token punctuation">(</span>mixture<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    refrigerate<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    <span class="token keyword">return</span> mixture <span class="token comment"># it's now a tiramisu</span>
</code></pre>
<pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">make_tiramisu</span><span class="token punctuation">(</span>eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">,</span> cheese<span class="token punctuation">,</span> cream<span class="token punctuation">,</span> fingers<span class="token punctuation">,</span> espresso<span class="token punctuation">,</span> sugar2<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span><span class="token punctuation">:</span>
    beat_eggs <span class="token operator">=</span> beat<span class="token punctuation">(</span>eggs<span class="token punctuation">)</span>
    mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>beat_eggs<span class="token punctuation">,</span> sugar1<span class="token punctuation">,</span> wine<span class="token punctuation">)</span>
    whisked <span class="token operator">=</span> whisk<span class="token punctuation">(</span>mixture<span class="token punctuation">)</span>
    beat_cheese <span class="token operator">=</span> beat<span class="token punctuation">(</span>cheese<span class="token punctuation">)</span>
    cheese_mixture <span class="token operator">=</span> beat<span class="token punctuation">(</span>whisked<span class="token punctuation">,</span> beat_cheese<span class="token punctuation">)</span>
    whipped_cream <span class="token operator">=</span> whip<span class="token punctuation">(</span>cream<span class="token punctuation">)</span>
    folded_mixture <span class="token operator">=</span> fold<span class="token punctuation">(</span>cheese_mixture<span class="token punctuation">,</span> whipped_cream<span class="token punctuation">)</span>
    sweet_espresso <span class="token operator">=</span> dissolve<span class="token punctuation">(</span>sugar2<span class="token punctuation">,</span> espresso<span class="token punctuation">)</span>
    wet_fingers <span class="token operator">=</span> soak2seconds<span class="token punctuation">(</span>fingers<span class="token punctuation">,</span> sweet_espresso<span class="token punctuation">)</span>
    assembled <span class="token operator">=</span> assemble<span class="token punctuation">(</span>folded_mixture<span class="token punctuation">,</span> wet_fingers<span class="token punctuation">)</span>
    complete <span class="token operator">=</span> sift<span class="token punctuation">(</span>assembled<span class="token punctuation">,</span> cocoa<span class="token punctuation">)</span>
    ready_tiramisu <span class="token operator">=</span> refrigerate<span class="token punctuation">(</span>complete<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ready_tiramisu
</code></pre>
<p>whether as multiple statements, one big expression, or as a 2D block diagram. All the same operations are present: <code>beat</code>ing, <code>whip</code>ing, <code>fold</code>ing, etc.. <strong>Functional Programming is not about hiding ugly code in helper methods and hoping nobody notices: it's about managing the same complexity in a way that makes the dependencies between each piece of code obvious, by following the graph of where function arguments come from and where return values end up.</strong></p>
<p>When you have a working program, having the dependency graph of function return values being passed into other functions as arguments makes it really easy to analyze code. For example, if we were curious what <em>exactly</em> is required to get our <code>wet_fingers_mixture</code>, we can see:</p>
<ul>
<li><code>wet_fingers</code> comes from <code>soak2seconds(fingers, sweet_espresso)</code></li>
<li><code>sweet_espresso</code> comes from <code>dissolve(sugar2, espresso)</code></li>
<li><code>sugar2</code>, <code>fingers</code>, <code>espresso</code> are the initial ingredients of the recipe</li>
</ul>
<p>An there you have it: just a few steps, entirely mechanical, and we can see exactly what <code>wet_fingers</code> needs. We need no understanding of what <code>dissolve</code> does, or what a <code>sugar2</code> is: just from the structure of the code we can already see what <code>wet_fingers</code> requires. Just as importantly, we can also see that it does <em>not</em> depend on <code>folded_mixture</code>, <code>whipped_cream</code>, or any of the other steps that are above it in the code: while those steps "come before" the operations that give us a <code>wet_fingers</code>, it's clear from this analysis that their ordering is entirely accidental, and that we could e.g. prepare the <code>wet_fingers</code> before the other steps if we so desired.</p>
<p>It's not hard to do this yourself, but any IDE with jump-to-definition should be able to do this for you, and so can automated linters and code analysis tools. And understanding the code is the first step in changing it, without bugs.</p>
<p>When you have a broken program, having the dependencies be easy to analyze means it's easier to spot when you make a mistake or do something out of order: even in a dynamic language like python, a subtly bad copy-paste job can get called out by your editor so you can fix it before needing to run any code:</p>
<p><img src="/assets/images/dev/FP/FunctionalError.avif" alt="FunctionalError"></p>
<p>Whether you're working in a dynamic language like Python or a static language like Scala, whether your code is currently working or broken, <strong>Functional Programming's data-flow-centric approach helps you understand your code faster, easier and with more tooling help than a Imperative, mutation-heavy approach.</strong></p>
<h2 id="conclusion"><a href="https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#conclusion">Conclusion</a><a aria-hidden="true" class="anchor-heading icon-link" href="#conclusion"></a></h2>
<p><strong>The core of Functional Programming is thinking about data-flow rather than control-flow</strong></p>
<p><img src="/assets/images/dev/FP/TiramisuDiagram.avif" alt="TiramisuDiagram"></p>
<p>While this may seem a trivial definition of "Functional Programming", I think it is really the core of the idea. While there are many further steps, from the simple (immutability, referential transparency, ...) to the more advanced (monads, lenses, ...) this core of should be something that everyone, from newbies to old hands, whether using Scala or Clojure or Haskell or React.js, should be able to empathise with. Even in a language like Python, as I have used for the examples, it is possible to program in a more "Functional" style, and reap some of the benefits of functional programming.</p>
<p>Those more advanced topics don't really fit this worked example anyway: kitchen ingredients tend to be very, very mutable (and perishable!).</p>
<p>Though it's growing, this baseline-level of FP is not yet widespread in industry.</p>
<ul>
<li>Whole languages, such as Bash, make it a pain in the neck to take non-trivial function arguments or return non-trivial results, resulting in people's code writing things to the filesystem, hopefully "before" someone else needs to read them.</li>
<li>Languages like Java encourage patterns where you instantiate a half-baked object and then set the fields later, praying that nobody accidentally tries to use it "too early" it in it's half-baked state while it's internal variables are garbage.</li>
</ul>
<p>In all of these cases, the <em>order</em> in which things run - exactly how the program-counter progresses from statement to statement, in and out of for-loops, in and out of sub-routines - is critical.</p>
<p>Even in the kitchen, having a "FP-style" recipe like the block diagram I showed above is helpful, because when the person bringing your Marsala Wine is stuck in traffic, it makes it easier to re-organize your recipe so you can get as much work done immediately. When that person arrives, it helps you figure out how to parallelize the work over the people you have available. When someone screws up, it helps you figure out exactly which ingredients you need to re-purchase and steps you need to re-do.</p>
<p>This widespread applicability, even to fields outside the software world, and to every "FP" language <em>within</em> the software world, is why I think this is truly what functional programming is all about.</p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what-functional-programming-is-not" title="What Functional Programming is Not">What Functional Programming is Not</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#helper-methods" title="Helper Methods">Helper Methods</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#writing-things-in-haskell" title="Writing Things in Haskell">Writing Things in Haskell</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#compile-time-ast-macros" title="Compile-time AST Macros">Compile-time AST Macros</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#static-types" title="Static Types">Static Types</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#step-by-step-imperative-recipes" title="Step by Step Imperative Recipes">Step by Step Imperative Recipes</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kitchen-refactoring" title="Kitchen Refactoring">Kitchen Refactoring</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#functional-programming-recipes" title="&quot;Functional Programming&quot; Recipes">&quot;Functional Programming&quot; Recipes</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tiramisu-diagram-to-functional-programming" title="Tiramisu Diagram to Functional Programming">Tiramisu Diagram to Functional Programming</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#preventing-errors-with-functional-programming" title="Preventing Errors with Functional Programming">Preventing Errors with Functional Programming</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#refactoring-a-functional-tiramisu-recipe" title="Refactoring a Functional Tiramisu Recipe">Refactoring a Functional Tiramisu Recipe</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#the-core-of-functional-programming" title="The Core of Functional Programming">The Core of Functional Programming</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#conclusion" title="Conclusion">Conclusion</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"ibhefhzrpmuguq2tbmg1383","title":"What's Functional Programming All About?","desc":"","updated":1725589536617,"created":1725588309190,"custom":{},"fname":"dev.functional-programming.whats-functional-programming-all-about","type":"note","vault":{"fsPath":"vault"},"contentHash":"0c1862edad7c872aa144a4307023a214","links":[],"anchors":{"what-functional-programming-is-not":{"type":"header","text":"What Functional Programming is Not","value":"what-functional-programming-is-not","line":24,"column":0,"depth":2},"helper-methods":{"type":"header","text":"Helper Methods","value":"helper-methods","line":28,"column":0,"depth":3},"writing-things-in-haskell":{"type":"header","text":"Writing Things in Haskell","value":"writing-things-in-haskell","line":49,"column":0,"depth":3},"compile-time-ast-macros":{"type":"header","text":"Compile-time AST Macros","value":"compile-time-ast-macros","line":70,"column":0,"depth":3},"static-types":{"type":"header","text":"Static Types","value":"static-types","line":78,"column":0,"depth":3},"step-by-step-imperative-recipes":{"type":"header","text":"Step by Step Imperative Recipes","value":"step-by-step-imperative-recipes","line":86,"column":0,"depth":2},"kitchen-refactoring":{"type":"header","text":"Kitchen Refactoring","value":"kitchen-refactoring","line":142,"column":0,"depth":3},"functional-programming-recipes":{"type":"header","text":"\"Functional Programming\" Recipes","value":"functional-programming-recipes","line":173,"column":0,"depth":2},"tiramisu-diagram-to-functional-programming":{"type":"header","text":"Tiramisu Diagram to Functional Programming","value":"tiramisu-diagram-to-functional-programming","line":185,"column":0,"depth":3},"preventing-errors-with-functional-programming":{"type":"header","text":"Preventing Errors with Functional Programming","value":"preventing-errors-with-functional-programming","line":274,"column":0,"depth":3},"refactoring-a-functional-tiramisu-recipe":{"type":"header","text":"Refactoring a Functional Tiramisu Recipe","value":"refactoring-a-functional-tiramisu-recipe","line":339,"column":0,"depth":3},"the-core-of-functional-programming":{"type":"header","text":"The Core of Functional Programming","value":"the-core-of-functional-programming","line":427,"column":0,"depth":3},"conclusion":{"type":"header","text":"Conclusion","value":"conclusion","line":509,"column":0,"depth":2}},"children":[],"parent":"HtVLXiN97I2jTm8h2NEVQ","data":{}},"body":"\u003ch1 id=\"whats-functional-programming-all-about\"\u003eWhat's Functional Programming All About?\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#whats-functional-programming-all-about\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html\"\u003ehttps://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThere are many descriptions floating around the internet, trying to explain functional programming in simple terms. Unfortunately, most discuss details only loosely related to functional programming, while others focus on topics that are completely irrelevant. So of course, I had to write my own!\u003c/p\u003e\n\u003cp\u003eThis post is my own understanding of what is the \"core\" of \"functional programming\", how it differs from \"imperative\" programming, and what the main benefits of the approach are. As a worked example, we will use a kitchen recipe as a proxy for the more-abstract kind of logic you find in program source code, to try and make concrete what is normally a very abstract topic. That recipe is one of my favorite recipes available online, \u003ca href=\"http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe\"\u003eMichael Chu's Classic Tiramisu\u003c/a\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eA topic as broad as \"Functional Programming\", or \"FP\" has too many different interpretations and facets to be summarized in one blog post. Nevertheless, this post will discuss what \u003cem\u003eI\u003c/em\u003e think is the most core, basic level of functional programming. This will hopefully be something that everyone, from FP newbies to FP \"experts\", should be able to empathise with and agree is a useful part of functional programming.\u003c/p\u003e\n\u003cp\u003eIt's not surprising that many people have tried to explain functional programming using kitchen/recipe/cookbook examples: learning things \"by analogy\" of things you already know is one of the easiest ways of learning. However, all explanations I have seen fall short. I will begin by examining some typical, \u003cem\u003eincorrect\u003c/em\u003e explanations of what functional programming is about, before discussing how \u003ca href=\"http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe\"\u003eMichael Chu's Classic Tiramisu\u003c/a\u003e recipe:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.lihaoyi.com/post/BasicFunctionalProgramming/Tiramisu.jpg\"\u003eimage - Tiramisu\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCan provide insight into what I think are the core techniques and benefits of functional programming.\u003c/p\u003e\n\u003ch2 id=\"what-functional-programming-is-not\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#what-functional-programming-is-not\"\u003eWhat Functional Programming is Not\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-functional-programming-is-not\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThere are many poor explanations people have given for \"what is functional programming\". Here is a selection:\u003c/p\u003e\n\u003ch3 id=\"helper-methods\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#helper-methods\"\u003eHelper Methods\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#helper-methods\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eOne of the most common misconceptions of what FP is is illustrated by the following example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFP =\u003e I'll have a Sazerac\u003c/p\u003e\n\u003cp\u003eImperative =\u003e Excuse me sir, could you take some ice, add rye whiskey, add bitters, add absinthe, shake, strain into a glass, and add a lemon garnish before bringing it to me\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWhile this example was taken from the \u003ca href=\"https://news.ycombinator.com/item?id=13281413\"\u003ey-combinator message board\u003c/a\u003e, I've seen this attitude in many places: the idea that functional programming is just taking imperative instructions, and wrapping them in a helper. In this case, the messy imperative code will all sit inside a single helper:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003esazerac\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token number\"\u003e10000\u003c/span\u003e lines of messy imperative code \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBut even in imperative programming you always end up factoring things into helper methods. Java has helper methods. Write assembly, and it ends up being organized with sub-procedures to encapsulate messes of imperative code.\u003c/p\u003e\n\u003cp\u003eThus, while this is a useful technique, writing helper methods to wrap your messy code in a single method/function/subprocess/subroutine call does not count as functional programming.\u003c/p\u003e\n\u003cp\u003eFurthermore, \u003cem\u003epicking an easier/simpler problem\u003c/em\u003e, despite making your code look neater, does not count as \"Functional Programming\" either. Calling a single method that executes a huge blob of code that \u003cem\u003esomeone else\u003c/em\u003e has written is convenient, but is not functional programming. The point of FP is to face the complexity, own it, and control it, not shove it inside some unmaintained helper function or say it's a problem for some \"other department\" to deal with.\u003c/p\u003e\n\u003ch3 id=\"writing-things-in-haskell\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#writing-things-in-haskell\"\u003eWriting Things in Haskell\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#writing-things-in-haskell\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-none\"\u003e\u003ccode class=\"language-none\"\u003esazerac = do\n    add ice\n    add ryeWhisky\n    add bitters\n    add absinthe\n    shake\n    strainInto glass\n    add lemonGarnish\n\nmain = serve $ makeCocktail sazerac\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eAlso from the \u003ca href=\"https://news.ycombinator.com/item?id=13281413\"\u003ey-combinator message board\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIt's often said that you can write COBOL in any language, that you can write Java in any language. Well, you can write any language in Haskell too: the above is basically writing Bash in Haskell\u003c/p\u003e\n\u003cp\u003eJust because something is implemented in Haskell with Monads, doesn't mean it's functional programming. If it looks like imperative code written in Bash, and it's semantics are like imperative code written in Bash, it's imperative code. This example certainly looks exactly like imperative code written in Bash except it's run using \u003ccode\u003eserve $ makeCocktail\u003c/code\u003e instead of \u003ccode\u003ebash cocktail.sh\u003c/code\u003e.\u003c/p\u003e\n\u003ch3 id=\"compile-time-ast-macros\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#compile-time-ast-macros\"\u003eCompile-time AST Macros\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#compile-time-ast-macros\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSome variant of Lisp (or \u003ca href=\"https://en.wikipedia.org/wiki/Scheme_(programming_language)\"\u003eScheme\u003c/a\u003e?) was probably one of the first implemented FP languages; and Lisps tend to have compile-time AST macros that allow you to transform sections of the program at compile-time.\u003c/p\u003e\n\u003cp\u003eBut compile-time code-transformations are not unique to Lisp; apart from other FP languages that have them, like \u003ca href=\"https://wiki.haskell.org/Template_Haskell\"\u003eTemplate Haskell\u003c/a\u003e or \u003ca href=\"http://docs.scala-lang.org/overviews/macros/overview.html\"\u003eScala Macros\u003c/a\u003e, many languages have some sort of compile-time code transformation. From \u003ca href=\"http://hannesdorfmann.com/annotation-processing/annotationprocessing101\"\u003eJava Annotation Processors\u003c/a\u003e, to my own \u003ca href=\"https://github.com/lihaoyi/macropy\"\u003eMacroPy\u003c/a\u003e project in Python, it turns out that compile-time ast macros are just as feasible in imperative languages, doing imperative programming. You can manipulate mutable ASTs using imperative Python code just as easily as you can elegantly transform immutable ASTs using Scala.\u003c/p\u003e\n\u003cp\u003eFurthermore, there are a large set of \"obviously\" functional programming languages that don't have AST-transforming macros at all. Purescript, non-Template Haskell, Scala 2.9, and many other \"obviously\" functional languages do not include support for compile-time AST transformations. So whatever is the core of functional programming, it's not AST macros.\u003c/p\u003e\n\u003ch3 id=\"static-types\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#static-types\"\u003eStatic Types\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#static-types\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThere are a large number of people who use FP together with static types, e.g. in languages like Haskell, Scala, or Ocaml. Thus, if you spend all your time within this world, it might be tempting to think that FP is all about static types. \u003ca href=\"http://stackoverflow.com/questions/6246719/what-is-a-higher-kinded-type-in-scala\"\u003eHigher-kinded\u003c/a\u003e, \u003ca href=\"https://wiki.haskell.org/Rank-N_types\"\u003eRank-N\u003c/a\u003e, \u003ca href=\"https://en.wikipedia.org/wiki/Dependent_type\"\u003eDependent\u003c/a\u003e, the fancier the types, the more functional the programming.\u003c/p\u003e\n\u003cp\u003eHowever, there are probably just as many people using FP without static types: in some parts of the Javascript community, Clojure, Scheme or one of the many other Lisps. It turns out, that all those using FP without types still get many of the benefits. And then there are all those people in static-typed languages like Java that use minimal FP in their code.\u003c/p\u003e\n\u003cp\u003eSo static types, while present in many FP languages, are not the core of FP.\u003c/p\u003e\n\u003ch2 id=\"step-by-step-imperative-recipes\"\u003eStep by Step Imperative Recipes\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#step-by-step-imperative-recipes\"\u003e\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#step-by-step-imperative-recipes\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eNow that we've looked at a few common misconceptions of what FP is, let's look at what the core of FP \u003cem\u003eactually is\u003c/em\u003e (according to me) in contrast to \"imperative\" programming, using \u003ca href=\"http://www.cookingforengineers.com/recipe/60/The-Classic-Tiramisu-original-recipe\"\u003eMichael Chu's Classic Tiramisu\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.lihaoyi.com/post/BasicFunctionalProgramming/Tiramisu.jpg\"\u003eTiramisu\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAs an example. To begin with, we'll explore an \"imperative\" recipe, that is probably familiar to those you already know.\u003c/p\u003e\n\u003cp\u003eMichael Chu's Classic Tiramisu, like all the other recipe's on his excellent recipe site has roughly four sections on the page:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe backstory of the recipe\u003c/li\u003e\n\u003cli\u003eA step-by-step guide, with photos, of how to make the Tiramisu\u003c/li\u003e\n\u003cli\u003eA diagram of the overall process, showing which ingredients are combined with which others, to create the resultant Tiramisu\u003c/li\u003e\n\u003cli\u003eA lively and entertaining comments section\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor the purpose of this programming blog we will only be looking at parts \u003ccode\u003e2.\u003c/code\u003e and \u003ccode\u003e3.\u003c/code\u003e: the step by step guide, and the process diagram. The step by step guide details, in order, a series of steps that you can take to make a Tiramisu. At a high level, hiding many of the details, it looks like this:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eBegin by assembling four large egg yolks, 1/2 cup sweet marsala wine, 16 ounces mascarpone cheese, 12 ounces espresso, 2 tablespoons cocoa powder, 1 cup heavy cream, 1/2 cup granulated sugar, and enough lady fingers to layer a 12x8 inch pan twice (40).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStir two tablespoons of granulated sugar into the espresso and put it in the refrigerator to chill.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhisk the egg yolks\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePour in the sugar and wine and whisked briefly until it was well blended.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePour some water into a saucepan and set it over high heat until it began to boil.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLowering the heat to medium, place the heatproof bowl over the water and stirred as the mixture began to thicken and smooth out.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhip the heavy cream until soft peaks.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBeat the mascarpone cheese until smooth and creamy.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePoured the mixture onto the cheese and beat\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFold in the whipped cream\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAssemble the tiramisu.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGive the each ladyfinger cookie a one second soak on each side and then arrange it on the pan\u003c/li\u003e\n\u003cli\u003eAfter the first layer of ladyfingers are done, use a spatula to spread half the cream mixture over it.\u003c/li\u003e\n\u003cli\u003eCover the cream layer with another layer of soaked ladyfingers.\u003c/li\u003e\n\u003cli\u003eThe rest of the cream is spread onto the top and cocoa powder sifted over the surface to cover the tiramisu.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe tiramisu was now complete and would require a four hour chill in the refrigerator.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis is, I think, something like what most people would think of when told \"imperative recipe\". You start with a set of inputs (the bullet \u003ccode\u003e1.\u003c/code\u003e) and then perform a series of steps until you have a result at the end. (For now, I'm ignoring the pictures in the recipe, though you could think of them as a sort of \u003ccode\u003eassert\u003c/code\u003e function for a would-be chef to check some invariants after each step to make sure his tiramisu hasn't gone terribly wrong!)\u003c/p\u003e\n\u003cp\u003eA simplified Python version of this recipe (ignoring the fact that I'm overloading the same functions to work on different types/number of arguments) may look something like this:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# over steam\u003c/span\u003e\n    whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e mixture \u003cspan class=\"token comment\"\u003e# it's now a tiramisu\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"kitchen-refactoring\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#kitchen-refactoring\"\u003eKitchen Refactoring\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#kitchen-refactoring\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLike most imperative code, it works, but may be hard to understand deeply or difficult to refactor. For example, in cooking terms, you may ask the following questions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf I have two people to make this tiramisu, which parts can be done in parallel?\u003c/li\u003e\n\u003cli\u003eMy expresso hasn't arrived yet; can I shift that step down and do other things first and include the expresso later when it arrives?\n\u003cul\u003e\n\u003cli\u003eWhat if my eggs haven't arrived? Which steps can I do first before the eggs turn up?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eAt step 9. I screwed up and spilled the bowl onto the floor. Which steps do I need to re-do (and which ingredients I may have to re-purchase) to recover and continue the recipe?\n\u003cul\u003e\n\u003cli\u003eWhat if I spilled the bowl at step 10? Or step 8?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eJust before step 10, you realize you forgot to do step 7. How much of your ingredients have been ruined?\n\u003cul\u003e\n\u003cli\u003eWhat if the forgotten step was step 4? Or step 2?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAll four of these are things that happen regularly in a kitchen, and also happen to correspond to things you do with program code all the time: parallelizing things over the available cores to speed things up, shuffling the order of a computation around, dealing with failures and exceptions, or plain old bugs and mistakes.\u003c/p\u003e\n\u003cp\u003eThe answers to these questions are left as an exercise to the reader; in this case, with 12 steps, it's not terribly hard to figure out. A few minutes carefully studying the recipe and you could probably figure it out, so you should definitely give it a try.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eIn a large software project, with a codebase containing thousands or millions of lines of imperative code, that time could easily stretch to days, weeks, or months trying to figure out how to properly recover when one of those imperative steps fails, or how to make your legacy PHP monolith do something faster by using more than 1 of the 32 cores you have available on your beefy server.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eThe problem in these cases often isn't that you don't know how to run stuff in a separate process in PHP - the problem is that you don't know enough about your own code to decide what to run in that other process\u003c/strong\u003e. To move things onto a separate process, you need to know exactly what each bit of code depends on, and who depends on it, so you can pick a set with minimal dependencies to run somewhere else (since inter-process communication is expensive). That's difficult when you have a pile of imperative code and don't even understand it enough to easily move things around \u003cem\u003ewithin\u003c/em\u003e a single process.\u003c/p\u003e\n\u003cp\u003eThe reason that these kinds of analyses are hard on this imperative recipe is the same reason that the analyses are hard when programming in an imperative style:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThere is an ordering of the steps, but the ordering between some steps is required, e.g. the series 9, 10, 11, while those between other steps is entirely arbitrary: step 2 could be done anywhere before step 11, and step 7 and 8 could be swapped or done much earlier and nobody would care.\u003c/li\u003e\n\u003cli\u003eThe instructions are based on changing the state of things, e.g. pouring stuff into \u003ccode\u003emixture\u003c/code\u003e, a term that we use repeatedly throughout the recipe but means a different thing in each step. Even the meaning of \u003ccode\u003echeese\u003c/code\u003e and \u003ccode\u003ecream\u003c/code\u003e changes as the recipe progresses (e.g. after calling \u003ccode\u003ewhip(cream)\u003c/code\u003e), but it is entirely hidden from you and not obvious from the code.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOverall, these factors make it hard to decide, given a single step \u003cem\u003eS\u003c/em\u003e, what steps \u003cem\u003eS\u003c/em\u003e depends on, and what \u003cem\u003eother\u003c/em\u003e steps depend on \u003cem\u003eS\u003c/em\u003e. Again, it is possible to figure it out, but what is somewhat-tedious to figure out in a 16-line tiramisu recipe becomes painful and difficult in a 1,000,000 line enterprise codebase.\u003c/p\u003e\n\u003cp\u003eSo that's what an imperative Tiramisu recipe looks like. What does a \"functional programming\" Tiramisu recipe look like?\u003c/p\u003e\n\u003ch2 id=\"functional-programming-recipes\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#functional-programming-recipes\"\u003e\"Functional Programming\" Recipes\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#functional-programming-recipes\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIt turns out, there's a FP version of this recipe right underneath the imperative one! The \"process diagram\" mentioned above is an excellent illustration of how such a recipe would look like using \"Functional Programming\":\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/TiramisuDiagram.avif\" alt=\"TiramisuDiagram\"\u003e\u003c/p\u003e\n\u003cp\u003eTo read this, the raw ingredients are on the left, and each of the boxes represents a single operation that transforms and combines the ingredients. After all the combinations have taken place, you end up on the right with a single, complete Tiramisu. While this \"2D\" format is not how people write program source code, the underlying structure is not too different from how people structure \"FP\" programs, which I will demonstrate below.\u003c/p\u003e\n\u003cp\u003eThis diagram leaves out some the \u003cem\u003edetail\u003c/em\u003e that the full imperative recipe provides, even compared to the abridged version I transcribed above. For example, chilling the expresso or explicitly boiling the water are left out, and the details of \u003cem\u003eassemble\u003c/em\u003e are not included. Nevertheless, it contains the same high-level steps of how to build the tiramisu I abridged above. We're not leaving out large numbers of operations or hiding things behind high-level instructions: all the same steps are still there, just organized slightly differently.\u003c/p\u003e\n\u003cp\u003eBut even if this diagram has the same \"content\" as the imperative instruction-list I discussed earlier, what about this makes this presentation of the recipe more \"functional\"?\u003c/p\u003e\n\u003ch3 id=\"tiramisu-diagram-to-functional-programming\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#tiramisu-diagram-to-functional-programming\"\u003eTiramisu Diagram to Functional Programming\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tiramisu-diagram-to-functional-programming\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eWhile nobody actually writes their code in a 2D table-flowchart-thing like this tiramisu diagram is, it turns out underneath the 2D format the \"core\" of this diagram is the dependency graph between elements:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/DiagramGraph.avif\" alt=\"TiramisuDiagram\"\u003e\u003c/p\u003e\n\u003cp\u003eWhere each box takes in some \"inputs\" from the left, and results in an \"output\" that can be used by more-rightward boxes. This can be straightforwardly represented in code by treating the boxes as functions, e.g. in the following Python code:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n            assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n                fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n                    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n                        whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# over steam\u003c/span\u003e\n                            beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebeat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                        beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                    whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                soak2seconds\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            cocoa\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e(Again, forgive the fact that I'm overloading the same functions to work on different types and numbers of arguments)\u003c/p\u003e\n\u003cp\u003eIf it's not immediately clear how this code relates to the \"functional programming dependency diagram\" I discussed above, we can draw the dependency graph \u003cem\u003eof this code\u003c/em\u003e: showing where the input variables go, where the return value of each function goes, all the way into the \"final\" result that gets returned:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/CodeGraph.avif\" alt=\"TiramisuDiagram\"\u003e\u003c/p\u003e\n\u003cp\u003eIt might look like a bit of a mess, but if you look carefully, you will see that \u003cstrong\u003ealthough the graphs are laid out differently, the fundamental structure of the two graphs is identical!\u003c/strong\u003e That is what I mean when I say the 2D box-diagram is a \"FP Recipe\": although people don't tend to write code in 2D box-diagrams, the underlying structure that the diagram represents is totally equivalent to some \"FP\"-ish Python code, not too dissimilar to what people \u003cem\u003edo\u003c/em\u003e write.\u003c/p\u003e\n\u003cp\u003eThis code looks very unlike code you are likely to see in a Python project, \"in the wild\", but we can fix that! If you prefer to have intermediate named values instead of one big expression, it's straightforward to pull out each function call into it's own statement:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token comment\"\u003e# FP\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    beat_eggs \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebeat_eggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisked \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat_cheese \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    cheese_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ewhisked\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e beat_cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whipped_cream \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    folded_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e whipped_cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sweet_espresso \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    wet_fingers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e soak2seconds\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sweet_espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assembled \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efolded_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wet_fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    complete \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eassembled\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    ready_tiramisu \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecomplete\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e ready_tiramisu\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat makes it look entirely \"pythonic\", indistinguishable from the code you might find in any random project on Github\u003c/p\u003e\n\u003cp\u003eMoving every expression into a separate statement is a straightforward transformation, at least for FP programs, and is the kind of thing that compilers regularly do automatically. Thus, although that block-flow-chart diagram may have looked a bit foreign at first, it really isn't \u003cem\u003ethat\u003c/em\u003e different from the code people write day to day, all year round.\u003c/p\u003e\n\u003cp\u003eIn fact, it looks not too unlike the \"Imperative\" version we came up with earlier!\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token comment\"\u003e# Imperative\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# over steam\u003c/span\u003e\n    whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    soak2seconds\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e mixture \u003cspan class=\"token comment\"\u003e# it's now a tiramisu\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThese two snippets of code look very similar, but the top one is \"Functional Programming\" while the bottom one is \"Imperative Programming\". The difference between them?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIn the first, you can see that \u003ccode\u003ebeat(cheese)\u003c/code\u003e must come before \u003ccode\u003ebeat(whisked, beat_cheese)\u003c/code\u003e, because \u003ccode\u003ebeat_cheese\u003c/code\u003e is defined by the \u003ccode\u003ebeat(cheese)\u003c/code\u003e and used by \u003ccode\u003ebeat(whisked, beat_cheese)\u003c/code\u003e. Even if you know nothing about \u003ccode\u003ebeat\u003c/code\u003e, \u003ccode\u003echeese\u003c/code\u003e or \u003ccode\u003ewhisked\u003c/code\u003e, it is clear from the code that if you tried to reverse the order - and \u003ccode\u003ebeat(whisked, beat_cheese)\u003c/code\u003e \u003cem\u003ebefore\u003c/em\u003e \u003ccode\u003ebeat(cheese)\u003c/code\u003e, it wouldn't work.\u003c/li\u003e\n\u003cli\u003eIn the second, it's not so clear: does \u003ccode\u003ebeat(cheese)\u003c/code\u003e \u003cem\u003eneed\u003c/em\u003e to come before \u003ccode\u003ebeat(mixture, cheese)\u003c/code\u003e? Or does \u003ccode\u003ebeat(mixture, cheese)\u003c/code\u003e need to come before \u003ccode\u003ebeat(cheese)\u003c/code\u003e? In this case, we have a link to the \"docs\" (the original recipe) so we can look it up, but which one depends on the other - and whether they are currently in the right order - is not clear from the code.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBut how does this seemingly-trivial difference affect the way you build software?\u003c/p\u003e\n\u003ch3 id=\"preventing-errors-with-functional-programming\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#preventing-errors-with-functional-programming\"\u003ePreventing Errors with Functional Programming\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#preventing-errors-with-functional-programming\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe difference between the two Python snippets, the \u003ccode\u003e# FP\u003c/code\u003e and \u003ccode\u003e# Imperative\u003c/code\u003e snippets, will become clear with the following thought experiment: what if we try to make changes to the code?\u003c/p\u003e\n\u003cp\u003eChanging code is something we do all day, and sometimes we do it incorrectly. It would be a nice property of a codebase if changes tended to be easier to make correctly, and incorrect changes were easier to spot. We'll discuss the latter first.\u003c/p\u003e\n\u003cp\u003eIf I try to tidy things up and accidentally move the statement\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003ebeat_cheese \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ebelow\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003echeese_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ewhisked\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e beat_cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt should be clear to me that something is wrong, because there will be no \u003ccode\u003ebeat_cheese\u003c/code\u003e in scope to create the \u003ccode\u003echeese_mixture\u003c/code\u003e. Even if it's not clear to me, it's probably clear to my linter and editor:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FunctionalError.avif\" alt=\"Functional Error\"\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see, not only does the usage of \u003ccode\u003ebeat_cheese\u003c/code\u003e raise an error because no such variable is defined, the \u003cem\u003edefinition\u003c/em\u003e of \u003ccode\u003ebeat_cheese\u003c/code\u003e \u003cem\u003ealso\u003c/em\u003e raises a visual warning: it is greyed out since it is dead code! This makes it very hard to miss when you make such trivial error, and saves you time: rather than waiting 10s for your test suite to run, within less than 1s your linter would have lit up and flagged the lines as invalid. Over the days, months and years, this adds up to a significant productivity boost\u003c/p\u003e\n\u003cp\u003eHowever, in the \u003cem\u003eImperative\u003c/em\u003e case, it's not clear how\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003ebeat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRelates to the things before or after it. If I remove the \u003ccode\u003ebeat(cheese)\u003c/code\u003e earlier, I still have a \u003ccode\u003echeese\u003c/code\u003e to pass in. If I remove the \u003ccode\u003ebeat(mixture, cheese)\u003c/code\u003e entirely, I still have a \u003ccode\u003emixture\u003c/code\u003e I can use in later steps of the recipe. So how do I know, from looking at the code, that removing a step or re-ordering them so that \u003ccode\u003ebeat(cheese)\u003c/code\u003e comes after \u003ccode\u003ebeat(mixture, cheese)\u003c/code\u003e is a problem?\u003c/p\u003e\n\u003cp\u003eThe answer is, you often don't, and neither does your computer, or your editor and linter, who aren't going to help you spot the fact that you accidentally swapped two of the imperative statements:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.lihaoyi.com/post/BasicFunctionalProgramming/ImperativeError.png\"\u003eImperative Error\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFundamentally, in the \"FP\" example, the code is laid out in a way that the \"correct\" usage is obvious: each function, e.g. \u003ccode\u003ebeat\u003c/code\u003e, only depends on the things that are passed into it, and it's output is only depended upon by whoever uses it's return value. In the \"Imperative\" example, it's not clear who depends on who: you have to memorize the fact that \u003ccode\u003ebeat(cheese)\u003c/code\u003e must come before \u003ccode\u003ebeat(mixture, cheese)\u003c/code\u003e, and not the other way around.\u003c/p\u003e\n\u003cp\u003eWhile this is not difficult assuming we are looking at already-correct code (the current order is the correct order!), when mistakes are made, and code happens to be incorrect, \"FP\" code makes the mistakes much easier for you (or your linter) to spot so you can correct them.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eWhile this example may seem contrived, the basic problem exists in all large codebases I've worked with. For example, maybe you've bumped into code similar to the following three functions:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003einitialize\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n   \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e lines of messy code\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e no \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_app\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n   \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token number\"\u003e2000\u003c/span\u003e lines of messy code\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e no \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003estart_server\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n   \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token number\"\u003e4000\u003c/span\u003e lines of messy code\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e no \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhich transitively depend on a 1 million line codebase (\"The App\"). How could I know that \u003ccode\u003estart_server()\u003c/code\u003e needs to be called before \u003ccode\u003emake_app()\u003c/code\u003e, which itself needs to be called before \u003ccode\u003einitialize()\u003c/code\u003e, when all of them are global functions which don't take arguments or return anything? I have certainly spent countless days of my career puzzling over such mysteries in large codebases, and I am sure others have too. If \u003ccode\u003estart_server\u003c/code\u003e returned something I needed to pass to \u003ccode\u003emake_app\u003c/code\u003e, which returned something I needed to pass to \u003ccode\u003einitialize\u003c/code\u003e, that would make it clear from the outset which one needs to come before the other.\u003c/p\u003e\n\u003cp\u003eRe-ordering or shuffling around statements is not uncommon. When you are refactoring a piece of code to let you re-use it in a different place, a lot of time is spent shifting bits of code up and down small amounts, just like the example I showed above, so that the code you want to re-use is all in one place and you can extract it into a helper.\u003c/p\u003e\n\u003cp\u003ePerhaps you just want to tidy up what was previous a messy function to organize the code a bit better than it already is, grouping related lines so they can be read together easily, without changing any behavior at all.\u003c/p\u003e\n\u003cp\u003eOr perhaps, as mentioned earlier, someone made a mistake and the code \u003cem\u003ethat already exists\u003c/em\u003e is incorrect, and your job is to figure out which of the statements is out of order so you can fix it.\u003c/p\u003e\n\u003cp\u003eAll of these are things that software engineers do day in, day out. And often, we make mistakes when doing so. With functional programming, whether in a typed language or not, it tends to be much more clear when you've made a trivial, dumb error. That means you get feedback quicker: you get corrected quietly by your linter in the privacy of your own laptop, and can quickly fix it and make progress, rather than waiting a long time only to be loudly yelled at by Jenkins CI in front of your entire team.\u003c/p\u003e\n\u003ch3 id=\"refactoring-a-functional-tiramisu-recipe\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#refactoring-a-functional-tiramisu-recipe\"\u003eRefactoring a Functional Tiramisu Recipe\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#refactoring-a-functional-tiramisu-recipe\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eEven if you haven't already-made a mistake, and are just \u003cem\u003ethinking\u003c/em\u003e of making a change to a codebase, the \u003ccode\u003e# FP\u003c/code\u003e version of the code is a lot easier to think about than the \u003ccode\u003e# Imperative\u003c/code\u003e version. The same often applies whether you're writing dealing with Python, Javascript, Scala, or a Tiramisu recipe!\u003c/p\u003e\n\u003cp\u003eI have already shown above how the 2D-block-diagram version of this recipe is exactly equivalent in semantics to a \"FP\" Python function. For this section I will use the 2D-block-diagrams to illustrate my points, as it is much clearer visually, but the same kind of reasoning applies to \"FP\" code in Python or any other programming language. While working with an FP style, you quickly get used to performing the same analyses in your head, just as quickly, but on lines of source code rather than 2D-block-diagrams.\u003c/p\u003e\n\u003cp\u003eWhat is interesting is that this structure lets us very easily answer some of the questions we asked above:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eIf I have two people to make this tiramisu, which parts can be done in parallel?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThis one is easy:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/Parallel.avif\" alt=\"Parallel\"\u003e\u003c/p\u003e\n\u003cp\u003eAnything vertically separated can be done in parallel. For example, preparing the ladies fingers and preparing the eggs/sugar/wine are separate and can be done independently, as can whipping the cream and mascarpone cheese. Thus, if you have three people, you might assign:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eone person to be the egg/wine/sugar mixture czar,\u003c/li\u003e\n\u003cli\u003eone to be the mascarpone/cream czar, and\u003c/li\u003e\n\u003cli\u003eone to be the expresso/ladyfingers czar.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn the other hand, anything horizontally separated has to be done sequentially:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/Sequential.avif\" alt=\"Sequential\"\u003e\u003c/p\u003e\n\u003cp\u003eThus even if you parallelize the early bits, the later beat-fold-assembly-refrigerate steps all have to be done sequentially, and how much time you can save on your Tiramisu is limited by the length of the \u003ca href=\"https://en.wikipedia.org/wiki/Critical_path_method\"\u003eCritical Path\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eWorking with the \"FP\" representation of the recipe doesn't shorten the critical path, and thus doesn't affect how much you can \"theoretically\" speed up your recipe with parallelism. What it does do is make clear exactly which parts of the recipe can be parallelized and which can't, so you can more quickly organize your work to get maximum parallelism given the constraints of the recipe, and then move on to other things.\u003c/p\u003e\n\u003cp\u003eAgain, while we're looking at a 2D-block-diagram, the same applies to FP-style code in Python, Javascript, Scala, or any other programming language.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eMy expresso hasn't arrived yet; can I shift that step down and do other things first and include the expresso later when it arrives?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/MissingExpresso.avif\" alt=\"MissingExpresso\"\u003e\u003c/p\u003e\n\u003cp\u003eIf you expresso hasn't arrived, anything depending on it can't be done, but anything else involving eggs/sugar/wine/cheese/cream can be prepared: the sections marked in red make it clear which parts of the recipe depend on expresso; the rest can be done while waiting for the expresso to arrive\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eWhat if my eggs haven't arrived? Which steps can I do first before the eggs turn up?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/MissingEggs.avif\" alt=\"MissingEggs\"\u003e\u003c/p\u003e\n\u003cp\u003eIn this case, the top block can't be done but you can prepare the bottom and middle blocks: preparing the expresso, beating the cream and mascarpone cheese. Again, this is obvious from looking at the diagram\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eAt step 9. I screwed up and spilled the bowl onto the floor. Which steps do I need to re-do (and which ingredients I may have to re-purchase) to recover and continue the recipe?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eStep 9 is when you beat the Mascarpone cheese into the egg mixture. Once we find it on the diagram, it's clear what we need to do:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FailBeatCheese.avif\" alt=\"FailBeatCheese\"\u003e\u003c/p\u003e\n\u003cp\u003eYou will need to get some new eggs/sugar/wine/cheese and beat/beat/whisk/beat them all over again\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eWhat if I spilled the bowl at step 10? Or step 8?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FailFoldCream.avif\" alt=\"FailFoldCream\"\u003e\u003c/p\u003e\n\u003cp\u003eSpilling the bowl at step 10 (folding the whipped cream into the main mixture) is the same as spilling the bowl at step 9, except you need to get new cream too.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FailBeatCream.avif\" alt=\"FailBeatCream\"\u003e\u003c/p\u003e\n\u003cp\u003eSpilling the bowl at step 8 (beating Mascarpone cheese) and you just need to get new mascarpone cheese and beat it. The rest of your ingredients are fine.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eJust before step 10, you realize you forgot to do step 7. How much of your ingredients have been ruined?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/ForgotWhipCream.avif\" alt=\"ForgotWhipCream\"\u003e\u003c/p\u003e\n\u003cp\u003eIn the diagram above, the red boxes represent the steps we've already done, up to step 10 (folding in the whipped cream). As you can see, not having done step 7 (whipping the heavy cream) is no big deal; we haven't needed to done it up to now, so we can do it and continue with step 10\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eWhat if the forgotten step was step 4? Or step 2?\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIf you forgot step 4 (whisking in wine and sugar to the beaten eggs) you've ruined your eggs/sugar/wine/cheese:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/ForgotWineSugar.avif\" alt=\"ForgotWineSugar\"\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see, the stuff we've been whisking and beating was not prepared properly before being whisked and beaten, since we forgot to mix in the wine and sugar. Assuming we don't know enough kitchen chemistry to incorporate the wine/sugar in at this stage (Our eggs may well have turned into omelettes by now without the additional liquid from the wine...) we will need to re-do all the steps in the upper red box.\u003c/p\u003e\n\u003cp\u003eIf you forgot step 2 (dissolving sugar into expresso) you're fine. The expresso hasn't been needed yet:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/ForgotExpresso.avif\" alt=\"ForgotExpresso\"\u003e\u003c/p\u003e\n\u003cp\u003eAccording to the imperative recipe above, we \u003cem\u003eshould\u003c/em\u003e have done the expresso mixing first before starting on the egg/wine/cheese. But even though we didn't do it, it is trivial to see from the FP-style recipe that there really isn't any loss: no other steps so far depended on that, no other ingredients were ruined.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eAs you can see, many of the questions that were non-trivial to answer when dealing with the imperative code back in \u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#kitchen-refactoring\"\u003eKitchen Refactoring\u003c/a\u003e are now trivial to answer when working with the FP-style 2D-block-diagrams.\u003c/p\u003e\n\u003cp\u003eAgain, while nobody actually codes in 2D-block-diagrams (except skilled engineers running recipe blogs) the 2D-block-diagrams are equivalent to a relatively straightforward snippet as shown above. With some experience dealing with FP code, you can often perform the same analyses just as easily when working directly with the equivalent Python code we showed earlier. And it's not just about programmers: automated tools linters or IDEs often perform the same analysis on the fly, as \u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#preventing-errors-with-functional-programming\"\u003eshown earlier\u003c/a\u003e, quickly alerting you if you make a mistake that means the recipe can no longer be completed successfully:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FunctionalError.avif\" alt=\"FunctionalError\"\u003e\u003c/p\u003e\n\u003ch3 id=\"the-core-of-functional-programming\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#the-core-of-functional-programming\"\u003eThe Core of Functional Programming\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#the-core-of-functional-programming\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eThe core of Functional Programming is thinking about data-flow rather than control-flow\u003c/strong\u003e. Although, by virtue of editing plain text, you are forced to order your code in a linear sequence of statements, those statements are a thin skin over what you really care about: the shape and structure of the data-flow graph within your program.\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    beat_eggs \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebeat_eggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisked \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat_cheese \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    cheese_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ewhisked\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e beat_cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whipped_cream \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    folded_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e whipped_cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sweet_espresso \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    wet_fingers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e soak2seconds\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sweet_espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assembled \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efolded_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wet_fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    complete \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eassembled\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    ready_tiramisu \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecomplete\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e ready_tiramisu\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/CodeGraph.avif\" alt=\"CodeGraph\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/DiagramGraph.avif\" alt=\"DiagramGraph\"\u003e\u003c/p\u003e\n\u003cp\u003eSimilarly, when \u003cem\u003eexecuting\u003c/em\u003e a \"functional program\" in a single thread, you are forced to pick a linear order in which you execute each individual instruction, which e.g. might be the same as the order in which it is written down in the code. But since we know what \u003cem\u003ereally\u003c/em\u003e matters is the shape of the data-flow graph, we can freely re-arrange the statements in the code, and the order of execution, as long as the graph shape is preserved. Since the data-flow graph matches the graph of definitions and usages, even your editors and linters understand it enough to warn you if you re-arrange things in an invalid order. In fact, if you have multiple cores (or multiple cooks!) you can execute parts of it in parallel, not in any linear order at all! Exactly in what order the \u003ca href=\"https://en.wikipedia.org/wiki/Program_counter\"\u003eprogram-counter\u003c/a\u003e proceeds from instruction to instruction is irrelevant.\u003c/p\u003e\n\u003cp\u003eThis is in contrast to an imperative program, where the exact \u003cem\u003eorder\u003c/em\u003e in which the program-counter executes each statement, going in and out of loops, in and out of sub-routines, is the key to understanding the program. In an imperative program, you tend to think in terms of steps that must happen \"before\" and \"after\", and make sure that the control-flow of the program executes the commands in the right order for the program to work.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNote that none of the FP examples here are \"less complex\" than the \"imperative\" recipe we discussed above\u003c/strong\u003e. It's about the same number of lines:\u003c/p\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# over steam\u003c/span\u003e\n    whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e mixture \u003cspan class=\"token comment\"\u003e# it's now a tiramisu\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003emake_tiramisu\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cheese\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cream\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e fingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    beat_eggs \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeggs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebeat_eggs\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sugar1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wine\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whisked \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whisk\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emixture\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    beat_cheese \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    cheese_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e beat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ewhisked\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e beat_cheese\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    whipped_cream \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whip\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    folded_mixture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fold\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003echeese_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e whipped_cream\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    sweet_espresso \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dissolve\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esugar2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    wet_fingers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e soak2seconds\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efingers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sweet_espresso\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    assembled \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e assemble\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efolded_mixture\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e wet_fingers\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    complete \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sift\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eassembled\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cocoa\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    ready_tiramisu \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e refrigerate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecomplete\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e ready_tiramisu\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhether as multiple statements, one big expression, or as a 2D block diagram. All the same operations are present: \u003ccode\u003ebeat\u003c/code\u003eing, \u003ccode\u003ewhip\u003c/code\u003eing, \u003ccode\u003efold\u003c/code\u003eing, etc.. \u003cstrong\u003eFunctional Programming is not about hiding ugly code in helper methods and hoping nobody notices: it's about managing the same complexity in a way that makes the dependencies between each piece of code obvious, by following the graph of where function arguments come from and where return values end up.\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWhen you have a working program, having the dependency graph of function return values being passed into other functions as arguments makes it really easy to analyze code. For example, if we were curious what \u003cem\u003eexactly\u003c/em\u003e is required to get our \u003ccode\u003ewet_fingers_mixture\u003c/code\u003e, we can see:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ewet_fingers\u003c/code\u003e comes from \u003ccode\u003esoak2seconds(fingers, sweet_espresso)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esweet_espresso\u003c/code\u003e comes from \u003ccode\u003edissolve(sugar2, espresso)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esugar2\u003c/code\u003e, \u003ccode\u003efingers\u003c/code\u003e, \u003ccode\u003eespresso\u003c/code\u003e are the initial ingredients of the recipe\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAn there you have it: just a few steps, entirely mechanical, and we can see exactly what \u003ccode\u003ewet_fingers\u003c/code\u003e needs. We need no understanding of what \u003ccode\u003edissolve\u003c/code\u003e does, or what a \u003ccode\u003esugar2\u003c/code\u003e is: just from the structure of the code we can already see what \u003ccode\u003ewet_fingers\u003c/code\u003e requires. Just as importantly, we can also see that it does \u003cem\u003enot\u003c/em\u003e depend on \u003ccode\u003efolded_mixture\u003c/code\u003e, \u003ccode\u003ewhipped_cream\u003c/code\u003e, or any of the other steps that are above it in the code: while those steps \"come before\" the operations that give us a \u003ccode\u003ewet_fingers\u003c/code\u003e, it's clear from this analysis that their ordering is entirely accidental, and that we could e.g. prepare the \u003ccode\u003ewet_fingers\u003c/code\u003e before the other steps if we so desired.\u003c/p\u003e\n\u003cp\u003eIt's not hard to do this yourself, but any IDE with jump-to-definition should be able to do this for you, and so can automated linters and code analysis tools. And understanding the code is the first step in changing it, without bugs.\u003c/p\u003e\n\u003cp\u003eWhen you have a broken program, having the dependencies be easy to analyze means it's easier to spot when you make a mistake or do something out of order: even in a dynamic language like python, a subtly bad copy-paste job can get called out by your editor so you can fix it before needing to run any code:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/FunctionalError.avif\" alt=\"FunctionalError\"\u003e\u003c/p\u003e\n\u003cp\u003eWhether you're working in a dynamic language like Python or a static language like Scala, whether your code is currently working or broken, \u003cstrong\u003eFunctional Programming's data-flow-centric approach helps you understand your code faster, easier and with more tooling help than a Imperative, mutation-heavy approach.\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"conclusion\"\u003e\u003ca href=\"https://www.lihaoyi.com/post/WhatsFunctionalProgrammingAllAbout.html#conclusion\"\u003eConclusion\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#conclusion\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eThe core of Functional Programming is thinking about data-flow rather than control-flow\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/dev/FP/TiramisuDiagram.avif\" alt=\"TiramisuDiagram\"\u003e\u003c/p\u003e\n\u003cp\u003eWhile this may seem a trivial definition of \"Functional Programming\", I think it is really the core of the idea. While there are many further steps, from the simple (immutability, referential transparency, ...) to the more advanced (monads, lenses, ...) this core of should be something that everyone, from newbies to old hands, whether using Scala or Clojure or Haskell or React.js, should be able to empathise with. Even in a language like Python, as I have used for the examples, it is possible to program in a more \"Functional\" style, and reap some of the benefits of functional programming.\u003c/p\u003e\n\u003cp\u003eThose more advanced topics don't really fit this worked example anyway: kitchen ingredients tend to be very, very mutable (and perishable!).\u003c/p\u003e\n\u003cp\u003eThough it's growing, this baseline-level of FP is not yet widespread in industry.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhole languages, such as Bash, make it a pain in the neck to take non-trivial function arguments or return non-trivial results, resulting in people's code writing things to the filesystem, hopefully \"before\" someone else needs to read them.\u003c/li\u003e\n\u003cli\u003eLanguages like Java encourage patterns where you instantiate a half-baked object and then set the fields later, praying that nobody accidentally tries to use it \"too early\" it in it's half-baked state while it's internal variables are garbage.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn all of these cases, the \u003cem\u003eorder\u003c/em\u003e in which things run - exactly how the program-counter progresses from statement to statement, in and out of for-loops, in and out of sub-routines - is critical.\u003c/p\u003e\n\u003cp\u003eEven in the kitchen, having a \"FP-style\" recipe like the block diagram I showed above is helpful, because when the person bringing your Marsala Wine is stuck in traffic, it makes it easier to re-organize your recipe so you can get as much work done immediately. When that person arrives, it helps you figure out how to parallelize the work over the people you have available. When someone screws up, it helps you figure out exactly which ingredients you need to re-purchase and steps you need to re-do.\u003c/p\u003e\n\u003cp\u003eThis widespread applicability, even to fields outside the software world, and to every \"FP\" language \u003cem\u003ewithin\u003c/em\u003e the software world, is why I think this is truly what functional programming is all about.\u003c/p\u003e","noteIndex":{"id":"Iy0MoL0KnL55Br3AfTS2C","title":"Luke","desc":"","updated":1761796791487,"created":1644449449778,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"4e745570ca97988a0362cb939b760952","links":[{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"life-tips","position":{"start":{"line":41,"column":5,"offset":2603},"end":{"line":41,"column":29,"offset":2627},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"life-tips","anchorHeader":"wodenokoto"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2025","alias":"What I read in 2025","position":{"start":{"line":70,"column":3,"offset":4333},"end":{"line":70,"column":54,"offset":4384},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2025"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2024","alias":"2024","position":{"start":{"line":71,"column":5,"offset":4389},"end":{"line":71,"column":41,"offset":4425},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2024"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2023","alias":"2023","position":{"start":{"line":72,"column":5,"offset":4430},"end":{"line":72,"column":41,"offset":4466},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2023"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2022","alias":"2022","position":{"start":{"line":73,"column":5,"offset":4471},"end":{"line":73,"column":41,"offset":4507},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2022"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-struggled-brag-in","position":{"start":{"line":79,"column":3,"offset":4643},"end":{"line":79,"column":39,"offset":4679},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-struggled-brag-in"}}],"anchors":{"what-i-read-in-past":{"type":"header","text":"What I read in past","value":"what-i-read-in-past","line":74,"column":0,"depth":2}},"children":["zd4mq442jike0pr0wba1u3m","6hzeqsofq67gdk88flxlkhp","778ijii93yu5uwnrwmn5zi4","g1fngdjl25nes6fs3lip602","ZbdkdApFqLdks4Moq92R9","uoc5hhki3o4py15cesddu8q","9qf7j06jtdkm6rnx9ymvwb0","5zn10cvj7ajy2gh2is5nqmg","4qo9ma0z0yu1czns6pxl7y5","ok0e729ho7o09xetujkxc0m","GR5x8HnNFEN6fU2UBSEIK","yirtnlj8q24yutcf3ss1xqy","eq0wc6t7wl2wv221yb68ro4","7x2fnv4j6gxts08qk0jguny","ettkt3iClONnxpbGwBVLl","7l4knev6v613tbuoskvmbdg","hvh5bud6yp7dc89tuh95tr9","4fvoqrplw0cweo554usbjos","f8qsfql0a9v8thpeo82udfa","1swsbrhqi9jk41v9eodyi5q","SQqYupi6EFddTerBA8RRD","hjNeNc1F2JUh0lTWanH4h","qf0l4wbrc9jgooyzexmbq5v","uur1lkol353z9vfeqb3n5bv","cd9n1czq3ursgkby985wkmm","k1sr43vwnfqztwc0s43pkcf","wfde75rhdvq2yfa2zy2q6rv","rjcmdv60jokmbw6zoq8u2ef","ujapvww8o6v3kpmlhtryq4k","pkwewou9d5e8ystswn1j2b4"],"parent":null,"data":{},"body":"\nHi there 👋. I'm a Front-end developer.\n\n---\n\n- 단순함과 꾸준함은 가장 쉬우면서도 지키기 어려운 원칙.\n\n- 🥱 -\u003e 🤔💡🌱 - [On The Death of Daydreaming](https://www.afterbabel.com/p/on-the-death-of-daydreaming)\n  - boredom -\u003e easy fun -\u003e art -\u003e profit?\n\n\u003e I've often described my motivation for building software to others using imagery: I like to go find a secluded beach, build a large, magnificent sand castle, and then walk away. Will anyone notice? Probably not. Will the waves eventually destroy it? Yep. Did I still get immense satisfaction? Absolutely. - [aliasxneo](https://news.ycombinator.com/item?id=41497113)\n\n\u003e We love to see the process, not just the result. The imperfections in your work can be beautiful if they show your struggle for perfection, not a lack of care. - [ralphammer](https://ralphammer.com/is-perfection-boring/)\n\n\u003e Simplicity, even if it sacrifices some ideal functionality has better survival characteristics than the-right-thing. - [The Rise of Worse is Better](https://www.dreamsongs.com/RiseOfWorseIsBetter.html)\n\n\u003e [Roberto Blake was talking about making 100 crappy videos](https://www.youtube.com/watch?v=OnUBaQ1Sp_E) to get better over time. Putting in the reps and improving a little bit each time.\n\u003e\n\u003e Putting in the work without expecting any external reward at first (eg views, followers, likes, etc) will pay off in the long run. - [100 Scrappy Things](https://www.florin-pop.com/blog/100-scrappy-things/)\n\n\u003e Make the difficult habitual, the habitual easy, and the easy beautiful. - [Constantin S. Stanislavski](https://www.goodreads.com/quotes/7102271-make-the-difficult-habitual-the-habitual-easy-and-the-easy)\n\n\u003e A good match is a **structured** dance, where players aim to **score** while they are following well-defined **rules**. This **freedom within a structure** is what makes it fun. - [ralphammer](https://ralphammer.com/how-to-get-started/)\n\n- [Pivot Points](https://longform.asmartbear.com/pivot-points/)\n\n  - non-judgmental aspects of personality that can be strengths in some contexts and weaknesses in others\n  - Pivot Points are fixed in the short term\n\n- [Hedged Bets](https://longform.asmartbear.com/predict-the-future/#hedged-bets)\n  - trading slightly less maximum upside for predictable, net-positive outcomes.\n\n\u003e “Motivation often comes after starting, not before. Action produces momentum.”\n\u003e [When you start a new habit, it should take less than two minutes to do.](https://jamesclear.com/how-to-stop-procrastinating)\n\u003e\n\u003e - James Clear\n\n\u003e Focus is more about **not** keeping busy when you need to wait for something.  \n\u003e Eat the boredom for a minute.\n\u003e\n\u003e - [[life-tips#wodenokoto]]\n\n\u003e [4 minutes run hard enough to push heart rate to 90%, 3 minutes recover, repeat 4 times](https://news.ycombinator.com/item?id=34213181)\n\u003e\n\u003e - https://www.ntnu.edu/cerg/advice\n\u003e - [Get running with Couch to 5K](https://www.nhs.uk/live-well/exercise/running-and-aerobic-exercises/get-running-with-couch-to-5k/)\n\n\u003e [recommended routine - bodyweightfitness](https://www.reddit.com/r/bodyweightfitness/wiki/kb/recommended_routine/) - I Don't Have This Much Time!\n\u003e\n\u003e - Don't workout at all (saves anywhere from 20 to 60 minutes, but really, really, really, really, really, really, really, really, really not recommended)\n\n\u003e 도무지 읽히지 않는 책 앞에서 내가 택한 방법은 펼쳐진 페이지 앞에서 멍때리기이다. 다르게 표현하면 이렇다. 펼쳐진 두 페이지 앞에서 오래 머물기.\n\u003e\n\u003e 책을 펼쳐놓는 것으로 충분하다. 읽지 못해도 좋다. 매일 정해진 진도를 나가야 하는 학교 수업이 아니니까. 하지만 읽지 않아도 괜찮다고 해서 펼쳐두지조차 않으면 곤란하다. 가능한 한 자주 책을 펼쳐두도록 하자. 전혀 읽지 않고 멍하니 바라보고 있다가 다시 덮게 되더라도\n\u003e\n\u003e - 막막한 독서. 시로군. P.10~13\n\n\u003e I think it should be everyone's primary focus to sleep well, drink water, get outside, get active, and eat generally decently. I hate to say it, but if you're not eating a good amount of vegetables and fruit, decent protein, sleep, etc, no amount of XYZ will catch up to that detriment. - [CE02](https://news.ycombinator.com/item?id=35056071)\n\n\u003e My real battle is doing good versus doing nothing. - [Deirdre Sullivan](https://www.npr.org/2005/08/08/4785079/always-go-to-the-funeral)\n\n[Kind Engineering](https://kind.engineering/) - How To Engineer Kindness\n\n\u003e Sometimes magic is just someone spending more time on something than anyone else might reasonably expect. - [Teller](https://www.goodreads.com/quotes/6641527-sometimes-magic-is-just-someone-spending-more-time-on-something)\n\n---\n\n## What I read in past\n\n- [[What I read in 2025|journal.what-i-read-in.2025]]\n  - [[2024|journal.what-i-read-in.2024]]\n  - [[2023|journal.what-i-read-in.2023]]\n  - [[2022|journal.what-i-read-in.2022]]\n- 📝 [Gists](https://gist.github.com/Luke-SNAW)\n- 📜 [Journals](https://luke-snaw.github.io/Luke-SNAW__netlify-CMS.github.io/)\n\n---\n\n- [[journal.what-i-struggled-brag-in]]\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":false,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.115.0","enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Luke SNAW","description":"Personal knowledge space"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://luke-snaw.github.io/","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"ibhefhzrpmuguq2tbmg1383"},"buildId":"vOE8u-mg___OsOsz4tjEg","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>