<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Draggable objects</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="Draggable objects"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://luke-snaw.github.io//notes/0pt1h99anrpns3e7xkundxk/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="10/4/2023"/><meta property="article:modified_time" content="10/4/2023"/><link rel="canonical" href="https://luke-snaw.github.io//notes/0pt1h99anrpns3e7xkundxk/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_buildManifest.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="draggable-objects">Draggable objects<a aria-hidden="true" class="anchor-heading icon-link" href="#draggable-objects"></a></h1>
<blockquote>
<p><a href="https://www.redblobgames.com/making-of/draggable/">from Red Blob Games</a></p>
</blockquote>
<p>Many of my interactive pages have a <em>draggable object</em>. I want the reader to move the object around, and I want the diagram to respond in some way. Here I’ll document the code I use to make this work with both mouse and touch input, using browser features that are widely supported since 2020. Here’s a common case I want to support:</p>
<p>Drag me</p>
<p>Drag the circle with mouse or touch</p>
<p>This is the simple model in my head:</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/state.svg">state.svg</a></p>
<p>However it’s not so simple! Mouses have multiple buttons. Touch events can include multiple fingers. Events can go to multiple destinations. Right click can trigger the context menu. I ended up with this basic recipe:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Text inside draggable</li>
<li class="task-list-item"><input type="checkbox" disabled> Multiple fingers on same draggable</li>
<li class="task-list-item"><input type="checkbox" disabled> Nested draggable elements</li>
</ul>
<p>Like other recipes, it’s something that works for many cases, but is <strong>meant to be modified</strong>. On the rest of the page I’ll show how I got here and then variants of this recipe, including <a href="https://www.redblobgames.com/making-of/draggable/#variant-text">how to handle text selection</a>. I also use this same recipe to handle situations where I’m <em>not</em> dragging an object around, like dragging this number left/right: <code>123</code>, or <a href="https://www.redblobgames.com/making-of/draggable/targets.html#canvas-drag-to-paint">painting on a canvas</a>.</p>
<p>I’ve tested this code on Gecko/Firefox (Mac, Windows, Linux, Android), Blink/Chrome (Mac, Windows, Linux, Android), and WebKit/Safari (Mac, iPhone, iPad). I have <em>not</em> tested on hoverable stylus, hybrid touch+mouse devices, or voice input.</p>
<p>Also see my other pages:</p>
<ol>
<li><a href="https://www.redblobgames.com/making-of/draggable/targets.html">List of edge cases and list of dragging tests</a></li>
<li><a href="https://www.redblobgames.com/x/2251-draggable/">Test page to log the events, and unorganized notes</a></li>
<li><a href="https://www.redblobgames.com/x/1845-draggable/">How I handled dragging events 2015–2018</a></li>
</ol>
<p>Note that this is <em>not</em> the HTML <a href="https://www.redblobgames.com/x/2310-drag-drop-api/">Drag and Drop API</a>, which involves dragging an element <em>onto</em> another element. For my diagrams, I’m dragging but <em>not</em> dropping, and the scrubbable number example shows how I’m not necessarily even moving something around. So I need to read the mouse/touch events directly.</p>
<h2 id="1-️-mouse-events-only">1 <a href="https://www.redblobgames.com/making-of/draggable/#mouse-events">🖱️ Mouse events only</a><a href="https://www.redblobgames.com/making-of/draggable/#mouse-events">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#1-️-mouse-events-only"></a></h2>
<p>When I first started implementing interactive diagrams ~20 years ago, touch devices weren’t common. I used <code>mousedown</code>, <code>mouseup</code>, and <code>mousemove</code> event handlers on the draggable element. If the move occurs while dragging, move the circle to the mouse position.</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/mouse-local.svg">mouse-local.svg</a></p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggableMouseLocal</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">mousedown</span><span class="token punctuation">(</span><span class="token parameter">_event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">mouseup</span><span class="token punctuation">(</span><span class="token parameter">_event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">mousemove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span> mousedown<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mouseup"</span><span class="token punctuation">,</span> mouseup<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> mousemove<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Try</strong> the demo with a mouse:</p>
<p>Drag me</p>
<p>Drag using mouse events on circle</p>
<p>This might seem like it works but it works poorly.</p>
<ul>
<li>If you move the pointer quickly it is no longer over the circle, it stops receiving events.</li>
<li>If you release the button while not on the circle, it will get stuck in the “dragging” state.</li>
</ul>
<p>To fix these problems use <code>mousedown</code> on the circle to add <code>mousemove</code> and <code>mouseup</code> on the <em>document</em>. Then on <code>mouseup</code> remove the <code>mousemove</code> and <code>mouseup</code> from the document.</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/mouse-document.svg">mouse-document.svg</a></p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggableMouseGlobal</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">globalMousemove</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">globalMouseup</span><span class="token punctuation">(</span><span class="token parameter">_event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> globalMousemove<span class="token punctuation">)</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mouseup"</span><span class="token punctuation">,</span> globalMouseup<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mousedown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> globalMousemove<span class="token punctuation">)</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mouseup"</span><span class="token punctuation">,</span> globalMouseup<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousedown"</span><span class="token punctuation">,</span> mousedown<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Try it out. It works better.</p>
<p>Drag me</p>
<p>Drag using mouse events on document</p>
<p>This code doesn’t handle touch events.</p>
<h2 id="2--touch-events">2 <a href="https://www.redblobgames.com/making-of/draggable/#touch-events">👆 Touch events</a><a href="https://www.redblobgames.com/making-of/draggable/#touch-events">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#2--touch-events"></a></h2>
<p>Mouse events use <code>mousedown</code>, <code>mouseup</code>, <code>mousemove</code>. Touch events instead use <code>touchstart</code>, <code>touchend</code>, <code>touchmove</code>. They behave a little differently. Touch events automatically <em>capture</em> on <code>touchstart</code> and direct all <code>touchmove</code> events to the original element. This means we <em>don’t</em> have to temporarily put an event handler on <code>document</code>. We can go back to the simpler logic in the first mouse example. If for any reason the browser needs to cancel the touch sequence, it sends <code>touchcancel</code>.</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/touch.svg">touch.svg</a></p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggableTouch</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// prevent scrolling</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">_event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">changedTouches</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchend"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchcancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchmove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Try</strong> the demo with a touch device:</p>
<p>Drag me</p>
<p>Drag using touch events</p>
<p>This code doesn’t handle mouse events.</p>
<h2 id="3-️-pointer-events">3 <a href="https://www.redblobgames.com/making-of/draggable/#pointer-events">🖱️👆 Pointer events</a><a href="https://www.redblobgames.com/making-of/draggable/#pointer-events">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#3-️-pointer-events"></a></h2>
<p>Handling both mouse and touch events requires lots of event handlers, and that’s what I used before 2021. Details→</p>
<p>From 2011 to 2014 I used <a href="https://github.com/d3/d3-drag">d3-drag</a><sup class="print-endnote">[1]</sup> in projects where I used d3. For my non-d3 projects, I ended up developing my own mouse+touch code, which I wrote about <a href="https://www.redblobgames.com/x/1845-draggable/">in 2018</a>.</p>
<p>By 2012 MS IE had added support for <a href="https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events">pointer events</a><sup class="print-endnote">[2]</sup> which unify and simplify mouse+touch handling. <a href="https://caniuse.com/pointer">Chrome added support in 2017; Firefox in 2018; Safari in 2020</a><sup class="print-endnote">[3]</sup>.</p>
<p>Over the years browsers have changed the rules, including in 2017 when <a href="https://developer.chrome.com/blog/scrolling-intervention/">Chrome changed some events to default to passive mode</a><sup class="print-endnote">[4]</sup> which causes the page to scroll while trying to drag the object. This <a href="https://github.com/WICG/interventions/issues/18#issuecomment-276531695">broke some pages</a><sup class="print-endnote">[5]</sup>. Safari <a href="https://github.com/WICG/interventions/issues/18#issuecomment-368703063">made this change in 2018</a><sup class="print-endnote">[6]</sup>. Firefox also <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1449268">made this change in 2018</a><sup class="print-endnote">[7]</sup>.</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/mouse-and-touch.svg">mouse-and-touch.svg</a></p>
<p>Pointer events attempt to unify mouse and touch events. The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setPointerCapture">pointer capture</a><sup class="print-endnote">[8]</sup> feature lets us use the simpler logic that doesn’t require us to add/remove global event handlers to the document like we had to with mouse events.</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/pointer.svg">pointer.svg</a></p>
<p>This recipe is the starting point:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Much simpler! However, I almost always want to handle some extras, so I start with this instead:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Try</strong> the demo with either a mouse or touch device:</p>
<p>Drag me</p>
<p>Drag using pointer events</p>
<p>Let’s look at each of the extras.</p>
<h3 id="31-️-fix-capture-the-mouse">3.1. 🖱️ Fix: capture the mouse<a href="https://www.redblobgames.com/making-of/draggable/#fix-capture">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#31-️-fix-capture-the-mouse"></a></h3>
<p>The pointer capture feature lets us track the pointer even when it’s not on the circle, the diagram, or even the browser window. With mouse events we had to put event handlers on <code>document</code>, but pointer capture is simpler.</p>
<div class="table-responsive">








































<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th></tr></thead><tbody><tr><td>drag quickly back and forth</td><td>drag stops</td><td>yes ⛌</td><td>no ✓</td></tr><tr><td>drag outside diagram, come back in</td><td>drag stops</td><td>yes ⛌</td><td>no ✓</td></tr><tr><td>drag outside diagram, let go</td><td>drag stops</td><td>no ⛌</td><td>yes ✓</td></tr><tr><td>drag outside diagram, let go, come back in</td><td>drag stops</td><td>no ⛌</td><td>yes ✓</td></tr><tr><td>drag, alt+tab to another window</td><td>drag stops</td><td>no ⛌</td><td>yes ✓</td></tr></tbody></table></div>
<p>Drag 1 Drag 2</p>
<p>Dragging without and with pointer capture</p>
<p><strong>Try</strong> this demo with a mouse.</p>
<ul>
<li>Circle 1 doesn’t use pointer capture on mouse. Pointer capture is the default on touch devices.</li>
<li>Circle 2 uses pointer capture on both mouse and touch devices.</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="32--fix-scrolling-with-touch">3.2. 👆 Fix: scrolling with touch<a href="https://www.redblobgames.com/making-of/draggable/#fix-scroll">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#32--fix-scrolling-with-touch"></a></h3>
<p>On touch devices, single-finger drag will scroll the page. But single-finger drag <em>also</em> drags the circle. By default, it will do <em>both</em>! The simplest fix is to add CSS <kbd>touch-action: none</kbd> on the diagram. But this prevents scrolling <em>anywhere</em> in the diagram:</p>
<p>Drag 1</p>
<p>Stop touch from scrolling anywhere on the diagram</p>
<p><strong>Try</strong> dragging the circle on a touch device. It shouldn’t scroll. But then try scrolling by dragging the diagram. It doesn’t scroll either, but I want it to. I want to stop scrolling <em>only</em> if dragging the circle, not when dragging the diagram.</p>
<div class="table-responsive">




























<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th><th>Circle 3</th><th>Circle 4</th></tr></thead><tbody><tr><td>drag circle</td><td>page scrolls</td><td>no ✓</td><td>yes ⛌</td><td>yes ⛌</td><td>no ✓</td></tr><tr><td>drag diagram</td><td>page scrolls</td><td>no ⛌</td><td>yes ✓</td><td>yes ✓</td><td>yes ✓</td></tr></tbody></table></div>
<p>Drag 2 Drag 3 Drag 4</p>
<p>Dragging affects scrolling</p>
<p><strong>Try</strong> these on a touch device.</p>
<ul>
<li>Circle 1 (<kbd>touch-action: none</kbd> on the diagram) stops scrolling on the circle and also on the diagram.</li>
<li>Circle 2 (default) doesn’t stop scrolling on either.</li>
<li>Circle 3 (<kbd>touch-action: none</kbd> on the circle only) behaves badly. It looks like the CSS has to be on the diagram to have an effect; applying it only to the circle is not enough.</li>
<li>Circle 4 (<kbd>.preventDefault()</kbd> on <code>touchstart</code>) behaves the way I want, and this is the code for it:</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>I use the <kbd>.preventDefault()</kbd> solution. Note that it needs to be on <code>touchstart</code>, not on <code>pointerstart</code>. It works in most situations but I’ve run into situations where it did not stop scrolling on certain systems.</p>
<h3 id="33-️-feature-handle-drag-offset">3.3. 🖱️ Feature: handle drag offset<a href="https://www.redblobgames.com/making-of/draggable/#feature-offset">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#33-️-feature-handle-drag-offset"></a></h3>
<p>This isn’t necessary but it makes dragging feel nicer. If you pick up the edge of an object then you want to keep holding it at <em>that</em> point, not from the center of the object. The solution is to remember where the center is relative to where the drag started. Then when moving the object, add that offset back in.</p>
<div class="table-responsive">
















<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th></tr></thead><tbody><tr><td>drag from edge of circle</td><td>circle jumps</td><td>yes ⛌</td><td>no ✓</td></tr></tbody></table></div>
<p>Drag 1 Drag 2</p>
<p>Dragging feels better if relative to the initial pickup point</p>
<p><strong>Try</strong> with the mouse: drag the circle from the edge. Watch Circle 1 jump whereas Circle 2 does not. The same effect happens on touch devices but your finger might hide the jump. The fix is to change the <code>dragging</code> state from <code>true</code> / <code>false</code> to the relative position where the object was picked up, and then use that offset when later setting the position:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Tracking the offset makes dragging feel better. I’ve also written about this <a href="https://www.redblobgames.com/making-of/little-things/#drag-point">on my page about little details</a>.</p>
<h3 id="34-️-fix-context-menu">3.4. 🖱️ Fix: context menu<a href="https://www.redblobgames.com/making-of/draggable/#fix-contextmenu">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#34-️-fix-context-menu"></a></h3>
<p>Context menus are different across platforms, and that makes handling it tricky. I want to allow context menus without them interfering with dragging the circle.</p>
<div class="table-responsive">




























<table><thead><tr><th>System</th><th>Activation</th></tr></thead><tbody><tr><td>Windows</td><td>right click (down+up), <kbd>Shift</kbd> + <kbd>F10</kbd> key</td></tr><tr><td>Linux</td><td>right button down, <kbd>Shift</kbd> + <kbd>F10</kbd> key</td></tr><tr><td>Mac</td><td>right button down, <kbd>Ctrl</kbd> + left click</td></tr><tr><td>iOS</td><td>long press on text only</td></tr><tr><td>Android</td><td>long press on anything</td></tr></tbody></table></div>
<p>One problem is that I will see a <code>pointerdown</code> event and only <em>sometimes</em> a <code>pointerup</code> event. That means I might think the button is still down when it’s not. It’s frustrating! I realized that I should only set the dragging state on <em>left</em> mouse button, and ignore the right mouse button. Then I don’t have to worry about most of the differences.</p>
<p>I made some notes during testing, but most of them don’t matter for my use case.</p>
<p>Across platforms, it looks like Firefox lets the page see events outside the menu overlay, whereas Chrome doesn’t let the page see any events while the menu is up.</p>
<p>Windows, right click, no capture:</p>
<p>Firefox, Chrome, Edge</p>
<p><code>pointerdown</code>, <code>pointerup</code>, <code>auxclick</code>, <code>contextmenu</code></p>
<p>Windows, right click, capture:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, <code>gotpointercapture</code>, <code>pointerup</code>, <code>lostpointercapture</code>, <code>auxclick</code>, <code>contextmenu</code></p>
<p>Chrome, Edge</p>
<p><code>pointerdown</code>, <code>gotpointercapture</code>, <code>pointerup</code>, <code>auxclick</code>, <code>lostpointercapture</code>, <code>contextmenu</code></p>
<p>Linux right click, no capture:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>pointermove</code> while menu is up</p>
<p>Chrome</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, no <code>pointermove</code> while menu is up</p>
<p>Linux hold right down, no capture:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>pointermove</code> while menu is up</p>
<p>Chrome</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, no <code>pointermove</code> while menu is up</p>
<p>Linux right click, capture:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>gotpointercapture</code>, <code>pointermove</code> while menu is up tells us button released</p>
<p>Chrome</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>gotpointercapture</code>; not until another click do we get <code>pointerup</code>, <code>lostpointercapture</code></p>
<p>Linux hold right down, capture:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>gotpointercapture</code>, <code>pointermove</code> while menu is up tells us button released; when releasing button, menu stays up but we get <code>pointerup</code>, <code>lostpointercapture</code></p>
<p>Chrome</p>
<p><code>pointerdown</code>, <code>contextmenu</code>, <code>gotpointercapture</code>, no <code>pointermove</code> while menu is up; when releasing button, menu stays up but we don’t get <code>pointerup</code>; not until another click do we get <code>pointerup</code>, click, <code>lostpointercapture</code></p>
<p>Mac, ctrl + left click:</p>
<p>Firefox</p>
<p><code>pointermove</code> with buttons≠0, <code>contextmenu</code> (no <code>pointerdown</code> or <code>pointerup</code>)</p>
<p>Chrome</p>
<p><code>pointerdown</code> with button=left, <code>contextmenu</code> (no <code>pointerup</code>)</p>
<p>Safari</p>
<p><code>pointerdown</code> with button=left, <code>contextmenu</code> (no <code>pointerup</code>); but subsequent clicks only fire <code>contextmenu</code></p>
<p>Mac, right button down:</p>
<p>Firefox</p>
<p><code>pointerdown</code> with button=right, <code>contextmenu</code> (no <code>pointerup</code>)</p>
<p>Chrome</p>
<p><code>pointerdown</code> with button=right, <code>contextmenu</code> (no <code>pointerup</code>)</p>
<p>Safari</p>
<p><code>pointerdown</code> with button=right, <code>contextmenu</code> (no <code>pointerup</code>); but subsequent right clicks only fire <code>contextmenu</code></p>
<p>If we capture events on <code>pointerdown</code>, Firefox and Safari will keep the capture even after the button is released. Chrome will keep capture until you move the mouse, and then it will release capture. [This seems like a Firefox/Safari bug to me, as pointer capture is supposed to be automatically released on mouse up]</p>
<p>It’s frustrating that on Mac, there’s no <code>pointerup</code> or <code>pointercapture</code> when releasing the mouse button. On Linux, the <code>pointerup</code> only shows up if you click to exit the context menu. It doesn’t show up if you press <kbd>Esc</kbd> to exit. The workaround is to watch <code>pointermove</code> events to see when no buttons are set. Windows doesn’t seem to have these issues, as both <code>pointerdown</code> and <code>pointerup</code> are delivered before the context menu.</p>
<p>Android, long press:</p>
<p>Firefox</p>
<p><code>pointerdown</code>, get capture, <code>contextmenu</code>, <code>pointerup</code>, lose capture</p>
<p>Chrome</p>
<p><code>pointerdown</code>, get capture, <code>contextmenu</code>, <code>pointerup</code> or <code>pointercancel</code> (if the finger moves at all, this starts a scroll event which cancels the captured pointer), lose capture</p>
<p>What are my options?</p>
<ul>
<li><a href="https://www.w3.org/TR/pointerevents/#the-pointerdown-event">The spec says about pointerdown</a><sup class="print-endnote">[9]</sup> that <code>preventDefault()</code><em>not</em> stop click or <code>contextmenu</code> events. I can <code>preventDefault()</code> on <code>contextmenu</code> to prevent the menu. But I still want to get <code>pointerup</code> and/or <code>pointercancel</code>! I think I have to treat <code>contextmenu</code> as the up event which means I’ll get multiple up events on Windows.</li>
<li><a href="https://w3c.github.io/pointerevents/#the-button-property">The spec says about the button property</a><sup class="print-endnote">[10]</sup> that <code>button</code> = 0 indicates the primary button. This is how I will exclude the middle and right buttons. But I still get a <code>pointerdown.left</code> on Mac/Chrome and Mac/Safari (but not on Mac/Firefox) so I also have to check for the <kbd>Ctrl</kbd> key.</li>
<li>Button changes not communicated through <code>pointerdown</code> or <code>pointerup</code> can still be sent on <code>pointermove</code>. It’s mentioned as a workaround on <a href="https://github.com/w3c/pointerevents/issues/408">W3C’s pointerevents issues page</a><sup class="print-endnote">[11]</sup>.</li>
</ul>
<div class="table-responsive">




































































<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th><th>Circle 3</th><th>Circle 4</th></tr></thead><tbody><tr><td>right click</td><td>circle turns blue</td><td>yes ⛌</td><td>yes</td><td>no ✓</td><td>no ✓</td></tr><tr><td>right click</td><td>context menu</td><td>yes ⛌</td><td>no</td><td>no ✓</td><td>no ✓</td></tr><tr><td>middle click</td><td>circle turns blue</td><td>yes ⛌</td><td>yes ⛌</td><td>no ✓</td><td>no ✓</td></tr><tr><td>right drag</td><td>circle is blue</td><td>yes ⛌</td><td>yes</td><td>no ✓</td><td>no ✓</td></tr><tr><td>middle drag</td><td>circle is blue</td><td>yes ⛌</td><td>yes</td><td>no ✓</td><td>no ✓</td></tr><tr><td>ctrl+click (mac)</td><td>circle turns blue¹</td><td>yes ⛌</td><td>no ✓</td><td>yes ⛌</td><td>no ✓</td></tr><tr><td>ctrl+click (mac)</td><td>context menu</td><td>yes ⛌</td><td>no ✓</td><td>yes ⛌</td><td>no ✓</td></tr></tbody></table></div>
<p>¹ it will turn blue in Chrome and Safari but not in Firefox, which treats <kbd>Ctrl</kbd> + click differently</p>
<p>Drag 1 Drag 2 Drag 3 (Mac) Drag 4</p>
<p>Right mouse button down interferes with drag</p>
<p><strong>Try</strong> with the mouse: right click or drag on the circles. Try dismissing the menu with a click elsewhere, or by pressing <kbd>Esc</kbd>. Behavior varies across browsers and operating systems.</p>
<ul>
<li>Circle 1 sometimes get stuck in a dragging state.</li>
<li>Circle 2 uses <kbd>.preventDefault()</kbd> on <code>contextmenu</code>. This allows the right button to be used for dragging. However, it interferes with the default operation of middle click or drag, which is used for scrolling on some systems.</li>
<li>Circle 3 drags only with the left button, but on Mac <kbd>Ctrl</kbd> + click on Chrome/Safari will trigger drag.</li>
<li>Circle 4 drags only with the left button, if <kbd>Ctrl</kbd> isn’t pressed.</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">ctrlKey</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// ignore ctrl+click</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">true</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="4-️-variant-draggable-textimages">4 <a href="https://www.redblobgames.com/making-of/draggable/#variant-text">🖱️ Variant: draggable text/images</a><a href="https://www.redblobgames.com/making-of/draggable/#variant-text">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#4-️-variant-draggable-textimages"></a></h2>
<p>These changes are needed if you have text or images inside your draggable element:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
    el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">userSelect</span> <span class="token operator">=</span> <span class="token string">"none"</span> <span class="token comment">// if there's text</span>
    el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">webkitUserSelect</span> <span class="token operator">=</span> <span class="token string">"none"</span> <span class="token comment">// safari</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
    el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">userSelect</span> <span class="token operator">=</span> <span class="token string">""</span> <span class="token comment">// if there's text</span>
    el<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">webkitUserSelect</span> <span class="token operator">=</span> <span class="token string">""</span> <span class="token comment">// safari</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"dragstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="41-️-fix-text-selection">4.1. 🖱️ Fix: text selection<a href="https://www.redblobgames.com/making-of/draggable/#fix-user-select">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#41-️-fix-text-selection"></a></h3>
<p>When dragging the circle, the text inside gets selected sometimes. To fix this, use CSS <kbd>user-select: none</kbd> on the circle. There are two choices: either we can apply it <em>all</em> the time, or apply it <em>only</em> while dragging. If I apply it all the time, then the text won’t ever be selectable.</p>
<div class="table-responsive">

























<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th><th>Circle 3</th></tr></thead><tbody><tr><td>drag circle</td><td>text is selected</td><td>yes ⛌</td><td>no ✓</td><td>no ✓</td></tr><tr><td>select all text</td><td>text is selected</td><td>yes</td><td>no</td><td>yes</td></tr></tbody></table></div>
<p>Drag text 1 Drag text 2 Drag text 3</p>
<p>Dragging affects text selection</p>
<p><strong>Try</strong> dragging quickly with the mouse. <strong>Try</strong> selecting all text on the page to see whether the text inside the circle is selectable when not dragging.</p>
<ul>
<li>Circle 1 never uses <kbd>user-select: none</kbd></li>
<li>Circle 2 always uses <kbd>user-select: none</kbd></li>
<li>Circle 3 uses <kbd>user-select: none</kbd> only when dragging</li>
</ul>
<p>I think either Circle 2 or Circle 3’s behavior is a reasonable choice. Note that as of early 2023, Safari <em>still</em>  <a href="https://caniuse.com/?search=user-select">doesn’t support the unprefixed version</a><sup class="print-endnote">[12]</sup> (<a href="https://bugs.webkit.org/show_bug.cgi?id=208677">tracking bug</a><sup class="print-endnote">[13]</sup>), so we have to also set the prefixed version.</p>
<h3 id="42-️-fix-text-and-image-drag">4.2. 🖱️ Fix: text and image drag<a href="https://www.redblobgames.com/making-of/draggable/#fix-systemdrag">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#42-️-fix-text-and-image-drag"></a></h3>
<p>Windows, Linux, and Mac support inter-application <em>drag and drop</em> of text and images, and an alternative to copy/paste. This interferes with the object dragging on my pages. The fix is to <kbd>preventDefault()</kbd> on <code>dragstart</code>.</p>
<div class="table-responsive">
















<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th></tr></thead><tbody><tr><td>select text, drag circle</td><td>page text drags</td><td>yes ⛌</td><td>no ✓</td></tr></tbody></table></div>
<p><strong>Select text</strong> → [from here</p>
<p>1 2</p>
<p>to here] ←</p>
<p>Selected text interferes with dragging</p>
<p><strong>Try</strong> this demo with a mouse. Select the text around the diagram, then drag Circle 1. On most desktop systems I’ve tested, text or image dragging takes priority over the circle dragging by default. Circle 2 prioritizes the circle dragging. Behavior varies a little bit across browsers and operating systems. The fix is one extra line:</p>
<h2 id="5-more-cases">5 <a href="https://www.redblobgames.com/making-of/draggable/#more-cases">More cases</a><a href="https://www.redblobgames.com/making-of/draggable/#more-cases">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#5-more-cases"></a></h2>
<h3 id="51--feature-simultaneous-dragging">5.1. 👆 Feature: simultaneous dragging<a href="https://www.redblobgames.com/making-of/draggable/#feature-simultaneous-dragging">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#51--feature-simultaneous-dragging"></a></h3>
<p>I think this is an edge case, but I was curious what it would take to support. Can we drag multiple objects at once, using different fingers or different mice?</p>
<p>For touch, the code I presented should already work! Go back to one of the previous demos and try it. However the code doesn’t handle using two fingers to drag the <em>same</em> object. The fix is when handling <code>pointerdown</code>, save <kbd>event.pointerId</kbd> to <code>state.dragging</code>. Then when handling <code>pointermove</code>, ignore the even if it’s not the same <code>pointerId</code>. I don’t have that implemented here, but try it out <a href="https://www.redblobgames.com/making-of/draggable/targets.html#canvas-drag-a-handle">on my canvas dragging test</a>.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    state<span class="token punctuation">.</span><span class="token property-access">pointerId</span> <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token property-access">pointerId</span> <span class="token comment">// keep track of finger</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span><span class="token property-access">pointerId</span> <span class="token operator">!==</span> event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// check finger id</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>What about mice? The <a href="https://www.w3.org/TR/pointerevents/#the-primary-pointer">Pointer Events spec</a><sup class="print-endnote">[14]</sup> says</p>
<blockquote>
<p>Current operating systems and user agents don’t usually have a concept of multiple mouse inputs. When more than one mouse device is present (for instance, on a laptop with both a trackpad and an external mouse), all mouse devices are generally treated as a single device - movements on any of the devices are translated to movement of a single mouse pointer, and there is no distinction between button presses on different mouse devices. For this reason, there will usually only be a single mouse pointer, and that pointer will be primary.</p>
</blockquote>
<p>I think there isn’t any way to drag different objects with different mice.</p>
<h3 id="52-️-edge-case-chorded-button-presses">5.2. 🖱️ Edge case: chorded button presses<a href="https://www.redblobgames.com/making-of/draggable/#fix-chords">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#52-️-edge-case-chorded-button-presses"></a></h3>
<p>So here’s a tricky one. If you are using multiple buttons at the same time, what happens? Mouse Events send <code>mousedown</code> for each button press and <code>mouseup</code> for each button release. But Pointer Events work differently. The <a href="https://www.w3.org/TR/pointerevents/#chorded-button-interactions">Pointer Events spec</a><sup class="print-endnote">[15]</sup> says that the <em>first</em> button that was pressed leads to a <code>pointerdown</code> event, and the <em>last</em> one that was released leads to a <code>pointerup</code> event. But that means we might get a up event on a different button than the down event!</p>
<p><a href="https://www.redblobgames.com/making-of/draggable/build/multiple-buttons.svg">multiple-buttons.svg</a></p>
<div class="table-responsive">
















<table><thead><tr><th>Try this</th><th>Watch for</th><th>Circle 1</th><th>Circle 2</th></tr></thead><tbody><tr><td>left down, right down, left up</td><td>dragging</td><td>yes ⛌</td><td>no ✓</td></tr></tbody></table></div>
<p>Drag 1 Drag 2</p>
<p>Multiple button presses is tricky</p>
<p><strong>Try</strong> with the mouse: press the left button, press the right button (this may bring up a context menu but ignore it), then release the left button. Is the circle still dragging?</p>
<p>The fix is to check the button state in <code>pointermove</code>:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">buttons</span> <span class="token operator">&#x26;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token function">end</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token comment">// edge case: chords</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Separately, the <em>pointer capture</em> continues until you release <em>all</em> the buttons, unless you explicitly release capture. I’m not handling this or many other edge cases.</p>
<h3 id="53-️-variant-nested-dragging">5.3. 🖱️👆 Variant: nested dragging<a href="https://www.redblobgames.com/making-of/draggable/#variant-nesting">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#53-️-variant-nested-dragging"></a></h3>
<p>If the draggable element contains <em>another</em> draggable element inside of it, both elements will handle the dragging. The fix is to add <kbd>.stopPropagation()</kbd> to prevent the inner draggable from passing events up to outer draggable. I don’t have a demo here, but <a href="https://play.vuejs.org/#eNq1Vk1zmzAQ/SsqkxnsqUOcyY06nbZpDumhzbQ5JDMcQswalICkkYSNS/nvXUngQOLaTT/sA9Lbt2L37bJQe++FCJYleKE3U3NJhSYKdCneRowWgktNaiJhQRqykLwgPlL9iEVszpnSpCKnxjqajjtk/QxZ0URnLXo8fcQzoGmmB4bOlMg4RUMdMWLXKWVpSBZxrmBiMMEp0yATvmIjWALTY8clRGdUBZ2LOSKpQlIFyzgvgRwSSw7mOcXL9YQk65CstxpvmjfuwBYspcTrVSxT0AEKdOkiOIuFLiW4III2rItkbJ2bfqyl2BOpze65X8GX7fEbT7ogo1cD9zFqiHGwNuYu39NhvuT18KZBUrUOnQZDh5vnDutNgE1XKwmKfjeu/6Raq9D1yy8rloVt4/y3snXOSnNxKbmI01hTzkZ/V9QXnPonJd91OBlIurcpVq3TQOa9nZH1O2N25EYJDhHcaChEHmvAHSGzhC5JqPQ6h9PIq7WMmVpwWYTk1q4NcXRQV42oJgf1Gi/j24lLACkHtV0hiqAL0KJu6eC7eP6QSl6yJCT+GvKcr/wJ8UsF8lBBDnPto4FxBggLrqiRChEJeG+6NCj2jeISMVMKv4k8pwj+3vWaOchhoTEJI0LXRAbfQi/FE14ptrDM3Z7wDNRnal7OM6VjiW0rbUnQoUewGhPy0QzQAkjt9PoxbZrrulXJbBzrSS16WsR3iuelNlpIJ7I/xfUd15pjqeymrYl/PBUVbrtqdPtBGSQkfVnZSsGhGxx71XW039F3yNyl8JD5Uo03Ks+OUEDX1e1qdtRrdvf3Jp5WOCoXNA3uFWf4orUPdeTNeSFoDvKLMKqryAu7xz3yYtO2nyymZenmqPXJYP6wBb9XlcEi7xJzA2kS2tgwExx/znz+7TNUuN4YC56UObJ3GL+CbQaM0dE+YE0x7B7PRnthPxdwGFyp80oDU11SJtDHIRd5+AlxtiP1x3BPghPrhzPFa34CpcvwOQ==">I made one elsewhere</a><sup class="print-endnote">[16]</sup>, where the red draggable is a child of the yellow draggable.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeDraggable</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> el<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">button</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token comment">// left button only</span>
    event<span class="token punctuation">.</span><span class="token method function property-access">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// for nested draggables</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> state<span class="token punctuation">.</span><span class="token property-access">pos</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    el<span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    event<span class="token punctuation">.</span><span class="token method function property-access">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// for nested draggables</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token method function property-access">eventToCoordinates</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    state<span class="token punctuation">.</span><span class="token property-access">pos</span> <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token operator">+</span> state<span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerdown"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointerup"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointercancel"</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pointermove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span>
  el<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="54-️-variant-dragging-on-canvas">5.4. 🖱️👆 Variant: dragging on canvas<a href="https://www.redblobgames.com/making-of/draggable/#variant-canvas">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#54-️-variant-dragging-on-canvas"></a></h3>
<p>I normally work with SVG, but if working with a <code>&#x3C;canvas></code> (either 2D Canvas or WebGL), I can’t set the event handlers or mouse pointer shape on the <em>draggable</em> element only. So I set the event handler on the <code>&#x3C;canvas></code> and then:</p>
<ol>
<li><code>pointerdown</code>, <code>touchstart</code>, <code>dragstart</code>: early <kbd>return</kbd> if not over a draggable object</li>
<li><code>pointermove</code>: set the cursor based on whether it’s over a draggable object</li>
</ol>
<h3 id="55-variant-hover-with-mouse">5.5. Variant: hover with mouse<a href="https://www.redblobgames.com/making-of/draggable/#variant-hover">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#55-variant-hover-with-mouse"></a></h3>
<p>Sometimes I want to act on <em>hover</em> with the mouse (no buttons pressed) but that doesn’t work with touch devices, so I use <em>drag</em> with touch. I modify the recipe by removing the <kbd>if (!state.dragging)</kbd> line from <code>pointermove</code>.</p>
<p>{ DEMO? }</p>
<p>Do I need to release the capture? <strong>Yes</strong> releasing capture turns out to be important on many of my pages, like responsive-design</p>
<h3 id="56-variant-toggle-paint">5.6. Variant: toggle paint<a aria-hidden="true" class="anchor-heading icon-link" href="#56-variant-toggle-paint"></a></h3>
<p>{ idea is that in addition to <code>dragging</code> I also want to capture the state of the first grid space I’m on, and then use that for all the move events; maybe this should go on a different page }</p>
<h3 id="57-todo-lostpointercapture">5.7. TODO: lostpointercapture<a aria-hidden="true" class="anchor-heading icon-link" href="#57-todo-lostpointercapture"></a></h3>
<p>I know that <code>lostpointercapture</code> can be used to detect that we lost pointer capture, but I haven’t yet figured out all the situations in which it fires, and what I should do about them.</p>
<h2 id="6-vue-component">6 <a href="https://www.redblobgames.com/making-of/draggable/#vue">Vue component</a><a href="https://www.redblobgames.com/making-of/draggable/#vue">#</a><a aria-hidden="true" class="anchor-heading icon-link" href="#6-vue-component"></a></h2>
<p>Here’s an attempt at a <code>&#x3C;Draggable></code> component in Vue v3, Options API:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>g</span>
    <span class="token attr-name">:transform</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>`translate(${modelValue.x},${modelValue.y})`<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointerdown.left</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointerup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>end<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointercancel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>end<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointermove</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dragging ? move($event) : null<span class="token punctuation">"</span></span>
    <span class="token attr-name">@touchstart.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
    <span class="token attr-name">@dragstart.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
    <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{dragging}<span class="token punctuation">"</span></span>
  <span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>slot</span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>g</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> convertPixelToSvgCoord <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./svgcoords.js"</span>

  <span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span> modelValue<span class="token operator">:</span> <span class="token known-class-name class-name">Object</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// should be {x, y}</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> dragging<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">ctrlKey</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">convertPixelToSvgCoord</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">modelValue</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">modelValue</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
        event<span class="token punctuation">.</span><span class="token property-access">currentTarget</span><span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">_event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">dragging</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">convertPixelToSvgCoord</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">$emit</span><span class="token punctuation">(</span><span class="token string">"update:modelValue"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          x<span class="token operator">:</span> x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span>
          y<span class="token operator">:</span> y <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">dragging</span><span class="token punctuation">.</span><span class="token property-access">dy</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">g</span> <span class="token punctuation">{</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> grab<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">g<span class="token class">.dragging</span></span> <span class="token punctuation">{</span>
    <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> grabbing<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p>and here’s the same thing in the Composition API:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>g</span>
    <span class="token attr-name">:transform</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>`translate(${modelValue.x},${modelValue.y})`<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointerdown.left</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointerup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>end<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointercancel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>end<span class="token punctuation">"</span></span>
    <span class="token attr-name">@pointermove</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dragging ? move($event) : null<span class="token punctuation">"</span></span>
    <span class="token attr-name">@touchstart.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
    <span class="token attr-name">@dragstart.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
    <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{dragging}<span class="token punctuation">"</span></span>
  <span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>slot</span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>g</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> ref <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"vue"</span>
  <span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> convertPixelToSvgCoord <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./svgcoords.js"</span>

  <span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    modelValue<span class="token operator">:</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">,</span> <span class="token comment">// should be {x, y}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"update:modelValue"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> dragging <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

  <span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">ctrlKey</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">convertPixelToSvgCoord</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    dragging<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">=</span> <span class="token punctuation">{</span> dx<span class="token operator">:</span> props<span class="token punctuation">.</span><span class="token property-access">modelValue</span><span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">-</span> x<span class="token punctuation">,</span> dy<span class="token operator">:</span> props<span class="token punctuation">.</span><span class="token property-access">modelValue</span><span class="token punctuation">.</span><span class="token property-access">y</span> <span class="token operator">-</span> y <span class="token punctuation">}</span>
    event<span class="token punctuation">.</span><span class="token property-access">currentTarget</span><span class="token punctuation">.</span><span class="token method function property-access">setPointerCapture</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">pointerId</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dragging<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">convertPixelToSvgCoord</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">"update:modelValue"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      x<span class="token operator">:</span> x <span class="token operator">+</span> dragging<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token property-access">dx</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> y <span class="token operator">+</span> dragging<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">.</span><span class="token property-access">dy</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">g</span> <span class="token punctuation">{</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> grab<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">g<span class="token class">.dragging</span></span> <span class="token punctuation">{</span>
    <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> grabbing<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p>This component only handles SVG elements, as that’s my primary need. You’ll have to modify it if you’re dragging HTML elements. You can use <em>computed setters</em> on the model value if you want to apply constraints like bounds checking or grid snapping. If you’re using Vue v2 (whether Options API or Composition API), you’ll need to change the v-model prop from <code>modelValue</code> to <code>value</code> and the event from <code>update:modelValue</code> to <code>input</code>.</p>
<p>To use this component, create position variables (<code>data</code> in Options API or <code>ref</code> in Composition API) of type <code>{x, y}</code>, and then draw the desired shape as the child slot of the draggable component. In this example, I have <code>redCircle</code> and <code>blueSquare</code> positions:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-100 -100 200 200<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#eee</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>Draggable</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>redCircle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hsl(0 50% 50%)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>Draggable</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>Draggable</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>blueSquare<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hsl(220 50% 50%)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>Draggable</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>svg</span><span class="token punctuation">></span></span>
</code></pre>
<p>I put a full example of this <a href="https://play.vuejs.org/#eNrtV2tv2zYU/SsXXofImS2lAfbFSfbyimEYhgZIUGyYh1WWrmQ2kqiRlB8z/N93SD0sO26WtRj2pQZsi+S5l/d5RG4H35alv6x4MBkE58TrMC8zJplQrMKUwiLGgywpkYr0MiXOOOfC6KtZQURRWNCcKZexSATHZCStpHqglTALWpg86/BYkrWMZsaSKfUkCFarla84nmdynoY5az+SeZCHD6JIxzIJrAlpOM84oPNgVsyKax0pURroMFX5lVUn8lIqQ1vFyY4SJXM6gzNnbqsgaJe/bxU1ED/oZl6XRshC2xDUUv8sMpWAaGHl9mL2G0GRITg0FSqC5A2eE2+7ntCXFyPaTGh8ebEbOngNnWcV3/1ZhaqPHTfgBnsd1E7DXQwMIz+hYef8tc3IUvDqO7m+mQ3GLy8urDQkLwjPswFps8kYS/MwekiVrIp4Qp8x82zgFEDF3s/lGHnkDOjOgw4GYFT7pLD+0qpORGaxC515F/Dvc/sdYj5oNe8D9tRe+xD0N1McGWp8gs5N97QSsVlgdGkHCxbpwrSjnkGXl88yCaFdpni6DnphHYwG78s0euQoAWmteGJUWGj0SA4D3rqBxXgvts7NNyGc9Ne70cF4sxu+nQ1qBd+UUhSGVSxXhZ9xYp3SJlTmGFCVWOEihlftFJowcqF004fwXC5t+l0joanoa/TqEnbxEk05pAkVVZZ1QkZW0cJt65fKQSBrd7Lyj+cb36Ms1BoT23aX3b66dCZNE/7r4FGojxu67qKnWrpdQ/ssWZlbsebsXt4t06mUKm7hvs1rZGe0/04f92cJPtPot5gTUfCtHXnb2t59dib0ev7OFiFIRC9klcWW6LZrdObOYps23mvlXJhO6SsMtPfbWVXG8HSyV3v2+9C63Qp1eam7PwkzzVaxRSRVEdnCQw8j8F6TscZQkVA940dGZT/xZggFplJFzbGUMYLkjIXq08FqNDYCrSX+0poJoW0MKnKh8vs1TGOC2hj09Ghtg7XNrtHXGFcphf/7UKVsfCT5ti7LaVjCWG5caGr1x7g2BvE98B9lfeT9I2NtFZ+UddV+KPyvQ2Mz651I5ajVSIRQremLI7v8eD1qAYjX5gRg0wCaaoL1h2zv6Jt0JEuOXROltCUEVUs1oVSF8ysrg2m/q6QtVZrVWOPFGxn0tyz46kBkDpQTw1ZW/RHl9d6Hn+juP6K7g5PLh1EZr5006CasMmhx88b15IR6YW95bDd6H5OhnUITeuiPhkLw0Lo2IUdJtEPBoFRnBhTJZiFju0lb26f46Tkc9UHNaD9mIfS+4BuqcpOnmep46YCoPpKsXPd2bW6p6o/HkTg2uKOrQ+kTZPVxMXrxDOrq0deBmX326jHYEaYlsB6J9X3a2Z//mdn6/eMuOec0rYNYt5gLHeIKiCgQJ9JlGDF5eHuYBVMZpjy0F5u7Nz/0ULDtvEXa246o0dhsRAtZSGUtVqxLcKlY4tjMWvyFuVF9gg3qo6sN07m7ZDWn+KG76DTN3b3Fnkr6CFesmxMF3JVQfdKwN4UbQH0wLiv48qq+mPXOCyUAgPmRYjgIiKt/r81qiZaChnqnTODvl25lc7Tya7uC+dLPQ6PE+r59Z3h2E1h4h424mN7/7A19YR3U7A3b3RoqKjFEQge7vwFtIua8">on the Vue Playground</a><sup class="print-endnote">[17]</sup>, with both Options API and Composition API components.</p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#1-️-mouse-events-only" title="1 🖱️ Mouse events only#">1 🖱️ Mouse events only#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#2--touch-events" title="2 👆 Touch events#">2 👆 Touch events#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#3-️-pointer-events" title="3 🖱️👆 Pointer events#">3 🖱️👆 Pointer events#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#31-️-fix-capture-the-mouse" title="3.1. 🖱️ Fix: capture the mouse#">3.1. 🖱️ Fix: capture the mouse#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#32--fix-scrolling-with-touch" title="3.2. 👆 Fix: scrolling with touch#">3.2. 👆 Fix: scrolling with touch#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#33-️-feature-handle-drag-offset" title="3.3. 🖱️ Feature: handle drag offset#">3.3. 🖱️ Feature: handle drag offset#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#34-️-fix-context-menu" title="3.4. 🖱️ Fix: context menu#">3.4. 🖱️ Fix: context menu#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#4-️-variant-draggable-textimages" title="4 🖱️ Variant: draggable text/images#">4 🖱️ Variant: draggable text/images#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#41-️-fix-text-selection" title="4.1. 🖱️ Fix: text selection#">4.1. 🖱️ Fix: text selection#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#42-️-fix-text-and-image-drag" title="4.2. 🖱️ Fix: text and image drag#">4.2. 🖱️ Fix: text and image drag#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#5-more-cases" title="5 More cases#">5 More cases#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#51--feature-simultaneous-dragging" title="5.1. 👆 Feature: simultaneous dragging#">5.1. 👆 Feature: simultaneous dragging#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#52-️-edge-case-chorded-button-presses" title="5.2. 🖱️ Edge case: chorded button presses#">5.2. 🖱️ Edge case: chorded button presses#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#53-️-variant-nested-dragging" title="5.3. 🖱️👆 Variant: nested dragging#">5.3. 🖱️👆 Variant: nested dragging#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#54-️-variant-dragging-on-canvas" title="5.4. 🖱️👆 Variant: dragging on canvas#">5.4. 🖱️👆 Variant: dragging on canvas#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#55-variant-hover-with-mouse" title="5.5. Variant: hover with mouse#">5.5. Variant: hover with mouse#</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#56-variant-toggle-paint" title="5.6. Variant: toggle paint">5.6. Variant: toggle paint</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#57-todo-lostpointercapture" title="5.7. TODO: lostpointercapture">5.7. TODO: lostpointercapture</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#6-vue-component" title="6 Vue component#">6 Vue component#</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"0pt1h99anrpns3e7xkundxk","title":"Draggable objects","desc":"","updated":1696396260373,"created":1696395596841,"custom":{},"fname":"dev.javascript.draggable","type":"note","vault":{"fsPath":"vault"},"contentHash":"005742e5241da5572f099b7e6cf8b2fa","links":[],"anchors":{"1-️-mouse-events-only":{"type":"header","text":"1 🖱️ Mouse events only#","value":"1-️-mouse-events-only","line":65,"column":0,"depth":2},"2--touch-events":{"type":"header","text":"2 👆 Touch events#","value":"2--touch-events","line":134,"column":0,"depth":2},"3-️-pointer-events":{"type":"header","text":"3 🖱️👆 Pointer events#","value":"3-️-pointer-events","line":169,"column":0,"depth":2},"31-️-fix-capture-the-mouse":{"type":"header","text":"3.1. 🖱️ Fix: capture the mouse#","value":"31-️-fix-capture-the-mouse","line":248,"column":0,"depth":3},"32--fix-scrolling-with-touch":{"type":"header","text":"3.2. 👆 Fix: scrolling with touch#","value":"32--fix-scrolling-with-touch","line":296,"column":0,"depth":3},"33-️-feature-handle-drag-offset":{"type":"header","text":"3.3. 🖱️ Feature: handle drag offset#","value":"33-️-feature-handle-drag-offset","line":351,"column":0,"depth":3},"34-️-fix-context-menu":{"type":"header","text":"3.4. 🖱️ Fix: context menu#","value":"34-️-fix-context-menu","line":394,"column":0,"depth":3},"4-️-variant-draggable-textimages":{"type":"header","text":"4 🖱️ Variant: draggable text/images#","value":"4-️-variant-draggable-textimages","line":567,"column":0,"depth":2},"41-️-fix-text-selection":{"type":"header","text":"4.1. 🖱️ Fix: text selection#","value":"41-️-fix-text-selection","line":603,"column":0,"depth":3},"42-️-fix-text-and-image-drag":{"type":"header","text":"4.2. 🖱️ Fix: text and image drag#","value":"42-️-fix-text-and-image-drag","line":624,"column":0,"depth":3},"5-more-cases":{"type":"header","text":"5 More cases#","value":"5-more-cases","line":642,"column":0,"depth":2},"51--feature-simultaneous-dragging":{"type":"header","text":"5.1. 👆 Feature: simultaneous dragging#","value":"51--feature-simultaneous-dragging","line":644,"column":0,"depth":3},"52-️-edge-case-chorded-button-presses":{"type":"header","text":"5.2. 🖱️ Edge case: chorded button presses#","value":"52-️-edge-case-chorded-button-presses","line":685,"column":0,"depth":3},"53-️-variant-nested-dragging":{"type":"header","text":"5.3. 🖱️👆 Variant: nested dragging#","value":"53-️-variant-nested-dragging","line":733,"column":0,"depth":3},"54-️-variant-dragging-on-canvas":{"type":"header","text":"5.4. 🖱️👆 Variant: dragging on canvas#","value":"54-️-variant-dragging-on-canvas","line":766,"column":0,"depth":3},"55-variant-hover-with-mouse":{"type":"header","text":"5.5. Variant: hover with mouse#","value":"55-variant-hover-with-mouse","line":773,"column":0,"depth":3},"56-variant-toggle-paint":{"type":"header","text":"5.6. Variant: toggle paint","value":"56-variant-toggle-paint","line":781,"column":0,"depth":3},"57-todo-lostpointercapture":{"type":"header","text":"5.7. TODO: lostpointercapture","value":"57-todo-lostpointercapture","line":785,"column":0,"depth":3},"6-vue-component":{"type":"header","text":"6 Vue component#","value":"6-vue-component","line":789,"column":0,"depth":2}},"children":[],"parent":"IowIScQvzEu3KQ4dvwPTt","data":{}},"body":"\u003ch1 id=\"draggable-objects\"\u003eDraggable objects\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#draggable-objects\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/\"\u003efrom Red Blob Games\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eMany of my interactive pages have a \u003cem\u003edraggable object\u003c/em\u003e. I want the reader to move the object around, and I want the diagram to respond in some way. Here I’ll document the code I use to make this work with both mouse and touch input, using browser features that are widely supported since 2020. Here’s a common case I want to support:\u003c/p\u003e\n\u003cp\u003eDrag me\u003c/p\u003e\n\u003cp\u003eDrag the circle with mouse or touch\u003c/p\u003e\n\u003cp\u003eThis is the simple model in my head:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/state.svg\"\u003estate.svg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eHowever it’s not so simple! Mouses have multiple buttons. Touch events can include multiple fingers. Events can go to multiple destinations. Right click can trigger the context menu. I ended up with this basic recipe:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e Text inside draggable\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e Multiple fingers on same draggable\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" disabled\u003e Nested draggable elements\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLike other recipes, it’s something that works for many cases, but is \u003cstrong\u003emeant to be modified\u003c/strong\u003e. On the rest of the page I’ll show how I got here and then variants of this recipe, including \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-text\"\u003ehow to handle text selection\u003c/a\u003e. I also use this same recipe to handle situations where I’m \u003cem\u003enot\u003c/em\u003e dragging an object around, like dragging this number left/right: \u003ccode\u003e123\u003c/code\u003e, or \u003ca href=\"https://www.redblobgames.com/making-of/draggable/targets.html#canvas-drag-to-paint\"\u003epainting on a canvas\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eI’ve tested this code on Gecko/Firefox (Mac, Windows, Linux, Android), Blink/Chrome (Mac, Windows, Linux, Android), and WebKit/Safari (Mac, iPhone, iPad). I have \u003cem\u003enot\u003c/em\u003e tested on hoverable stylus, hybrid touch+mouse devices, or voice input.\u003c/p\u003e\n\u003cp\u003eAlso see my other pages:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/targets.html\"\u003eList of edge cases and list of dragging tests\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.redblobgames.com/x/2251-draggable/\"\u003eTest page to log the events, and unorganized notes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.redblobgames.com/x/1845-draggable/\"\u003eHow I handled dragging events 2015–2018\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eNote that this is \u003cem\u003enot\u003c/em\u003e the HTML \u003ca href=\"https://www.redblobgames.com/x/2310-drag-drop-api/\"\u003eDrag and Drop API\u003c/a\u003e, which involves dragging an element \u003cem\u003eonto\u003c/em\u003e another element. For my diagrams, I’m dragging but \u003cem\u003enot\u003c/em\u003e dropping, and the scrubbable number example shows how I’m not necessarily even moving something around. So I need to read the mouse/touch events directly.\u003c/p\u003e\n\u003ch2 id=\"1-️-mouse-events-only\"\u003e1 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#mouse-events\"\u003e🖱️ Mouse events only\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#mouse-events\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#1-️-mouse-events-only\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWhen I first started implementing interactive diagrams ~20 years ago, touch devices weren’t common. I used \u003ccode\u003emousedown\u003c/code\u003e, \u003ccode\u003emouseup\u003c/code\u003e, and \u003ccode\u003emousemove\u003c/code\u003e event handlers on the draggable element. If the move occurs while dragging, move the circle to the mouse position.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/mouse-local.svg\"\u003emouse-local.svg\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggableMouseLocal\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emousedown\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e_event\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emouseup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e_event\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emousemove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousedown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e mousedown\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mouseup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e mouseup\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousemove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e mousemove\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e the demo with a mouse:\u003c/p\u003e\n\u003cp\u003eDrag me\u003c/p\u003e\n\u003cp\u003eDrag using mouse events on circle\u003c/p\u003e\n\u003cp\u003eThis might seem like it works but it works poorly.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf you move the pointer quickly it is no longer over the circle, it stops receiving events.\u003c/li\u003e\n\u003cli\u003eIf you release the button while not on the circle, it will get stuck in the “dragging” state.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTo fix these problems use \u003ccode\u003emousedown\u003c/code\u003e on the circle to add \u003ccode\u003emousemove\u003c/code\u003e and \u003ccode\u003emouseup\u003c/code\u003e on the \u003cem\u003edocument\u003c/em\u003e. Then on \u003ccode\u003emouseup\u003c/code\u003e remove the \u003ccode\u003emousemove\u003c/code\u003e and \u003ccode\u003emouseup\u003c/code\u003e from the document.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/mouse-document.svg\"\u003emouse-document.svg\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggableMouseGlobal\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eglobalMousemove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eglobalMouseup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e_event\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremoveEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousemove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e globalMousemove\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eremoveEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mouseup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e globalMouseup\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emousedown\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousemove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e globalMousemove\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mouseup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e globalMouseup\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousedown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e mousedown\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTry it out. It works better.\u003c/p\u003e\n\u003cp\u003eDrag me\u003c/p\u003e\n\u003cp\u003eDrag using mouse events on document\u003c/p\u003e\n\u003cp\u003eThis code doesn’t handle touch events.\u003c/p\u003e\n\u003ch2 id=\"2--touch-events\"\u003e2 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#touch-events\"\u003e👆 Touch events\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#touch-events\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#2--touch-events\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eMouse events use \u003ccode\u003emousedown\u003c/code\u003e, \u003ccode\u003emouseup\u003c/code\u003e, \u003ccode\u003emousemove\u003c/code\u003e. Touch events instead use \u003ccode\u003etouchstart\u003c/code\u003e, \u003ccode\u003etouchend\u003c/code\u003e, \u003ccode\u003etouchmove\u003c/code\u003e. They behave a little differently. Touch events automatically \u003cem\u003ecapture\u003c/em\u003e on \u003ccode\u003etouchstart\u003c/code\u003e and direct all \u003ccode\u003etouchmove\u003c/code\u003e events to the original element. This means we \u003cem\u003edon’t\u003c/em\u003e have to temporarily put an event handler on \u003ccode\u003edocument\u003c/code\u003e. We can go back to the simpler logic in the first mouse example. If for any reason the browser needs to cancel the touch sequence, it sends \u003ccode\u003etouchcancel\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/touch.svg\"\u003etouch.svg\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggableTouch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// prevent scrolling\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e_event\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003echangedTouches\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchend\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchcancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchmove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e the demo with a touch device:\u003c/p\u003e\n\u003cp\u003eDrag me\u003c/p\u003e\n\u003cp\u003eDrag using touch events\u003c/p\u003e\n\u003cp\u003eThis code doesn’t handle mouse events.\u003c/p\u003e\n\u003ch2 id=\"3-️-pointer-events\"\u003e3 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#pointer-events\"\u003e🖱️👆 Pointer events\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#pointer-events\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#3-️-pointer-events\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eHandling both mouse and touch events requires lots of event handlers, and that’s what I used before 2021. Details→\u003c/p\u003e\n\u003cp\u003eFrom 2011 to 2014 I used \u003ca href=\"https://github.com/d3/d3-drag\"\u003ed3-drag\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[1]\u003c/sup\u003e in projects where I used d3. For my non-d3 projects, I ended up developing my own mouse+touch code, which I wrote about \u003ca href=\"https://www.redblobgames.com/x/1845-draggable/\"\u003ein 2018\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eBy 2012 MS IE had added support for \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Pointer_events\"\u003epointer events\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[2]\u003c/sup\u003e which unify and simplify mouse+touch handling. \u003ca href=\"https://caniuse.com/pointer\"\u003eChrome added support in 2017; Firefox in 2018; Safari in 2020\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[3]\u003c/sup\u003e.\u003c/p\u003e\n\u003cp\u003eOver the years browsers have changed the rules, including in 2017 when \u003ca href=\"https://developer.chrome.com/blog/scrolling-intervention/\"\u003eChrome changed some events to default to passive mode\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[4]\u003c/sup\u003e which causes the page to scroll while trying to drag the object. This \u003ca href=\"https://github.com/WICG/interventions/issues/18#issuecomment-276531695\"\u003ebroke some pages\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[5]\u003c/sup\u003e. Safari \u003ca href=\"https://github.com/WICG/interventions/issues/18#issuecomment-368703063\"\u003emade this change in 2018\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[6]\u003c/sup\u003e. Firefox also \u003ca href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1449268\"\u003emade this change in 2018\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[7]\u003c/sup\u003e.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/mouse-and-touch.svg\"\u003emouse-and-touch.svg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ePointer events attempt to unify mouse and touch events. The \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/setPointerCapture\"\u003epointer capture\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[8]\u003c/sup\u003e feature lets us use the simpler logic that doesn’t require us to add/remove global event handlers to the document like we had to with mouse events.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/pointer.svg\"\u003epointer.svg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThis recipe is the starting point:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMuch simpler! However, I almost always want to handle some extras, so I start with this instead:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e the demo with either a mouse or touch device:\u003c/p\u003e\n\u003cp\u003eDrag me\u003c/p\u003e\n\u003cp\u003eDrag using pointer events\u003c/p\u003e\n\u003cp\u003eLet’s look at each of the extras.\u003c/p\u003e\n\u003ch3 id=\"31-️-fix-capture-the-mouse\"\u003e3.1. 🖱️ Fix: capture the mouse\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-capture\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#31-️-fix-capture-the-mouse\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe pointer capture feature lets us track the pointer even when it’s not on the circle, the diagram, or even the browser window. With mouse events we had to put event handlers on \u003ccode\u003edocument\u003c/code\u003e, but pointer capture is simpler.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003edrag quickly back and forth\u003c/td\u003e\u003ctd\u003edrag stops\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edrag outside diagram, come back in\u003c/td\u003e\u003ctd\u003edrag stops\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edrag outside diagram, let go\u003c/td\u003e\u003ctd\u003edrag stops\u003c/td\u003e\u003ctd\u003eno ⛌\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edrag outside diagram, let go, come back in\u003c/td\u003e\u003ctd\u003edrag stops\u003c/td\u003e\u003ctd\u003eno ⛌\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edrag, alt+tab to another window\u003c/td\u003e\u003ctd\u003edrag stops\u003c/td\u003e\u003ctd\u003eno ⛌\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eDrag 1 Drag 2\u003c/p\u003e\n\u003cp\u003eDragging without and with pointer capture\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e this demo with a mouse.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCircle 1 doesn’t use pointer capture on mouse. Pointer capture is the default on touch devices.\u003c/li\u003e\n\u003cli\u003eCircle 2 uses pointer capture on both mouse and touch devices.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"32--fix-scrolling-with-touch\"\u003e3.2. 👆 Fix: scrolling with touch\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-scroll\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#32--fix-scrolling-with-touch\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eOn touch devices, single-finger drag will scroll the page. But single-finger drag \u003cem\u003ealso\u003c/em\u003e drags the circle. By default, it will do \u003cem\u003eboth\u003c/em\u003e! The simplest fix is to add CSS \u003ckbd\u003etouch-action: none\u003c/kbd\u003e on the diagram. But this prevents scrolling \u003cem\u003eanywhere\u003c/em\u003e in the diagram:\u003c/p\u003e\n\u003cp\u003eDrag 1\u003c/p\u003e\n\u003cp\u003eStop touch from scrolling anywhere on the diagram\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e dragging the circle on a touch device. It shouldn’t scroll. But then try scrolling by dragging the diagram. It doesn’t scroll either, but I want it to. I want to stop scrolling \u003cem\u003eonly\u003c/em\u003e if dragging the circle, not when dragging the diagram.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003cth\u003eCircle 3\u003c/th\u003e\u003cth\u003eCircle 4\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003edrag circle\u003c/td\u003e\u003ctd\u003epage scrolls\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003edrag diagram\u003c/td\u003e\u003ctd\u003epage scrolls\u003c/td\u003e\u003ctd\u003eno ⛌\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003ctd\u003eyes ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eDrag 2 Drag 3 Drag 4\u003c/p\u003e\n\u003cp\u003eDragging affects scrolling\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e these on a touch device.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCircle 1 (\u003ckbd\u003etouch-action: none\u003c/kbd\u003e on the diagram) stops scrolling on the circle and also on the diagram.\u003c/li\u003e\n\u003cli\u003eCircle 2 (default) doesn’t stop scrolling on either.\u003c/li\u003e\n\u003cli\u003eCircle 3 (\u003ckbd\u003etouch-action: none\u003c/kbd\u003e on the circle only) behaves badly. It looks like the CSS has to be on the diagram to have an effect; applying it only to the circle is not enough.\u003c/li\u003e\n\u003cli\u003eCircle 4 (\u003ckbd\u003e.preventDefault()\u003c/kbd\u003e on \u003ccode\u003etouchstart\u003c/code\u003e) behaves the way I want, and this is the code for it:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI use the \u003ckbd\u003e.preventDefault()\u003c/kbd\u003e solution. Note that it needs to be on \u003ccode\u003etouchstart\u003c/code\u003e, not on \u003ccode\u003epointerstart\u003c/code\u003e. It works in most situations but I’ve run into situations where it did not stop scrolling on certain systems.\u003c/p\u003e\n\u003ch3 id=\"33-️-feature-handle-drag-offset\"\u003e3.3. 🖱️ Feature: handle drag offset\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#feature-offset\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#33-️-feature-handle-drag-offset\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis isn’t necessary but it makes dragging feel nicer. If you pick up the edge of an object then you want to keep holding it at \u003cem\u003ethat\u003c/em\u003e point, not from the center of the object. The solution is to remember where the center is relative to where the drag started. Then when moving the object, add that offset back in.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003edrag from edge of circle\u003c/td\u003e\u003ctd\u003ecircle jumps\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eDrag 1 Drag 2\u003c/p\u003e\n\u003cp\u003eDragging feels better if relative to the initial pickup point\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e with the mouse: drag the circle from the edge. Watch Circle 1 jump whereas Circle 2 does not. The same effect happens on touch devices but your finger might hide the jump. The fix is to change the \u003ccode\u003edragging\u003c/code\u003e state from \u003ccode\u003etrue\u003c/code\u003e / \u003ccode\u003efalse\u003c/code\u003e to the relative position where the object was picked up, and then use that offset when later setting the position:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTracking the offset makes dragging feel better. I’ve also written about this \u003ca href=\"https://www.redblobgames.com/making-of/little-things/#drag-point\"\u003eon my page about little details\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"34-️-fix-context-menu\"\u003e3.4. 🖱️ Fix: context menu\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-contextmenu\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#34-️-fix-context-menu\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eContext menus are different across platforms, and that makes handling it tricky. I want to allow context menus without them interfering with dragging the circle.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eSystem\u003c/th\u003e\u003cth\u003eActivation\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eWindows\u003c/td\u003e\u003ctd\u003eright click (down+up), \u003ckbd\u003eShift\u003c/kbd\u003e + \u003ckbd\u003eF10\u003c/kbd\u003e key\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eLinux\u003c/td\u003e\u003ctd\u003eright button down, \u003ckbd\u003eShift\u003c/kbd\u003e + \u003ckbd\u003eF10\u003c/kbd\u003e key\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eMac\u003c/td\u003e\u003ctd\u003eright button down, \u003ckbd\u003eCtrl\u003c/kbd\u003e + left click\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eiOS\u003c/td\u003e\u003ctd\u003elong press on text only\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eAndroid\u003c/td\u003e\u003ctd\u003elong press on anything\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eOne problem is that I will see a \u003ccode\u003epointerdown\u003c/code\u003e event and only \u003cem\u003esometimes\u003c/em\u003e a \u003ccode\u003epointerup\u003c/code\u003e event. That means I might think the button is still down when it’s not. It’s frustrating! I realized that I should only set the dragging state on \u003cem\u003eleft\u003c/em\u003e mouse button, and ignore the right mouse button. Then I don’t have to worry about most of the differences.\u003c/p\u003e\n\u003cp\u003eI made some notes during testing, but most of them don’t matter for my use case.\u003c/p\u003e\n\u003cp\u003eAcross platforms, it looks like Firefox lets the page see events outside the menu overlay, whereas Chrome doesn’t let the page see any events while the menu is up.\u003c/p\u003e\n\u003cp\u003eWindows, right click, no capture:\u003c/p\u003e\n\u003cp\u003eFirefox, Chrome, Edge\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003epointerup\u003c/code\u003e, \u003ccode\u003eauxclick\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWindows, right click, capture:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e, \u003ccode\u003epointerup\u003c/code\u003e, \u003ccode\u003elostpointercapture\u003c/code\u003e, \u003ccode\u003eauxclick\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eChrome, Edge\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e, \u003ccode\u003epointerup\u003c/code\u003e, \u003ccode\u003eauxclick\u003c/code\u003e, \u003ccode\u003elostpointercapture\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eLinux right click, no capture:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003epointermove\u003c/code\u003e while menu is up\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, no \u003ccode\u003epointermove\u003c/code\u003e while menu is up\u003c/p\u003e\n\u003cp\u003eLinux hold right down, no capture:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003epointermove\u003c/code\u003e while menu is up\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, no \u003ccode\u003epointermove\u003c/code\u003e while menu is up\u003c/p\u003e\n\u003cp\u003eLinux right click, capture:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e, \u003ccode\u003epointermove\u003c/code\u003e while menu is up tells us button released\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e; not until another click do we get \u003ccode\u003epointerup\u003c/code\u003e, \u003ccode\u003elostpointercapture\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eLinux hold right down, capture:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e, \u003ccode\u003epointermove\u003c/code\u003e while menu is up tells us button released; when releasing button, menu stays up but we get \u003ccode\u003epointerup\u003c/code\u003e, \u003ccode\u003elostpointercapture\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003egotpointercapture\u003c/code\u003e, no \u003ccode\u003epointermove\u003c/code\u003e while menu is up; when releasing button, menu stays up but we don’t get \u003ccode\u003epointerup\u003c/code\u003e; not until another click do we get \u003ccode\u003epointerup\u003c/code\u003e, click, \u003ccode\u003elostpointercapture\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eMac, ctrl + left click:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointermove\u003c/code\u003e with buttons≠0, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerdown\u003c/code\u003e or \u003ccode\u003epointerup\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e with button=left, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerup\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eSafari\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e with button=left, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerup\u003c/code\u003e); but subsequent clicks only fire \u003ccode\u003econtextmenu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eMac, right button down:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e with button=right, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerup\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e with button=right, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerup\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eSafari\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e with button=right, \u003ccode\u003econtextmenu\u003c/code\u003e (no \u003ccode\u003epointerup\u003c/code\u003e); but subsequent right clicks only fire \u003ccode\u003econtextmenu\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eIf we capture events on \u003ccode\u003epointerdown\u003c/code\u003e, Firefox and Safari will keep the capture even after the button is released. Chrome will keep capture until you move the mouse, and then it will release capture. [This seems like a Firefox/Safari bug to me, as pointer capture is supposed to be automatically released on mouse up]\u003c/p\u003e\n\u003cp\u003eIt’s frustrating that on Mac, there’s no \u003ccode\u003epointerup\u003c/code\u003e or \u003ccode\u003epointercapture\u003c/code\u003e when releasing the mouse button. On Linux, the \u003ccode\u003epointerup\u003c/code\u003e only shows up if you click to exit the context menu. It doesn’t show up if you press \u003ckbd\u003eEsc\u003c/kbd\u003e to exit. The workaround is to watch \u003ccode\u003epointermove\u003c/code\u003e events to see when no buttons are set. Windows doesn’t seem to have these issues, as both \u003ccode\u003epointerdown\u003c/code\u003e and \u003ccode\u003epointerup\u003c/code\u003e are delivered before the context menu.\u003c/p\u003e\n\u003cp\u003eAndroid, long press:\u003c/p\u003e\n\u003cp\u003eFirefox\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, get capture, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003epointerup\u003c/code\u003e, lose capture\u003c/p\u003e\n\u003cp\u003eChrome\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epointerdown\u003c/code\u003e, get capture, \u003ccode\u003econtextmenu\u003c/code\u003e, \u003ccode\u003epointerup\u003c/code\u003e or \u003ccode\u003epointercancel\u003c/code\u003e (if the finger moves at all, this starts a scroll event which cancels the captured pointer), lose capture\u003c/p\u003e\n\u003cp\u003eWhat are my options?\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.w3.org/TR/pointerevents/#the-pointerdown-event\"\u003eThe spec says about pointerdown\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[9]\u003c/sup\u003e that \u003ccode\u003epreventDefault()\u003c/code\u003e\u003cem\u003enot\u003c/em\u003e stop click or \u003ccode\u003econtextmenu\u003c/code\u003e events. I can \u003ccode\u003epreventDefault()\u003c/code\u003e on \u003ccode\u003econtextmenu\u003c/code\u003e to prevent the menu. But I still want to get \u003ccode\u003epointerup\u003c/code\u003e and/or \u003ccode\u003epointercancel\u003c/code\u003e! I think I have to treat \u003ccode\u003econtextmenu\u003c/code\u003e as the up event which means I’ll get multiple up events on Windows.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://w3c.github.io/pointerevents/#the-button-property\"\u003eThe spec says about the button property\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[10]\u003c/sup\u003e that \u003ccode\u003ebutton\u003c/code\u003e = 0 indicates the primary button. This is how I will exclude the middle and right buttons. But I still get a \u003ccode\u003epointerdown.left\u003c/code\u003e on Mac/Chrome and Mac/Safari (but not on Mac/Firefox) so I also have to check for the \u003ckbd\u003eCtrl\u003c/kbd\u003e key.\u003c/li\u003e\n\u003cli\u003eButton changes not communicated through \u003ccode\u003epointerdown\u003c/code\u003e or \u003ccode\u003epointerup\u003c/code\u003e can still be sent on \u003ccode\u003epointermove\u003c/code\u003e. It’s mentioned as a workaround on \u003ca href=\"https://github.com/w3c/pointerevents/issues/408\"\u003eW3C’s pointerevents issues page\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[11]\u003c/sup\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003cth\u003eCircle 3\u003c/th\u003e\u003cth\u003eCircle 4\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eright click\u003c/td\u003e\u003ctd\u003ecircle turns blue\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eyes\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eright click\u003c/td\u003e\u003ctd\u003econtext menu\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003emiddle click\u003c/td\u003e\u003ctd\u003ecircle turns blue\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eright drag\u003c/td\u003e\u003ctd\u003ecircle is blue\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eyes\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003emiddle drag\u003c/td\u003e\u003ctd\u003ecircle is blue\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eyes\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003ectrl+click (mac)\u003c/td\u003e\u003ctd\u003ecircle turns blue¹\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003ectrl+click (mac)\u003c/td\u003e\u003ctd\u003econtext menu\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003e¹ it will turn blue in Chrome and Safari but not in Firefox, which treats \u003ckbd\u003eCtrl\u003c/kbd\u003e + click differently\u003c/p\u003e\n\u003cp\u003eDrag 1 Drag 2 Drag 3 (Mac) Drag 4\u003c/p\u003e\n\u003cp\u003eRight mouse button down interferes with drag\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e with the mouse: right click or drag on the circles. Try dismissing the menu with a click elsewhere, or by pressing \u003ckbd\u003eEsc\u003c/kbd\u003e. Behavior varies across browsers and operating systems.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCircle 1 sometimes get stuck in a dragging state.\u003c/li\u003e\n\u003cli\u003eCircle 2 uses \u003ckbd\u003e.preventDefault()\u003c/kbd\u003e on \u003ccode\u003econtextmenu\u003c/code\u003e. This allows the right button to be used for dragging. However, it interferes with the default operation of middle click or drag, which is used for scrolling on some systems.\u003c/li\u003e\n\u003cli\u003eCircle 3 drags only with the left button, but on Mac \u003ckbd\u003eCtrl\u003c/kbd\u003e + click on Chrome/Safari will trigger drag.\u003c/li\u003e\n\u003cli\u003eCircle 4 drags only with the left button, if \u003ckbd\u003eCtrl\u003c/kbd\u003e isn’t pressed.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ectrlKey\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// ignore ctrl+click\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"4-️-variant-draggable-textimages\"\u003e4 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-text\"\u003e🖱️ Variant: draggable text/images\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-text\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#4-️-variant-draggable-textimages\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThese changes are needed if you have text or images inside your draggable element:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003euserSelect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"none\"\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// if there's text\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewebkitUserSelect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"none\"\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// safari\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003euserSelect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// if there's text\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ewebkitUserSelect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// safari\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dragstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"41-️-fix-text-selection\"\u003e4.1. 🖱️ Fix: text selection\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-user-select\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#41-️-fix-text-selection\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eWhen dragging the circle, the text inside gets selected sometimes. To fix this, use CSS \u003ckbd\u003euser-select: none\u003c/kbd\u003e on the circle. There are two choices: either we can apply it \u003cem\u003eall\u003c/em\u003e the time, or apply it \u003cem\u003eonly\u003c/em\u003e while dragging. If I apply it all the time, then the text won’t ever be selectable.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003cth\u003eCircle 3\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003edrag circle\u003c/td\u003e\u003ctd\u003etext is selected\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eselect all text\u003c/td\u003e\u003ctd\u003etext is selected\u003c/td\u003e\u003ctd\u003eyes\u003c/td\u003e\u003ctd\u003eno\u003c/td\u003e\u003ctd\u003eyes\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eDrag text 1 Drag text 2 Drag text 3\u003c/p\u003e\n\u003cp\u003eDragging affects text selection\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e dragging quickly with the mouse. \u003cstrong\u003eTry\u003c/strong\u003e selecting all text on the page to see whether the text inside the circle is selectable when not dragging.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCircle 1 never uses \u003ckbd\u003euser-select: none\u003c/kbd\u003e\u003c/li\u003e\n\u003cli\u003eCircle 2 always uses \u003ckbd\u003euser-select: none\u003c/kbd\u003e\u003c/li\u003e\n\u003cli\u003eCircle 3 uses \u003ckbd\u003euser-select: none\u003c/kbd\u003e only when dragging\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eI think either Circle 2 or Circle 3’s behavior is a reasonable choice. Note that as of early 2023, Safari \u003cem\u003estill\u003c/em\u003e  \u003ca href=\"https://caniuse.com/?search=user-select\"\u003edoesn’t support the unprefixed version\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[12]\u003c/sup\u003e (\u003ca href=\"https://bugs.webkit.org/show_bug.cgi?id=208677\"\u003etracking bug\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[13]\u003c/sup\u003e), so we have to also set the prefixed version.\u003c/p\u003e\n\u003ch3 id=\"42-️-fix-text-and-image-drag\"\u003e4.2. 🖱️ Fix: text and image drag\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-systemdrag\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#42-️-fix-text-and-image-drag\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eWindows, Linux, and Mac support inter-application \u003cem\u003edrag and drop\u003c/em\u003e of text and images, and an alternative to copy/paste. This interferes with the object dragging on my pages. The fix is to \u003ckbd\u003epreventDefault()\u003c/kbd\u003e on \u003ccode\u003edragstart\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eselect text, drag circle\u003c/td\u003e\u003ctd\u003epage text drags\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eSelect text\u003c/strong\u003e → [from here\u003c/p\u003e\n\u003cp\u003e1 2\u003c/p\u003e\n\u003cp\u003eto here] ←\u003c/p\u003e\n\u003cp\u003eSelected text interferes with dragging\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e this demo with a mouse. Select the text around the diagram, then drag Circle 1. On most desktop systems I’ve tested, text or image dragging takes priority over the circle dragging by default. Circle 2 prioritizes the circle dragging. Behavior varies a little bit across browsers and operating systems. The fix is one extra line:\u003c/p\u003e\n\u003ch2 id=\"5-more-cases\"\u003e5 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#more-cases\"\u003eMore cases\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#more-cases\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#5-more-cases\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"51--feature-simultaneous-dragging\"\u003e5.1. 👆 Feature: simultaneous dragging\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#feature-simultaneous-dragging\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#51--feature-simultaneous-dragging\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eI think this is an edge case, but I was curious what it would take to support. Can we drag multiple objects at once, using different fingers or different mice?\u003c/p\u003e\n\u003cp\u003eFor touch, the code I presented should already work! Go back to one of the previous demos and try it. However the code doesn’t handle using two fingers to drag the \u003cem\u003esame\u003c/em\u003e object. The fix is when handling \u003ccode\u003epointerdown\u003c/code\u003e, save \u003ckbd\u003eevent.pointerId\u003c/kbd\u003e to \u003ccode\u003estate.dragging\u003c/code\u003e. Then when handling \u003ccode\u003epointermove\u003c/code\u003e, ignore the even if it’s not the same \u003ccode\u003epointerId\u003c/code\u003e. I don’t have that implemented here, but try it out \u003ca href=\"https://www.redblobgames.com/making-of/draggable/targets.html#canvas-drag-a-handle\"\u003eon my canvas dragging test\u003c/a\u003e.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// keep track of finger\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// check finger id\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhat about mice? The \u003ca href=\"https://www.w3.org/TR/pointerevents/#the-primary-pointer\"\u003ePointer Events spec\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[14]\u003c/sup\u003e says\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCurrent operating systems and user agents don’t usually have a concept of multiple mouse inputs. When more than one mouse device is present (for instance, on a laptop with both a trackpad and an external mouse), all mouse devices are generally treated as a single device - movements on any of the devices are translated to movement of a single mouse pointer, and there is no distinction between button presses on different mouse devices. For this reason, there will usually only be a single mouse pointer, and that pointer will be primary.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI think there isn’t any way to drag different objects with different mice.\u003c/p\u003e\n\u003ch3 id=\"52-️-edge-case-chorded-button-presses\"\u003e5.2. 🖱️ Edge case: chorded button presses\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#fix-chords\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#52-️-edge-case-chorded-button-presses\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSo here’s a tricky one. If you are using multiple buttons at the same time, what happens? Mouse Events send \u003ccode\u003emousedown\u003c/code\u003e for each button press and \u003ccode\u003emouseup\u003c/code\u003e for each button release. But Pointer Events work differently. The \u003ca href=\"https://www.w3.org/TR/pointerevents/#chorded-button-interactions\"\u003ePointer Events spec\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[15]\u003c/sup\u003e says that the \u003cem\u003efirst\u003c/em\u003e button that was pressed leads to a \u003ccode\u003epointerdown\u003c/code\u003e event, and the \u003cem\u003elast\u003c/em\u003e one that was released leads to a \u003ccode\u003epointerup\u003c/code\u003e event. But that means we might get a up event on a different button than the down event!\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/build/multiple-buttons.svg\"\u003emultiple-buttons.svg\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"table-responsive\"\u003e\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003ctable\u003e\u003cthead\u003e\u003ctr\u003e\u003cth\u003eTry this\u003c/th\u003e\u003cth\u003eWatch for\u003c/th\u003e\u003cth\u003eCircle 1\u003c/th\u003e\u003cth\u003eCircle 2\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003eleft down, right down, left up\u003c/td\u003e\u003ctd\u003edragging\u003c/td\u003e\u003ctd\u003eyes ⛌\u003c/td\u003e\u003ctd\u003eno ✓\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/div\u003e\n\u003cp\u003eDrag 1 Drag 2\u003c/p\u003e\n\u003cp\u003eMultiple button presses is tricky\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTry\u003c/strong\u003e with the mouse: press the left button, press the right button (this may bring up a context menu but ignore it), then release the left button. Is the circle still dragging?\u003c/p\u003e\n\u003cp\u003eThe fix is to check the button state in \u003ccode\u003epointermove\u003c/code\u003e:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebuttons\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x26;\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// edge case: chords\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSeparately, the \u003cem\u003epointer capture\u003c/em\u003e continues until you release \u003cem\u003eall\u003c/em\u003e the buttons, unless you explicitly release capture. I’m not handling this or many other edge cases.\u003c/p\u003e\n\u003ch3 id=\"53-️-variant-nested-dragging\"\u003e5.3. 🖱️👆 Variant: nested dragging\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-nesting\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#53-️-variant-nested-dragging\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eIf the draggable element contains \u003cem\u003eanother\u003c/em\u003e draggable element inside of it, both elements will handle the dragging. The fix is to add \u003ckbd\u003e.stopPropagation()\u003c/kbd\u003e to prevent the inner draggable from passing events up to outer draggable. I don’t have a demo here, but \u003ca href=\"https://play.vuejs.org/#eNq1Vk1zmzAQ/SsqkxnsqUOcyY06nbZpDumhzbQ5JDMcQswalICkkYSNS/nvXUngQOLaTT/sA9Lbt2L37bJQe++FCJYleKE3U3NJhSYKdCneRowWgktNaiJhQRqykLwgPlL9iEVszpnSpCKnxjqajjtk/QxZ0URnLXo8fcQzoGmmB4bOlMg4RUMdMWLXKWVpSBZxrmBiMMEp0yATvmIjWALTY8clRGdUBZ2LOSKpQlIFyzgvgRwSSw7mOcXL9YQk65CstxpvmjfuwBYspcTrVSxT0AEKdOkiOIuFLiW4III2rItkbJ2bfqyl2BOpze65X8GX7fEbT7ogo1cD9zFqiHGwNuYu39NhvuT18KZBUrUOnQZDh5vnDutNgE1XKwmKfjeu/6Raq9D1yy8rloVt4/y3snXOSnNxKbmI01hTzkZ/V9QXnPonJd91OBlIurcpVq3TQOa9nZH1O2N25EYJDhHcaChEHmvAHSGzhC5JqPQ6h9PIq7WMmVpwWYTk1q4NcXRQV42oJgf1Gi/j24lLACkHtV0hiqAL0KJu6eC7eP6QSl6yJCT+GvKcr/wJ8UsF8lBBDnPto4FxBggLrqiRChEJeG+6NCj2jeISMVMKv4k8pwj+3vWaOchhoTEJI0LXRAbfQi/FE14ptrDM3Z7wDNRnal7OM6VjiW0rbUnQoUewGhPy0QzQAkjt9PoxbZrrulXJbBzrSS16WsR3iuelNlpIJ7I/xfUd15pjqeymrYl/PBUVbrtqdPtBGSQkfVnZSsGhGxx71XW039F3yNyl8JD5Uo03Ks+OUEDX1e1qdtRrdvf3Jp5WOCoXNA3uFWf4orUPdeTNeSFoDvKLMKqryAu7xz3yYtO2nyymZenmqPXJYP6wBb9XlcEi7xJzA2kS2tgwExx/znz+7TNUuN4YC56UObJ3GL+CbQaM0dE+YE0x7B7PRnthPxdwGFyp80oDU11SJtDHIRd5+AlxtiP1x3BPghPrhzPFa34CpcvwOQ==\"\u003eI made one elsewhere\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[16]\u003c/sup\u003e, where the red draggable is a child of the yellow draggable.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003estate\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ebutton\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// left button only\u003c/span\u003e\n    event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003estopPropagation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// for nested draggables\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003estate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003estopPropagation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// for nested draggables\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eeventToCoordinates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epos\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e state\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e start\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointerup\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointercancel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e end\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"pointermove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e move\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"touchstart\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epreventDefault\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"54-️-variant-dragging-on-canvas\"\u003e5.4. 🖱️👆 Variant: dragging on canvas\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-canvas\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#54-️-variant-dragging-on-canvas\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eI normally work with SVG, but if working with a \u003ccode\u003e\u0026#x3C;canvas\u003e\u003c/code\u003e (either 2D Canvas or WebGL), I can’t set the event handlers or mouse pointer shape on the \u003cem\u003edraggable\u003c/em\u003e element only. So I set the event handler on the \u003ccode\u003e\u0026#x3C;canvas\u003e\u003c/code\u003e and then:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003epointerdown\u003c/code\u003e, \u003ccode\u003etouchstart\u003c/code\u003e, \u003ccode\u003edragstart\u003c/code\u003e: early \u003ckbd\u003ereturn\u003c/kbd\u003e if not over a draggable object\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epointermove\u003c/code\u003e: set the cursor based on whether it’s over a draggable object\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"55-variant-hover-with-mouse\"\u003e5.5. Variant: hover with mouse\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#variant-hover\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#55-variant-hover-with-mouse\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSometimes I want to act on \u003cem\u003ehover\u003c/em\u003e with the mouse (no buttons pressed) but that doesn’t work with touch devices, so I use \u003cem\u003edrag\u003c/em\u003e with touch. I modify the recipe by removing the \u003ckbd\u003eif (!state.dragging)\u003c/kbd\u003e line from \u003ccode\u003epointermove\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e{ DEMO? }\u003c/p\u003e\n\u003cp\u003eDo I need to release the capture? \u003cstrong\u003eYes\u003c/strong\u003e releasing capture turns out to be important on many of my pages, like responsive-design\u003c/p\u003e\n\u003ch3 id=\"56-variant-toggle-paint\"\u003e5.6. Variant: toggle paint\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#56-variant-toggle-paint\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e{ idea is that in addition to \u003ccode\u003edragging\u003c/code\u003e I also want to capture the state of the first grid space I’m on, and then use that for all the move events; maybe this should go on a different page }\u003c/p\u003e\n\u003ch3 id=\"57-todo-lostpointercapture\"\u003e5.7. TODO: lostpointercapture\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#57-todo-lostpointercapture\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eI know that \u003ccode\u003elostpointercapture\u003c/code\u003e can be used to detect that we lost pointer capture, but I haven’t yet figured out all the situations in which it fires, and what I should do about them.\u003c/p\u003e\n\u003ch2 id=\"6-vue-component\"\u003e6 \u003ca href=\"https://www.redblobgames.com/making-of/draggable/#vue\"\u003eVue component\u003c/a\u003e\u003ca href=\"https://www.redblobgames.com/making-of/draggable/#vue\"\u003e#\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#6-vue-component\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eHere’s an attempt at a \u003ccode\u003e\u0026#x3C;Draggable\u003e\u003c/code\u003e component in Vue v3, Options API:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003etemplate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eg\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e:transform\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e`translate(${modelValue.x},${modelValue.y})`\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointerdown.left\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003estart\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointerup\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eend\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointercancel\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eend\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointermove\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003edragging ? move($event) : null\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@touchstart.prevent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@dragstart.prevent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e:class\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e{dragging}\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eslot\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003eg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003etemplate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n  \u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e convertPixelToSvgCoord \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./svgcoords.js\"\u003c/span\u003e\n\n  \u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    props\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e modelValue\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eObject\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// should be {x, y}\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dragging\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    methods\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ectrlKey\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003econvertPixelToSvgCoord\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emodelValue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emodelValue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecurrentTarget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e_event\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003econvertPixelToSvgCoord\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003e$emit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"update:modelValue\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n          y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edragging\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003escoped\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003eg\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecursor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e grab\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003eg\u003cspan class=\"token class\"\u003e.dragging\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003euser-select\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecursor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e grabbing\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand here’s the same thing in the Composition API:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003etemplate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eg\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e:transform\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e`translate(${modelValue.x},${modelValue.y})`\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointerdown.left\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003estart\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointerup\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eend\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointercancel\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eend\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@pointermove\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003edragging ? move($event) : null\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@touchstart.prevent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e@dragstart.prevent\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token attr-name\"\u003e:class\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e{dragging}\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eslot\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003eg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003etemplate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003escript\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003esetup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n  \u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ref \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"vue\"\u003c/span\u003e\n  \u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e convertPixelToSvgCoord \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./svgcoords.js\"\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e props \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003edefineProps\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    modelValue\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eObject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// should be {x, y}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e emit \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003edefineEmits\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"update:modelValue\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dragging \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ectrlKey\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003econvertPixelToSvgCoord\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    dragging\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e dx\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e props\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emodelValue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e props\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emodelValue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ey\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecurrentTarget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetPointerCapture\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epointerId\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    dragging\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword null nil\"\u003enull\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eevent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003econvertPixelToSvgCoord\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eemit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"update:modelValue\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e dragging\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      y\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e dragging\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003evalue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003escoped\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003eg\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecursor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e grab\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003eg\u003cspan class=\"token class\"\u003e.dragging\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003euser-select\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecursor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e grabbing\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis component only handles SVG elements, as that’s my primary need. You’ll have to modify it if you’re dragging HTML elements. You can use \u003cem\u003ecomputed setters\u003c/em\u003e on the model value if you want to apply constraints like bounds checking or grid snapping. If you’re using Vue v2 (whether Options API or Composition API), you’ll need to change the v-model prop from \u003ccode\u003emodelValue\u003c/code\u003e to \u003ccode\u003evalue\u003c/code\u003e and the event from \u003ccode\u003eupdate:modelValue\u003c/code\u003e to \u003ccode\u003einput\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eTo use this component, create position variables (\u003ccode\u003edata\u003c/code\u003e in Options API or \u003ccode\u003eref\u003c/code\u003e in Composition API) of type \u003ccode\u003e{x, y}\u003c/code\u003e, and then draw the desired shape as the child slot of the draggable component. In this example, I have \u003ccode\u003eredCircle\u003c/code\u003e and \u003ccode\u003eblueSquare\u003c/code\u003e positions:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003esvg\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eviewBox\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e-100 -100 200 200\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003cspan class=\"token value css language-css\"\u003e\u003cspan class=\"token property\"\u003ebackground\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token hexcode color\"\u003e#eee\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eDraggable\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ev-model\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eredCircle\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ecircle\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003er\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e10\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003efill\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ehsl(0 50% 50%)\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003eDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003eDraggable\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ev-model\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003eblueSquare\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003erect\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ex\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e-10\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ey\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e-10\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ewidth\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e20\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eheight\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e20\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003efill\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ehsl(220 50% 50%)\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003eDraggable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003esvg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI put a full example of this \u003ca href=\"https://play.vuejs.org/#eNrtV2tv2zYU/SsXXofImS2lAfbFSfbyimEYhgZIUGyYh1WWrmQ2kqiRlB8z/N93SD0sO26WtRj2pQZsi+S5l/d5RG4H35alv6x4MBkE58TrMC8zJplQrMKUwiLGgywpkYr0MiXOOOfC6KtZQURRWNCcKZexSATHZCStpHqglTALWpg86/BYkrWMZsaSKfUkCFarla84nmdynoY5az+SeZCHD6JIxzIJrAlpOM84oPNgVsyKax0pURroMFX5lVUn8lIqQ1vFyY4SJXM6gzNnbqsgaJe/bxU1ED/oZl6XRshC2xDUUv8sMpWAaGHl9mL2G0GRITg0FSqC5A2eE2+7ntCXFyPaTGh8ebEbOngNnWcV3/1ZhaqPHTfgBnsd1E7DXQwMIz+hYef8tc3IUvDqO7m+mQ3GLy8urDQkLwjPswFps8kYS/MwekiVrIp4Qp8x82zgFEDF3s/lGHnkDOjOgw4GYFT7pLD+0qpORGaxC515F/Dvc/sdYj5oNe8D9tRe+xD0N1McGWp8gs5N97QSsVlgdGkHCxbpwrSjnkGXl88yCaFdpni6DnphHYwG78s0euQoAWmteGJUWGj0SA4D3rqBxXgvts7NNyGc9Ne70cF4sxu+nQ1qBd+UUhSGVSxXhZ9xYp3SJlTmGFCVWOEihlftFJowcqF004fwXC5t+l0joanoa/TqEnbxEk05pAkVVZZ1QkZW0cJt65fKQSBrd7Lyj+cb36Ms1BoT23aX3b66dCZNE/7r4FGojxu67qKnWrpdQ/ssWZlbsebsXt4t06mUKm7hvs1rZGe0/04f92cJPtPot5gTUfCtHXnb2t59dib0ev7OFiFIRC9klcWW6LZrdObOYps23mvlXJhO6SsMtPfbWVXG8HSyV3v2+9C63Qp1eam7PwkzzVaxRSRVEdnCQw8j8F6TscZQkVA940dGZT/xZggFplJFzbGUMYLkjIXq08FqNDYCrSX+0poJoW0MKnKh8vs1TGOC2hj09Ghtg7XNrtHXGFcphf/7UKVsfCT5ti7LaVjCWG5caGr1x7g2BvE98B9lfeT9I2NtFZ+UddV+KPyvQ2Mz651I5ajVSIRQremLI7v8eD1qAYjX5gRg0wCaaoL1h2zv6Jt0JEuOXROltCUEVUs1oVSF8ysrg2m/q6QtVZrVWOPFGxn0tyz46kBkDpQTw1ZW/RHl9d6Hn+juP6K7g5PLh1EZr5006CasMmhx88b15IR6YW95bDd6H5OhnUITeuiPhkLw0Lo2IUdJtEPBoFRnBhTJZiFju0lb26f46Tkc9UHNaD9mIfS+4BuqcpOnmep46YCoPpKsXPd2bW6p6o/HkTg2uKOrQ+kTZPVxMXrxDOrq0deBmX326jHYEaYlsB6J9X3a2Z//mdn6/eMuOec0rYNYt5gLHeIKiCgQJ9JlGDF5eHuYBVMZpjy0F5u7Nz/0ULDtvEXa246o0dhsRAtZSGUtVqxLcKlY4tjMWvyFuVF9gg3qo6sN07m7ZDWn+KG76DTN3b3Fnkr6CFesmxMF3JVQfdKwN4UbQH0wLiv48qq+mPXOCyUAgPmRYjgIiKt/r81qiZaChnqnTODvl25lc7Tya7uC+dLPQ6PE+r59Z3h2E1h4h424mN7/7A19YR3U7A3b3RoqKjFEQge7vwFtIua8\"\u003eon the Vue Playground\u003c/a\u003e\u003csup class=\"print-endnote\"\u003e[17]\u003c/sup\u003e, with both Options API and Composition API components.\u003c/p\u003e","noteIndex":{"id":"Iy0MoL0KnL55Br3AfTS2C","title":"Luke","desc":"","updated":1761796791487,"created":1644449449778,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"4e745570ca97988a0362cb939b760952","links":[{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"life-tips","position":{"start":{"line":41,"column":5,"offset":2603},"end":{"line":41,"column":29,"offset":2627},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"life-tips","anchorHeader":"wodenokoto"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2025","alias":"What I read in 2025","position":{"start":{"line":70,"column":3,"offset":4333},"end":{"line":70,"column":54,"offset":4384},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2025"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2024","alias":"2024","position":{"start":{"line":71,"column":5,"offset":4389},"end":{"line":71,"column":41,"offset":4425},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2024"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2023","alias":"2023","position":{"start":{"line":72,"column":5,"offset":4430},"end":{"line":72,"column":41,"offset":4466},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2023"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2022","alias":"2022","position":{"start":{"line":73,"column":5,"offset":4471},"end":{"line":73,"column":41,"offset":4507},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2022"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-struggled-brag-in","position":{"start":{"line":79,"column":3,"offset":4643},"end":{"line":79,"column":39,"offset":4679},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-struggled-brag-in"}}],"anchors":{"what-i-read-in-past":{"type":"header","text":"What I read in past","value":"what-i-read-in-past","line":74,"column":0,"depth":2}},"children":["zd4mq442jike0pr0wba1u3m","6hzeqsofq67gdk88flxlkhp","778ijii93yu5uwnrwmn5zi4","g1fngdjl25nes6fs3lip602","ZbdkdApFqLdks4Moq92R9","uoc5hhki3o4py15cesddu8q","9qf7j06jtdkm6rnx9ymvwb0","5zn10cvj7ajy2gh2is5nqmg","4qo9ma0z0yu1czns6pxl7y5","ok0e729ho7o09xetujkxc0m","GR5x8HnNFEN6fU2UBSEIK","yirtnlj8q24yutcf3ss1xqy","eq0wc6t7wl2wv221yb68ro4","7x2fnv4j6gxts08qk0jguny","ettkt3iClONnxpbGwBVLl","7l4knev6v613tbuoskvmbdg","hvh5bud6yp7dc89tuh95tr9","4fvoqrplw0cweo554usbjos","f8qsfql0a9v8thpeo82udfa","1swsbrhqi9jk41v9eodyi5q","SQqYupi6EFddTerBA8RRD","hjNeNc1F2JUh0lTWanH4h","qf0l4wbrc9jgooyzexmbq5v","uur1lkol353z9vfeqb3n5bv","cd9n1czq3ursgkby985wkmm","k1sr43vwnfqztwc0s43pkcf","wfde75rhdvq2yfa2zy2q6rv","rjcmdv60jokmbw6zoq8u2ef","ujapvww8o6v3kpmlhtryq4k","pkwewou9d5e8ystswn1j2b4"],"parent":null,"data":{},"body":"\nHi there 👋. I'm a Front-end developer.\n\n---\n\n- 단순함과 꾸준함은 가장 쉬우면서도 지키기 어려운 원칙.\n\n- 🥱 -\u003e 🤔💡🌱 - [On The Death of Daydreaming](https://www.afterbabel.com/p/on-the-death-of-daydreaming)\n  - boredom -\u003e easy fun -\u003e art -\u003e profit?\n\n\u003e I've often described my motivation for building software to others using imagery: I like to go find a secluded beach, build a large, magnificent sand castle, and then walk away. Will anyone notice? Probably not. Will the waves eventually destroy it? Yep. Did I still get immense satisfaction? Absolutely. - [aliasxneo](https://news.ycombinator.com/item?id=41497113)\n\n\u003e We love to see the process, not just the result. The imperfections in your work can be beautiful if they show your struggle for perfection, not a lack of care. - [ralphammer](https://ralphammer.com/is-perfection-boring/)\n\n\u003e Simplicity, even if it sacrifices some ideal functionality has better survival characteristics than the-right-thing. - [The Rise of Worse is Better](https://www.dreamsongs.com/RiseOfWorseIsBetter.html)\n\n\u003e [Roberto Blake was talking about making 100 crappy videos](https://www.youtube.com/watch?v=OnUBaQ1Sp_E) to get better over time. Putting in the reps and improving a little bit each time.\n\u003e\n\u003e Putting in the work without expecting any external reward at first (eg views, followers, likes, etc) will pay off in the long run. - [100 Scrappy Things](https://www.florin-pop.com/blog/100-scrappy-things/)\n\n\u003e Make the difficult habitual, the habitual easy, and the easy beautiful. - [Constantin S. Stanislavski](https://www.goodreads.com/quotes/7102271-make-the-difficult-habitual-the-habitual-easy-and-the-easy)\n\n\u003e A good match is a **structured** dance, where players aim to **score** while they are following well-defined **rules**. This **freedom within a structure** is what makes it fun. - [ralphammer](https://ralphammer.com/how-to-get-started/)\n\n- [Pivot Points](https://longform.asmartbear.com/pivot-points/)\n\n  - non-judgmental aspects of personality that can be strengths in some contexts and weaknesses in others\n  - Pivot Points are fixed in the short term\n\n- [Hedged Bets](https://longform.asmartbear.com/predict-the-future/#hedged-bets)\n  - trading slightly less maximum upside for predictable, net-positive outcomes.\n\n\u003e “Motivation often comes after starting, not before. Action produces momentum.”\n\u003e [When you start a new habit, it should take less than two minutes to do.](https://jamesclear.com/how-to-stop-procrastinating)\n\u003e\n\u003e - James Clear\n\n\u003e Focus is more about **not** keeping busy when you need to wait for something.  \n\u003e Eat the boredom for a minute.\n\u003e\n\u003e - [[life-tips#wodenokoto]]\n\n\u003e [4 minutes run hard enough to push heart rate to 90%, 3 minutes recover, repeat 4 times](https://news.ycombinator.com/item?id=34213181)\n\u003e\n\u003e - https://www.ntnu.edu/cerg/advice\n\u003e - [Get running with Couch to 5K](https://www.nhs.uk/live-well/exercise/running-and-aerobic-exercises/get-running-with-couch-to-5k/)\n\n\u003e [recommended routine - bodyweightfitness](https://www.reddit.com/r/bodyweightfitness/wiki/kb/recommended_routine/) - I Don't Have This Much Time!\n\u003e\n\u003e - Don't workout at all (saves anywhere from 20 to 60 minutes, but really, really, really, really, really, really, really, really, really not recommended)\n\n\u003e 도무지 읽히지 않는 책 앞에서 내가 택한 방법은 펼쳐진 페이지 앞에서 멍때리기이다. 다르게 표현하면 이렇다. 펼쳐진 두 페이지 앞에서 오래 머물기.\n\u003e\n\u003e 책을 펼쳐놓는 것으로 충분하다. 읽지 못해도 좋다. 매일 정해진 진도를 나가야 하는 학교 수업이 아니니까. 하지만 읽지 않아도 괜찮다고 해서 펼쳐두지조차 않으면 곤란하다. 가능한 한 자주 책을 펼쳐두도록 하자. 전혀 읽지 않고 멍하니 바라보고 있다가 다시 덮게 되더라도\n\u003e\n\u003e - 막막한 독서. 시로군. P.10~13\n\n\u003e I think it should be everyone's primary focus to sleep well, drink water, get outside, get active, and eat generally decently. I hate to say it, but if you're not eating a good amount of vegetables and fruit, decent protein, sleep, etc, no amount of XYZ will catch up to that detriment. - [CE02](https://news.ycombinator.com/item?id=35056071)\n\n\u003e My real battle is doing good versus doing nothing. - [Deirdre Sullivan](https://www.npr.org/2005/08/08/4785079/always-go-to-the-funeral)\n\n[Kind Engineering](https://kind.engineering/) - How To Engineer Kindness\n\n\u003e Sometimes magic is just someone spending more time on something than anyone else might reasonably expect. - [Teller](https://www.goodreads.com/quotes/6641527-sometimes-magic-is-just-someone-spending-more-time-on-something)\n\n---\n\n## What I read in past\n\n- [[What I read in 2025|journal.what-i-read-in.2025]]\n  - [[2024|journal.what-i-read-in.2024]]\n  - [[2023|journal.what-i-read-in.2023]]\n  - [[2022|journal.what-i-read-in.2022]]\n- 📝 [Gists](https://gist.github.com/Luke-SNAW)\n- 📜 [Journals](https://luke-snaw.github.io/Luke-SNAW__netlify-CMS.github.io/)\n\n---\n\n- [[journal.what-i-struggled-brag-in]]\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":false,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.115.0","enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Luke SNAW","description":"Personal knowledge space"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://luke-snaw.github.io/","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"0pt1h99anrpns3e7xkundxk"},"buildId":"vOE8u-mg___OsOsz4tjEg","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>