<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>CLI</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="CLI"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://luke-snaw.github.io//notes/z8iu36gfcu6tok0rnwtawg0/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/28/2022"/><meta property="article:modified_time" content="4/3/2025"/><link rel="canonical" href="https://luke-snaw.github.io//notes/z8iu36gfcu6tok0rnwtawg0/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_buildManifest.js" defer=""></script><script src="/_next/static/vOE8u-mg___OsOsz4tjEg/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="cli">CLI<a aria-hidden="true" class="anchor-heading icon-link" href="#cli"></a></h1>
<h2 id="collections">Collections<a aria-hidden="true" class="anchor-heading icon-link" href="#collections"></a></h2>
<ul>
<li><a href="https://github.com/jlevy/the-art-of-command-line">The Art of Command Line</a></li>
<li>🤖 <a href="https://github.com/casey/just">just</a> is a handy way to save and run project-specific commands.</li>
<li><a href="https://github.com/dbohdan/structured-text-tools">Structured text tools</a> - The following is a list of text-based file formats and command line tools for manipulating each.</li>
<li><a href="https://github.com/loeffel-io/ls-lint">ls-lint</a> - An extremely fast directory and filename linter - Bring some structure to your project filesystem</li>
<li><a href="https://github.com/jdx/mise">mise-en-place</a> - dev tools, env vars, task runner</li>
<li><a href="https://github.com/flox/flox/">Flox</a> is a virtual environment and package manager all in one.</li>
<li><a href="https://github.com/ChrisBuilds/terminaltexteffects">Terminal Text Effects</a></li>
<li><a href="https://github.com/twpayne/chezmoi">chezmoi</a> - Manage your dotfiles across multiple diverse machines, securely.</li>
<li><a href="https://github.com/dotenvx/dotenvx">dotenvx</a> - <em>a better dotenv</em>–from the creator of <a href="https://github.com/motdotla/dotenv"><code>dotenv</code></a>.
<ul>
<li>run anywhere (cross-platform)</li>
<li>multi-environment</li>
<li>encrypted envs</li>
</ul>
</li>
<li><a href="https://ethanschoonover.com/solarized/">Solarized</a> - Precision colors for machines and people</li>
</ul>
<h2 id="shell">Shell<a aria-hidden="true" class="anchor-heading icon-link" href="#shell"></a></h2>
<ul>
<li><a href="https://github.com/binpash/try">try</a> lets you run a command and inspect its effects before changing your live system. <code>try</code> uses Linux's <a href="https://docs.kernel.org/userspace-api/unshare.html">namespaces (via <code>unshare</code>)</a> and the <a href="https://docs.kernel.org/filesystems/overlayfs.html">overlayfs</a> union filesystem.</li>
<li><a href="https://github.com/atuinsh/atuin">atuin</a> - ✨ Magical shell history</li>
<li><a href="https://fishshell.com/">fish</a> - the friendly interactive shell
<ul>
<li><a href="https://github.com/pure-fish/pure">pure.fish</a> - Pretty, minimal, and fast prompt for Fish shell</li>
</ul>
</li>
</ul>
<h2 id="script">Script<a aria-hidden="true" class="anchor-heading icon-link" href="#script"></a></h2>
<ul>
<li><a href="https://github.com/google/zx">zx</a> - A tool for writing better scripts using javascript</li>
</ul>
<h2 id="features">Features<a aria-hidden="true" class="anchor-heading icon-link" href="#features"></a></h2>
<ul>
<li><a href="https://github.com/withfig/autocomplete">Fig</a> adds autocomplete to your terminal</li>
<li><a href="https://github.com/watchexec/watchexec">Watchexec</a> - Executes commands in response to file modifications</li>
</ul>
<h3 id="reflex"><a href="https://github.com/cespare/reflex">Reflex</a><a aria-hidden="true" class="anchor-heading icon-link" href="#reflex"></a></h3>
<p>Run a command when files change</p>
<blockquote>
<p>I have been using reflex <a href="https://github.com/cespare/reflex">https://github.com/cespare/reflex</a> for the same thing in some of our docker projects</p>
</blockquote>
<blockquote>
<p>+1 for reflex, love being able to have a config for development<br>
Example .reflex.conf to run one command when an openapi spec changes and another when any go files change:</p>
</blockquote>
<pre class="language-shell"><code class="language-shell">-g <span class="token string">"spec.yaml"</span> -- <span class="token function">bash</span> -c <span class="token string">'make'</span>
-sr <span class="token string">"\.go$"</span> -- go run cmd/app/main.go
</code></pre>
<p>Then run it with:</p>
<pre class="language-shell"><code class="language-shell">reflex -d fancy -c .reflex.conf
</code></pre>
<h4 id="why-you-should-use-reflex-instead">Why you should use reflex instead<a aria-hidden="true" class="anchor-heading icon-link" href="#why-you-should-use-reflex-instead"></a></h4>
<ul>
<li>Reflex has no dependencies. No need to install Ruby or anything like that.</li>
<li>Reflex uses an appropriate file watching mechanism to watch for changes efficiently on your platform.</li>
<li>Reflex gives your command the name of the file that changed.</li>
<li>No DSL to learn -- just give it a shell command.</li>
<li>No plugins.</li>
<li>Not tied to any language, framework, workflow, or editor.</li>
</ul>
<h2 id="viewer">Viewer<a aria-hidden="true" class="anchor-heading icon-link" href="#viewer"></a></h2>
<ul>
<li><a href="https://github.com/antonmedv/fx">fx</a> - Terminal JSON viewer</li>
<li>Write reducers in your favorite language: <a href="https://github.com/antonmedv/fx/blob/master/doc/js.md">JavaScript</a> (default), <a href="https://github.com/antonmedv/fx/blob/master/doc/python.md">Python</a>, or <a href="https://github.com/antonmedv/fx/blob/master/doc/ruby.md">Ruby</a>.</li>
</ul>
<h2 id="절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담"><a href="https://velog.io/@skynet/%EC%A0%88%EB%8C%80-Cron%EC%97%90%EC%84%9C-%ED%91%9C%EC%A4%80-%EC%B6%9C%EB%A0%A5%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EB%A7%88%EC%84%B8%EC%9A%94-root-%EB%B3%BC%EB%A5%A8-%ED%8F%AC%ED%99%94-%EA%B4%B4%EB%8B%B4">절대 Cron에서 표준 출력을 사용하지 마세요 - root 볼륨 포화 괴담</a><a aria-hidden="true" class="anchor-heading icon-link" href="#절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담"></a></h2>
<h3 id="아침을-깨운-root-disk-사용량-알림">아침을 깨운 root disk 사용량 알림<a aria-hidden="true" class="anchor-heading icon-link" href="#아침을-깨운-root-disk-사용량-알림"></a></h3>
<p>오전 6시 40분, 운영 서버 중 하나의 루트 디스크 사용률이 90%가 넘는다는 알림이 발생했다. Critical 레벨 알림이었기 때문에 모든 팀원에게 전화가 발신됐다.</p>
<p>이 서버는 모니터링 데이터를 저장하는 용도로 사용한다. 당연히 모든 데이터는 별도로 마운트한 데이터 볼륨에 저장된다. 루트 볼륨이 이 정도로 가득차는 것은 잘 일어나지 않는 이상한 일이다. 게다가 모니터링 데이터를 확인해보니 하루만에 디스크 용량이 5GiB 가량 증가했고 지금도 빠른 속도로 증가하고 있었다.</p>
<p>디스크 사용량이 빠르게 증가하고 있었으므로 우선 루트 볼륨을 확장해 장애 발생을 막았다. 그러나 원인을 밝히지는 못했다.</p>
<h3 id="유령-파일-사건">유령 파일 사건<a aria-hidden="true" class="anchor-heading icon-link" href="#유령-파일-사건"></a></h3>
<p><code>/var/log</code> 등 데이터를 많이 차지할만한 공간을 확인해보았으나 허사였다. 결국 <code>du</code> 명령어로 루트 볼륨의 모든 서브 디렉토리를 전수조사 하였지만 디스크 사용량이 증가한 원인을 찾을 수 없었다. du 로 확인한 루트 볼륨의 사용량은 10GB 정도였는데 알 수 없는 5GB가 더 사용되고 있었다.</p>
<p>(참고: du 명령어를 재귀적으로 사용하는 건 I/O 부하가 상당하기 때문에 운영 서버에서 수행하기는 부담스러운 작업이다. nice와 ionice를 이용해 우선순위를 최하로 설정한 뒤 서브 디렉토리를 순차적으로 하나씩 검증하는 등의 방식으로 부하를 분산하였다.)</p>
<p>처음 검증한 가설은 ext4의 예약 공간(Reserved space)가 5GiB를 사용한다는 것이었다. 그러나 예약 공간의 점유율이 전체 디스크 공간의 5% 가량이고 루트 볼륨의 크기가 20GB에 불과하다는 점을 감안하면 가능성이 거의 없었다.</p>
<p>다음 가설은 마운트로 인한 루트 볼륨 파일 누락이었다. 루트 볼륨에서 이미 사용하던 디렉토리에 다른 디스크를 마운트 했을 때, 기존에 디렉토리에 있던 파일들은 여전히 디스크를 점유하지만 du 결과에서는 나타나지 않는다고 한다. 그러나 기존에 사용하던 데이터 볼륨 외에 다른 디스크를 마운트한 적은 없었다.</p>
<p>그 다음으론 삭제 파일이 디스크를 점유하고 있을 가능성이다. 기존 프로세스가 열어 둔 파일은 rm 명령어 등을 이용해 삭제하더라도 디스크를 점유한다고 한다. 파일이 삭제된 사실을 알지 못하는 프로세스가 더 이상 존재하지 않는 파일의 내용을 읽는 것을 방지하기 위함이다. 프로세스가 파일을 닫아야 완전히 디스크에서 제거한다.</p>
<p>그럼 현재 실행되는 프로세스 중 삭제된 파일을 열고 있는 것이 있는지를 검증하면 된다. 사용한 명령어는 다음과 같다.</p>
<pre class="language-shell"><code class="language-shell"><span class="token comment"># nice: CPU 우선순위 최하로 설정</span>
<span class="token comment"># ionice: I/O 우선순위 최하로 설정</span>
<span class="token comment"># +L1: 링크 수가 1보다 작은 파일</span>
<span class="token function">nice</span> -n19 ionice -c3 <span class="token function">sudo</span> <span class="token function">lsof</span> +L1
</code></pre>
<p>결과를 확인해보니 rsync를 이용해 핫 스토리지에서 웜 스토리지로 파일을 옮기는 cron 프로세스(이하 warmer로 표기)가 <code>/tmp</code> 디렉토리의 삭제된 파일을 열어두고 있었다. 크기도 사라진 5GB와 엇비슷했다. 디스크 사용량이 계속 증가하고 있었으므로 파일의 크기와 디스크 증가량을 면밀히 대조해 볼 여유는 없었다. 직감이 말하는대로 이 프로세스를 kill 하자 즉시 디스크 사용량이 감소했다.</p>
<p>(참고: 핫 스토리지는 조회와 쓰기 부하가 상대적으로 높은, 즉 '뜨거운' 저장소이다. 반면 warm 스토리지는 부하가 상대적으로 낮은 '미지근한' 저장소이다. 일반적으로 웜 스토리지는 핫 스토리지보다 저렴한 타입을 사용한다. 모니터링 데이터는 최근 데이터의 조회 빈도가 훨씬 높기 때문에 hot/warm 구분의 근거가 명확하다.)</p>
<h3 id="범인-검거">범인 검거<a aria-hidden="true" class="anchor-heading icon-link" href="#범인-검거"></a></h3>
<p>warmer를 다시 실행하자 디스크 사용량이 다시 증가하기 시작했다. lsof 결과도 전과 유사했다. <code>/tmp</code> 디렉토리에 존재했으나 지금은 삭제된 파일을 열어두고 있다는 것이다. 보안 로그를 통해 모든 사용자의 명령어를 검색해보았으나 삭제 명령어를 수행한 사람은 없었다. 결국 사람이 아닌 프로세스가 지운 것이 명확했다.</p>
<p><code>ionotifywait</code> 명령어를 이용해 <code>/tmp</code> 디렉토리를 모니터링 해보니 확실히 변경이 일어나곤 있었다. 그러나 이 명령어로는 어떤 프로세스가 파일을 만들고 삭제하는지 알 수 없었다.</p>
<p>나는 범인으로 rsync를 의심했다. warmer의 주요 업무가 rsync를 실행이었기 때문이다. 조사 결과 rsync는 파일을 복사할 때 임시 파일을 생성한다고 했다. 확신을 얻은 나는 상황을 재현하기 위해 여러 테스트를 했다. 그러나 소득은 내가 틀렸다는 사실을 알았다는 것 뿐이었다. rsync는 임시 파일을 <code>/tmp</code>가 아니라 목적지 디렉토리에 생성했다. 임시 파일을 저장할 디렉토리를 플래그로 따로 지정하면 그렇지 않을수도 있지만, 우리는 디폴트 값을 사용하고 있었다.</p>
<p>그래도 warmer에 대한 의심을 져버릴 수 없었던 나는 <code>/proc</code> 디렉토리에 접근해 파일 디스크립터를 조회했다. 그런데 warmer의 1,2 번 파일 디스크립터가 <code>/tmp</code> 디렉토리의 삭제된 파일을 지시하는 심볼릭 링크였다.</p>
<p>즉 stdout과 stderr가 <code>/tmp</code> 디렉토리에 출력되고 있으나, 파일은 남아있지 않고 삭제되고 있었다. 그러면서도 warmer 디렉토리가 그 삭제된 파일을 계속 열어두고 있는 상황이었다.</p>
<p>warmer는 crontab으로 실행되고 있었고 stdout과 stderr를 따로 리다이렉트하진 않았다. cron은 터미널을 통해 접속한 사용자가 아니므로 로그를 찍을 곳이 없긴 하다. 그런데 널 디바이스(<code>/dev/null</code>)로 출력을 버리지 않고, '출력을 임시 파일에 저장한 뒤 삭제하되 닫지는 않는다.' 라는 이상한 선택을 한 것이었다.</p>
<p>재현 테스트를 거친 결과 cron이 내가 추측한 방식대로 동작한다는 것을 확신할 수 있었다. 표준 출력에 무의미한 로그를 남기는 shell script를 cron으로 실행한 뒤, 앞서 이야기 한 <code>lsof</code> 명령어 결과와 <code>/proc</code> 디렉토리의 파일 디스크립터를 조회해보면 동일한 현상이 재현되는 것을 확인할 수 있다.</p>
<pre class="language-shell"><code class="language-shell"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token function">head</span> -c <span class="token variable"><span class="token variable">$((</span><span class="token number">50</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token variable">))</span></span> <span class="token operator">&#x3C;</span> /dev/zero <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\0'</span> <span class="token string">'A'</span>
  <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token keyword">done</span>
</code></pre>
<p>(실험 환경: Ubuntu 24.04)</p>
<h3 id="마치며">마치며<a aria-hidden="true" class="anchor-heading icon-link" href="#마치며"></a></h3>
<p>아직도 cron이 왜 표준 출력을 디스크에 저장하고 추적까지 어렵게 만드는 행동을 하는진 모르겠다. 그러나 cron을 직접 고쳐 쓰기는 현실적으로 어려우니 사용법을 바꿔야 한다. 사실 cron의 실행 결과를 로그로 남기지 않고 버리는 것은 작업의 성공, 실패 여부를 알기 어렵게 만드는 방식이다. 게다가 디버깅 뿐만 아니라 root 디스크 포화를 유발할 수 있는 아주 위험한 방식임이 실험을 통해 검증되었다. cron을 안전하게 수행하려면 다음의 방침을 따라야 한다.</p>
<ul>
<li>파일에 로그를 남긴다.</li>
<li>로그 파일은 루트 볼륨이 아니라 데이터 볼륨에 위치시켜야 한다</li>
<li>logrotate 등의 수단을 이용해 크기가 무한정 커지지 않도록 제어해야 한다.</li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/notes/lmkaoriwaly8fn7xim6wnv0">5 Modern Bash Scripting Techniques That Only A Few Programmers Know</a></li>
<li><a href="/notes/yn68lbuog9rseo4kzfqz6sw">A list of new(ish) command line tools</a></li>
</ol></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#collections" title="Collections">Collections</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#shell" title="Shell">Shell</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#script" title="Script">Script</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#features" title="Features">Features</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#reflex" title="Reflex">Reflex</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#why-you-should-use-reflex-instead" title="Why you should use reflex instead">Why you should use reflex instead</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#viewer" title="Viewer">Viewer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담" title="절대 Cron에서 표준 출력을 사용하지 마세요 - root 볼륨 포화 괴담">절대 Cron에서 표준 출력을 사용하지 마세요 - root 볼륨 포화 괴담</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#아침을-깨운-root-disk-사용량-알림" title="아침을 깨운 root disk 사용량 알림">아침을 깨운 root disk 사용량 알림</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#유령-파일-사건" title="유령 파일 사건">유령 파일 사건</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#범인-검거" title="범인 검거">범인 검거</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#마치며" title="마치며">마치며</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"z8iu36gfcu6tok0rnwtawg0","title":"CLI","desc":"","updated":1743722795972,"created":1653704390962,"custom":{},"fname":"dev.tools.cli","type":"note","vault":{"fsPath":"vault"},"contentHash":"147431f06474dd362ed29d54e0ed8391","links":[],"anchors":{"collections":{"type":"header","text":"Collections","value":"collections","line":8,"column":0,"depth":2},"shell":{"type":"header","text":"Shell","value":"shell","line":24,"column":0,"depth":2},"script":{"type":"header","text":"Script","value":"script","line":31,"column":0,"depth":2},"features":{"type":"header","text":"Features","value":"features","line":35,"column":0,"depth":2},"reflex":{"type":"header","text":"Reflex","value":"reflex","line":40,"column":0,"depth":3},"why-you-should-use-reflex-instead":{"type":"header","text":"Why you should use reflex instead","value":"why-you-should-use-reflex-instead","line":60,"column":0,"depth":4},"viewer":{"type":"header","text":"Viewer","value":"viewer","line":69,"column":0,"depth":2},"절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담":{"type":"header","text":"절대 Cron에서 표준 출력을 사용하지 마세요 - root 볼륨 포화 괴담","value":"절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담","line":74,"column":0,"depth":2},"아침을-깨운-root-disk-사용량-알림":{"type":"header","text":"아침을 깨운 root disk 사용량 알림","value":"아침을-깨운-root-disk-사용량-알림","line":76,"column":0,"depth":3},"유령-파일-사건":{"type":"header","text":"유령 파일 사건","value":"유령-파일-사건","line":84,"column":0,"depth":3},"범인-검거":{"type":"header","text":"범인 검거","value":"범인-검거","line":109,"column":0,"depth":3},"마치며":{"type":"header","text":"마치며","value":"마치며","line":136,"column":0,"depth":3}},"children":["lmkaoriwaly8fn7xim6wnv0","yn68lbuog9rseo4kzfqz6sw"],"parent":"5iokala6y4rafqa368l1a4h","data":{}},"body":"\u003ch1 id=\"cli\"\u003eCLI\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cli\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"collections\"\u003eCollections\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#collections\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jlevy/the-art-of-command-line\"\u003eThe Art of Command Line\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e🤖 \u003ca href=\"https://github.com/casey/just\"\u003ejust\u003c/a\u003e is a handy way to save and run project-specific commands.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/dbohdan/structured-text-tools\"\u003eStructured text tools\u003c/a\u003e - The following is a list of text-based file formats and command line tools for manipulating each.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/loeffel-io/ls-lint\"\u003els-lint\u003c/a\u003e - An extremely fast directory and filename linter - Bring some structure to your project filesystem\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jdx/mise\"\u003emise-en-place\u003c/a\u003e - dev tools, env vars, task runner\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/flox/flox/\"\u003eFlox\u003c/a\u003e is a virtual environment and package manager all in one.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ChrisBuilds/terminaltexteffects\"\u003eTerminal Text Effects\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/twpayne/chezmoi\"\u003echezmoi\u003c/a\u003e - Manage your dotfiles across multiple diverse machines, securely.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/dotenvx/dotenvx\"\u003edotenvx\u003c/a\u003e - \u003cem\u003ea better dotenv\u003c/em\u003e–from the creator of \u003ca href=\"https://github.com/motdotla/dotenv\"\u003e\u003ccode\u003edotenv\u003c/code\u003e\u003c/a\u003e.\n\u003cul\u003e\n\u003cli\u003erun anywhere (cross-platform)\u003c/li\u003e\n\u003cli\u003emulti-environment\u003c/li\u003e\n\u003cli\u003eencrypted envs\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ethanschoonover.com/solarized/\"\u003eSolarized\u003c/a\u003e - Precision colors for machines and people\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"shell\"\u003eShell\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#shell\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/binpash/try\"\u003etry\u003c/a\u003e lets you run a command and inspect its effects before changing your live system. \u003ccode\u003etry\u003c/code\u003e uses Linux's \u003ca href=\"https://docs.kernel.org/userspace-api/unshare.html\"\u003enamespaces (via \u003ccode\u003eunshare\u003c/code\u003e)\u003c/a\u003e and the \u003ca href=\"https://docs.kernel.org/filesystems/overlayfs.html\"\u003eoverlayfs\u003c/a\u003e union filesystem.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/atuinsh/atuin\"\u003eatuin\u003c/a\u003e - ✨ Magical shell history\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://fishshell.com/\"\u003efish\u003c/a\u003e - the friendly interactive shell\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/pure-fish/pure\"\u003epure.fish\u003c/a\u003e - Pretty, minimal, and fast prompt for Fish shell\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"script\"\u003eScript\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#script\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/google/zx\"\u003ezx\u003c/a\u003e - A tool for writing better scripts using javascript\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"features\"\u003eFeatures\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#features\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/withfig/autocomplete\"\u003eFig\u003c/a\u003e adds autocomplete to your terminal\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/watchexec/watchexec\"\u003eWatchexec\u003c/a\u003e - Executes commands in response to file modifications\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"reflex\"\u003e\u003ca href=\"https://github.com/cespare/reflex\"\u003eReflex\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#reflex\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eRun a command when files change\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI have been using reflex \u003ca href=\"https://github.com/cespare/reflex\"\u003ehttps://github.com/cespare/reflex\u003c/a\u003e for the same thing in some of our docker projects\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e+1 for reflex, love being able to have a config for development\u003cbr\u003e\nExample .reflex.conf to run one command when an openapi spec changes and another when any go files change:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e-g \u003cspan class=\"token string\"\u003e\"spec.yaml\"\u003c/span\u003e -- \u003cspan class=\"token function\"\u003ebash\u003c/span\u003e -c \u003cspan class=\"token string\"\u003e'make'\u003c/span\u003e\n-sr \u003cspan class=\"token string\"\u003e\"\\.go$\"\u003c/span\u003e -- go run cmd/app/main.go\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen run it with:\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003ereflex -d fancy -c .reflex.conf\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"why-you-should-use-reflex-instead\"\u003eWhy you should use reflex instead\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#why-you-should-use-reflex-instead\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eReflex has no dependencies. No need to install Ruby or anything like that.\u003c/li\u003e\n\u003cli\u003eReflex uses an appropriate file watching mechanism to watch for changes efficiently on your platform.\u003c/li\u003e\n\u003cli\u003eReflex gives your command the name of the file that changed.\u003c/li\u003e\n\u003cli\u003eNo DSL to learn -- just give it a shell command.\u003c/li\u003e\n\u003cli\u003eNo plugins.\u003c/li\u003e\n\u003cli\u003eNot tied to any language, framework, workflow, or editor.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"viewer\"\u003eViewer\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#viewer\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/antonmedv/fx\"\u003efx\u003c/a\u003e - Terminal JSON viewer\u003c/li\u003e\n\u003cli\u003eWrite reducers in your favorite language: \u003ca href=\"https://github.com/antonmedv/fx/blob/master/doc/js.md\"\u003eJavaScript\u003c/a\u003e (default), \u003ca href=\"https://github.com/antonmedv/fx/blob/master/doc/python.md\"\u003ePython\u003c/a\u003e, or \u003ca href=\"https://github.com/antonmedv/fx/blob/master/doc/ruby.md\"\u003eRuby\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담\"\u003e\u003ca href=\"https://velog.io/@skynet/%EC%A0%88%EB%8C%80-Cron%EC%97%90%EC%84%9C-%ED%91%9C%EC%A4%80-%EC%B6%9C%EB%A0%A5%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EB%A7%88%EC%84%B8%EC%9A%94-root-%EB%B3%BC%EB%A5%A8-%ED%8F%AC%ED%99%94-%EA%B4%B4%EB%8B%B4\"\u003e절대 Cron에서 표준 출력을 사용하지 마세요 - root 볼륨 포화 괴담\u003c/a\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#절대-cron에서-표준-출력을-사용하지-마세요---root-볼륨-포화-괴담\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"아침을-깨운-root-disk-사용량-알림\"\u003e아침을 깨운 root disk 사용량 알림\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#아침을-깨운-root-disk-사용량-알림\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e오전 6시 40분, 운영 서버 중 하나의 루트 디스크 사용률이 90%가 넘는다는 알림이 발생했다. Critical 레벨 알림이었기 때문에 모든 팀원에게 전화가 발신됐다.\u003c/p\u003e\n\u003cp\u003e이 서버는 모니터링 데이터를 저장하는 용도로 사용한다. 당연히 모든 데이터는 별도로 마운트한 데이터 볼륨에 저장된다. 루트 볼륨이 이 정도로 가득차는 것은 잘 일어나지 않는 이상한 일이다. 게다가 모니터링 데이터를 확인해보니 하루만에 디스크 용량이 5GiB 가량 증가했고 지금도 빠른 속도로 증가하고 있었다.\u003c/p\u003e\n\u003cp\u003e디스크 사용량이 빠르게 증가하고 있었으므로 우선 루트 볼륨을 확장해 장애 발생을 막았다. 그러나 원인을 밝히지는 못했다.\u003c/p\u003e\n\u003ch3 id=\"유령-파일-사건\"\u003e유령 파일 사건\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#유령-파일-사건\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e/var/log\u003c/code\u003e 등 데이터를 많이 차지할만한 공간을 확인해보았으나 허사였다. 결국 \u003ccode\u003edu\u003c/code\u003e 명령어로 루트 볼륨의 모든 서브 디렉토리를 전수조사 하였지만 디스크 사용량이 증가한 원인을 찾을 수 없었다. du 로 확인한 루트 볼륨의 사용량은 10GB 정도였는데 알 수 없는 5GB가 더 사용되고 있었다.\u003c/p\u003e\n\u003cp\u003e(참고: du 명령어를 재귀적으로 사용하는 건 I/O 부하가 상당하기 때문에 운영 서버에서 수행하기는 부담스러운 작업이다. nice와 ionice를 이용해 우선순위를 최하로 설정한 뒤 서브 디렉토리를 순차적으로 하나씩 검증하는 등의 방식으로 부하를 분산하였다.)\u003c/p\u003e\n\u003cp\u003e처음 검증한 가설은 ext4의 예약 공간(Reserved space)가 5GiB를 사용한다는 것이었다. 그러나 예약 공간의 점유율이 전체 디스크 공간의 5% 가량이고 루트 볼륨의 크기가 20GB에 불과하다는 점을 감안하면 가능성이 거의 없었다.\u003c/p\u003e\n\u003cp\u003e다음 가설은 마운트로 인한 루트 볼륨 파일 누락이었다. 루트 볼륨에서 이미 사용하던 디렉토리에 다른 디스크를 마운트 했을 때, 기존에 디렉토리에 있던 파일들은 여전히 디스크를 점유하지만 du 결과에서는 나타나지 않는다고 한다. 그러나 기존에 사용하던 데이터 볼륨 외에 다른 디스크를 마운트한 적은 없었다.\u003c/p\u003e\n\u003cp\u003e그 다음으론 삭제 파일이 디스크를 점유하고 있을 가능성이다. 기존 프로세스가 열어 둔 파일은 rm 명령어 등을 이용해 삭제하더라도 디스크를 점유한다고 한다. 파일이 삭제된 사실을 알지 못하는 프로세스가 더 이상 존재하지 않는 파일의 내용을 읽는 것을 방지하기 위함이다. 프로세스가 파일을 닫아야 완전히 디스크에서 제거한다.\u003c/p\u003e\n\u003cp\u003e그럼 현재 실행되는 프로세스 중 삭제된 파일을 열고 있는 것이 있는지를 검증하면 된다. 사용한 명령어는 다음과 같다.\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# nice: CPU 우선순위 최하로 설정\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# ionice: I/O 우선순위 최하로 설정\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# +L1: 링크 수가 1보다 작은 파일\u003c/span\u003e\n\u003cspan class=\"token function\"\u003enice\u003c/span\u003e -n19 ionice -c3 \u003cspan class=\"token function\"\u003esudo\u003c/span\u003e \u003cspan class=\"token function\"\u003elsof\u003c/span\u003e +L1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e결과를 확인해보니 rsync를 이용해 핫 스토리지에서 웜 스토리지로 파일을 옮기는 cron 프로세스(이하 warmer로 표기)가 \u003ccode\u003e/tmp\u003c/code\u003e 디렉토리의 삭제된 파일을 열어두고 있었다. 크기도 사라진 5GB와 엇비슷했다. 디스크 사용량이 계속 증가하고 있었으므로 파일의 크기와 디스크 증가량을 면밀히 대조해 볼 여유는 없었다. 직감이 말하는대로 이 프로세스를 kill 하자 즉시 디스크 사용량이 감소했다.\u003c/p\u003e\n\u003cp\u003e(참고: 핫 스토리지는 조회와 쓰기 부하가 상대적으로 높은, 즉 '뜨거운' 저장소이다. 반면 warm 스토리지는 부하가 상대적으로 낮은 '미지근한' 저장소이다. 일반적으로 웜 스토리지는 핫 스토리지보다 저렴한 타입을 사용한다. 모니터링 데이터는 최근 데이터의 조회 빈도가 훨씬 높기 때문에 hot/warm 구분의 근거가 명확하다.)\u003c/p\u003e\n\u003ch3 id=\"범인-검거\"\u003e범인 검거\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#범인-검거\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003ewarmer를 다시 실행하자 디스크 사용량이 다시 증가하기 시작했다. lsof 결과도 전과 유사했다. \u003ccode\u003e/tmp\u003c/code\u003e 디렉토리에 존재했으나 지금은 삭제된 파일을 열어두고 있다는 것이다. 보안 로그를 통해 모든 사용자의 명령어를 검색해보았으나 삭제 명령어를 수행한 사람은 없었다. 결국 사람이 아닌 프로세스가 지운 것이 명확했다.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eionotifywait\u003c/code\u003e 명령어를 이용해 \u003ccode\u003e/tmp\u003c/code\u003e 디렉토리를 모니터링 해보니 확실히 변경이 일어나곤 있었다. 그러나 이 명령어로는 어떤 프로세스가 파일을 만들고 삭제하는지 알 수 없었다.\u003c/p\u003e\n\u003cp\u003e나는 범인으로 rsync를 의심했다. warmer의 주요 업무가 rsync를 실행이었기 때문이다. 조사 결과 rsync는 파일을 복사할 때 임시 파일을 생성한다고 했다. 확신을 얻은 나는 상황을 재현하기 위해 여러 테스트를 했다. 그러나 소득은 내가 틀렸다는 사실을 알았다는 것 뿐이었다. rsync는 임시 파일을 \u003ccode\u003e/tmp\u003c/code\u003e가 아니라 목적지 디렉토리에 생성했다. 임시 파일을 저장할 디렉토리를 플래그로 따로 지정하면 그렇지 않을수도 있지만, 우리는 디폴트 값을 사용하고 있었다.\u003c/p\u003e\n\u003cp\u003e그래도 warmer에 대한 의심을 져버릴 수 없었던 나는 \u003ccode\u003e/proc\u003c/code\u003e 디렉토리에 접근해 파일 디스크립터를 조회했다. 그런데 warmer의 1,2 번 파일 디스크립터가 \u003ccode\u003e/tmp\u003c/code\u003e 디렉토리의 삭제된 파일을 지시하는 심볼릭 링크였다.\u003c/p\u003e\n\u003cp\u003e즉 stdout과 stderr가 \u003ccode\u003e/tmp\u003c/code\u003e 디렉토리에 출력되고 있으나, 파일은 남아있지 않고 삭제되고 있었다. 그러면서도 warmer 디렉토리가 그 삭제된 파일을 계속 열어두고 있는 상황이었다.\u003c/p\u003e\n\u003cp\u003ewarmer는 crontab으로 실행되고 있었고 stdout과 stderr를 따로 리다이렉트하진 않았다. cron은 터미널을 통해 접속한 사용자가 아니므로 로그를 찍을 곳이 없긴 하다. 그런데 널 디바이스(\u003ccode\u003e/dev/null\u003c/code\u003e)로 출력을 버리지 않고, '출력을 임시 파일에 저장한 뒤 삭제하되 닫지는 않는다.' 라는 이상한 선택을 한 것이었다.\u003c/p\u003e\n\u003cp\u003e재현 테스트를 거친 결과 cron이 내가 추측한 방식대로 동작한다는 것을 확신할 수 있었다. 표준 출력에 무의미한 로그를 남기는 shell script를 cron으로 실행한 뒤, 앞서 이야기 한 \u003ccode\u003elsof\u003c/code\u003e 명령어 결과와 \u003ccode\u003e/proc\u003c/code\u003e 디렉토리의 파일 디스크립터를 조회해보면 동일한 현상이 재현되는 것을 확인할 수 있다.\u003c/p\u003e\n\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token shebang important\"\u003e#!/bin/bash\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ehead\u003c/span\u003e -c \u003cspan class=\"token variable\"\u003e\u003cspan class=\"token variable\"\u003e$((\u003c/span\u003e\u003cspan class=\"token number\"\u003e50\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token variable\"\u003e))\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e /dev/zero \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003etr\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\\0'\u003c/span\u003e \u003cspan class=\"token string\"\u003e'A'\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003esleep\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edone\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e(실험 환경: Ubuntu 24.04)\u003c/p\u003e\n\u003ch3 id=\"마치며\"\u003e마치며\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#마치며\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e아직도 cron이 왜 표준 출력을 디스크에 저장하고 추적까지 어렵게 만드는 행동을 하는진 모르겠다. 그러나 cron을 직접 고쳐 쓰기는 현실적으로 어려우니 사용법을 바꿔야 한다. 사실 cron의 실행 결과를 로그로 남기지 않고 버리는 것은 작업의 성공, 실패 여부를 알기 어렵게 만드는 방식이다. 게다가 디버깅 뿐만 아니라 root 디스크 포화를 유발할 수 있는 아주 위험한 방식임이 실험을 통해 검증되었다. cron을 안전하게 수행하려면 다음의 방침을 따라야 한다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e파일에 로그를 남긴다.\u003c/li\u003e\n\u003cli\u003e로그 파일은 루트 볼륨이 아니라 데이터 볼륨에 위치시켜야 한다\u003c/li\u003e\n\u003cli\u003elogrotate 등의 수단을 이용해 크기가 무한정 커지지 않도록 제어해야 한다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eChildren\u003c/strong\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/notes/lmkaoriwaly8fn7xim6wnv0\"\u003e5 Modern Bash Scripting Techniques That Only A Few Programmers Know\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/yn68lbuog9rseo4kzfqz6sw\"\u003eA list of new(ish) command line tools\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e","noteIndex":{"id":"Iy0MoL0KnL55Br3AfTS2C","title":"Luke","desc":"","updated":1761796791487,"created":1644449449778,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"4e745570ca97988a0362cb939b760952","links":[{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"life-tips","position":{"start":{"line":41,"column":5,"offset":2603},"end":{"line":41,"column":29,"offset":2627},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"life-tips","anchorHeader":"wodenokoto"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2025","alias":"What I read in 2025","position":{"start":{"line":70,"column":3,"offset":4333},"end":{"line":70,"column":54,"offset":4384},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2025"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2024","alias":"2024","position":{"start":{"line":71,"column":5,"offset":4389},"end":{"line":71,"column":41,"offset":4425},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2024"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2023","alias":"2023","position":{"start":{"line":72,"column":5,"offset":4430},"end":{"line":72,"column":41,"offset":4466},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2023"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-read-in.2022","alias":"2022","position":{"start":{"line":73,"column":5,"offset":4471},"end":{"line":73,"column":41,"offset":4507},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-read-in.2022"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-struggled-brag-in","position":{"start":{"line":79,"column":3,"offset":4643},"end":{"line":79,"column":39,"offset":4679},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-struggled-brag-in"}}],"anchors":{"what-i-read-in-past":{"type":"header","text":"What I read in past","value":"what-i-read-in-past","line":74,"column":0,"depth":2}},"children":["zd4mq442jike0pr0wba1u3m","6hzeqsofq67gdk88flxlkhp","778ijii93yu5uwnrwmn5zi4","g1fngdjl25nes6fs3lip602","ZbdkdApFqLdks4Moq92R9","uoc5hhki3o4py15cesddu8q","9qf7j06jtdkm6rnx9ymvwb0","5zn10cvj7ajy2gh2is5nqmg","4qo9ma0z0yu1czns6pxl7y5","ok0e729ho7o09xetujkxc0m","GR5x8HnNFEN6fU2UBSEIK","yirtnlj8q24yutcf3ss1xqy","eq0wc6t7wl2wv221yb68ro4","7x2fnv4j6gxts08qk0jguny","ettkt3iClONnxpbGwBVLl","7l4knev6v613tbuoskvmbdg","hvh5bud6yp7dc89tuh95tr9","4fvoqrplw0cweo554usbjos","f8qsfql0a9v8thpeo82udfa","1swsbrhqi9jk41v9eodyi5q","SQqYupi6EFddTerBA8RRD","hjNeNc1F2JUh0lTWanH4h","qf0l4wbrc9jgooyzexmbq5v","uur1lkol353z9vfeqb3n5bv","cd9n1czq3ursgkby985wkmm","k1sr43vwnfqztwc0s43pkcf","wfde75rhdvq2yfa2zy2q6rv","rjcmdv60jokmbw6zoq8u2ef","ujapvww8o6v3kpmlhtryq4k","pkwewou9d5e8ystswn1j2b4"],"parent":null,"data":{},"body":"\nHi there 👋. I'm a Front-end developer.\n\n---\n\n- 단순함과 꾸준함은 가장 쉬우면서도 지키기 어려운 원칙.\n\n- 🥱 -\u003e 🤔💡🌱 - [On The Death of Daydreaming](https://www.afterbabel.com/p/on-the-death-of-daydreaming)\n  - boredom -\u003e easy fun -\u003e art -\u003e profit?\n\n\u003e I've often described my motivation for building software to others using imagery: I like to go find a secluded beach, build a large, magnificent sand castle, and then walk away. Will anyone notice? Probably not. Will the waves eventually destroy it? Yep. Did I still get immense satisfaction? Absolutely. - [aliasxneo](https://news.ycombinator.com/item?id=41497113)\n\n\u003e We love to see the process, not just the result. The imperfections in your work can be beautiful if they show your struggle for perfection, not a lack of care. - [ralphammer](https://ralphammer.com/is-perfection-boring/)\n\n\u003e Simplicity, even if it sacrifices some ideal functionality has better survival characteristics than the-right-thing. - [The Rise of Worse is Better](https://www.dreamsongs.com/RiseOfWorseIsBetter.html)\n\n\u003e [Roberto Blake was talking about making 100 crappy videos](https://www.youtube.com/watch?v=OnUBaQ1Sp_E) to get better over time. Putting in the reps and improving a little bit each time.\n\u003e\n\u003e Putting in the work without expecting any external reward at first (eg views, followers, likes, etc) will pay off in the long run. - [100 Scrappy Things](https://www.florin-pop.com/blog/100-scrappy-things/)\n\n\u003e Make the difficult habitual, the habitual easy, and the easy beautiful. - [Constantin S. Stanislavski](https://www.goodreads.com/quotes/7102271-make-the-difficult-habitual-the-habitual-easy-and-the-easy)\n\n\u003e A good match is a **structured** dance, where players aim to **score** while they are following well-defined **rules**. This **freedom within a structure** is what makes it fun. - [ralphammer](https://ralphammer.com/how-to-get-started/)\n\n- [Pivot Points](https://longform.asmartbear.com/pivot-points/)\n\n  - non-judgmental aspects of personality that can be strengths in some contexts and weaknesses in others\n  - Pivot Points are fixed in the short term\n\n- [Hedged Bets](https://longform.asmartbear.com/predict-the-future/#hedged-bets)\n  - trading slightly less maximum upside for predictable, net-positive outcomes.\n\n\u003e “Motivation often comes after starting, not before. Action produces momentum.”\n\u003e [When you start a new habit, it should take less than two minutes to do.](https://jamesclear.com/how-to-stop-procrastinating)\n\u003e\n\u003e - James Clear\n\n\u003e Focus is more about **not** keeping busy when you need to wait for something.  \n\u003e Eat the boredom for a minute.\n\u003e\n\u003e - [[life-tips#wodenokoto]]\n\n\u003e [4 minutes run hard enough to push heart rate to 90%, 3 minutes recover, repeat 4 times](https://news.ycombinator.com/item?id=34213181)\n\u003e\n\u003e - https://www.ntnu.edu/cerg/advice\n\u003e - [Get running with Couch to 5K](https://www.nhs.uk/live-well/exercise/running-and-aerobic-exercises/get-running-with-couch-to-5k/)\n\n\u003e [recommended routine - bodyweightfitness](https://www.reddit.com/r/bodyweightfitness/wiki/kb/recommended_routine/) - I Don't Have This Much Time!\n\u003e\n\u003e - Don't workout at all (saves anywhere from 20 to 60 minutes, but really, really, really, really, really, really, really, really, really not recommended)\n\n\u003e 도무지 읽히지 않는 책 앞에서 내가 택한 방법은 펼쳐진 페이지 앞에서 멍때리기이다. 다르게 표현하면 이렇다. 펼쳐진 두 페이지 앞에서 오래 머물기.\n\u003e\n\u003e 책을 펼쳐놓는 것으로 충분하다. 읽지 못해도 좋다. 매일 정해진 진도를 나가야 하는 학교 수업이 아니니까. 하지만 읽지 않아도 괜찮다고 해서 펼쳐두지조차 않으면 곤란하다. 가능한 한 자주 책을 펼쳐두도록 하자. 전혀 읽지 않고 멍하니 바라보고 있다가 다시 덮게 되더라도\n\u003e\n\u003e - 막막한 독서. 시로군. P.10~13\n\n\u003e I think it should be everyone's primary focus to sleep well, drink water, get outside, get active, and eat generally decently. I hate to say it, but if you're not eating a good amount of vegetables and fruit, decent protein, sleep, etc, no amount of XYZ will catch up to that detriment. - [CE02](https://news.ycombinator.com/item?id=35056071)\n\n\u003e My real battle is doing good versus doing nothing. - [Deirdre Sullivan](https://www.npr.org/2005/08/08/4785079/always-go-to-the-funeral)\n\n[Kind Engineering](https://kind.engineering/) - How To Engineer Kindness\n\n\u003e Sometimes magic is just someone spending more time on something than anyone else might reasonably expect. - [Teller](https://www.goodreads.com/quotes/6641527-sometimes-magic-is-just-someone-spending-more-time-on-something)\n\n---\n\n## What I read in past\n\n- [[What I read in 2025|journal.what-i-read-in.2025]]\n  - [[2024|journal.what-i-read-in.2024]]\n  - [[2023|journal.what-i-read-in.2023]]\n  - [[2022|journal.what-i-read-in.2022]]\n- 📝 [Gists](https://gist.github.com/Luke-SNAW)\n- 📜 [Journals](https://luke-snaw.github.io/Luke-SNAW__netlify-CMS.github.io/)\n\n---\n\n- [[journal.what-i-struggled-brag-in]]\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":false,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.115.0","enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Luke SNAW","description":"Personal knowledge space"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://luke-snaw.github.io/","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"z8iu36gfcu6tok0rnwtawg0"},"buildId":"vOE8u-mg___OsOsz4tjEg","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>