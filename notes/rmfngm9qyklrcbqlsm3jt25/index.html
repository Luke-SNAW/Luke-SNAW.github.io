<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Kobold Letters</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="Kobold Letters"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://luke-snaw.github.io//notes/rmfngm9qyklrcbqlsm3jt25/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="4/5/2024"/><meta property="article:modified_time" content="4/5/2024"/><link rel="canonical" href="https://luke-snaw.github.io//notes/rmfngm9qyklrcbqlsm3jt25/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d8e0603730b15a3.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/wirstT2ztC8OQsbzKjhvw/_buildManifest.js" defer=""></script><script src="/_next/static/wirstT2ztC8OQsbzKjhvw/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="kobold-letters">Kobold Letters<a aria-hidden="true" class="anchor-heading icon-link" href="#kobold-letters"></a></h1>
<p>Why HTML emails are a risk to your organization</p>
<blockquote>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/">https://lutrasecurity.com/en/articles/kobold-letters/</a></p>
</blockquote>
<p>Anyone who has had to deal with HTML emails on a technical level has probably reached the point where they wanted to quit their job or just set fire to all the mail clients due to their inconsistent implementations. But HTML emails are not just a source of frustration, they can also be a serious security risk.</p>
<p>Imagine you receive an email forwarded by your manager asking you to wire a large sum of money to a bank account. Of course, you have heard of CEO fraud, so you double-check that the email really comes from your manager. It does, and it may even be cryptographically signed – if you do that in your company. However, you are still not convinced, so you call your manager to ensure that the email is legit. He confirms, so you transfer the money.</p>
<p>Yet this would be the end of the article if this wasn’t a <em>scam</em>. So what went wrong?</p>
<h2 id="kobold-letters-1">Kobold letters<a aria-hidden="true" class="anchor-heading icon-link" href="#kobold-letters-1"></a></h2>
<p>The email your manager received and forwarded to you was something completely innocent, such as a potential customer asking a few questions. All that email was supposed to achieve was being forwarded to you. However, the moment the email appeared in your inbox, it changed. The innocent pretext disappeared and the real phishing email became visible. A phishing email you <em>had</em> to trust because you knew the sender and they even confirmed that they had forwarded it to you.</p>
<p>This attack is possible because most email clients allow CSS to be used to style HTML emails. When an email is forwarded, the position of the original email in the DOM usually changes, allowing for CSS rules to be selectively applied only when an email has been forwarded.</p>
<p>An attacker can use this to include elements in the email that appear or disappear depending on the context in which the email is viewed. Because they are usually invisible, only appear in certain circumstances, and can be used for all sorts of mischief, I’ll refer to these elements as <em>kobold letters</em>, after the elusive sprites of mythology.</p>
<p>This affects all types of email clients and webmailers that support HTML email. So pretty much all of them. For the moment, however, I’ll focus on selected clients to demonstrate the problem, and leave it to others (or future me) to extend the principle to other clients.</p>
<h3 id="thunderbird">Thunderbird<a aria-hidden="true" class="anchor-heading icon-link" href="#thunderbird"></a></h3>
<hr>
<p>This issue was reported to Mozilla on 05.03.2024.<br>
The planned release date and a draft of the following section were communicated to Mozilla on 20.03.2024.<br>
Possible mitigations have been discussed but will not be implemented until a later date.</p>
<hr>
<p>Exploiting this in Thunderbird is fairly straightforward. Thunderbird wraps emails in <code>&#x3C;div class="moz-text-html" lang="x-unicode">&#x3C;/div></code> and leaves them otherwise unchanged, making it a good example to demonstrate the principle. When forwarding an email, the quoted email will be enclosed in another <code>&#x3C;div>&#x3C;/div></code>, moving it down one level in the DOM.</p>
<p>Taking this into account leads to the following proof of concept:</p>
<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
      <span class="token selector"><span class="token class">.kobold-letter</span></span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token selector"><span class="token class">.moz-text-html</span> <span class="token combinator">></span> div <span class="token combinator">></span> <span class="token class">.kobold-letter</span></span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block <span class="token important">!important</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>This text is always visible.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kobold-letter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text will only appear after forwarding.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>The email contains two paragraphs, one that has no styling and should always be visible, and one that is hidden with <code>display: none;</code>. This is how it looks when the email is displayed in Thunderbird:</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-1.png">A simple email containing the sentence "This text is always visible."</a></p>
<h5 id="this-email-may-look-harmless">This email may look harmless...<a aria-hidden="true" class="anchor-heading icon-link" href="#this-email-may-look-harmless"></a></h5>
<p>As expected, only the paragraph “<em>This text is always visible.</em>” is shown. However, when we forward the email, the second paragraph becomes suddenly visible. Albeit only to the new recipient – the original recipient who forwarded the email remains unaware.</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-2.png">The sentence "This text will only appear after forwarding." is now visible.</a></p>
<h5 id="until-it-has-been-forwarded">...until it has been forwarded.<a aria-hidden="true" class="anchor-heading icon-link" href="#until-it-has-been-forwarded"></a></h5>
<p>Because we know exactly where each element will be in the DOM relative to <code>.moz-text-html</code>, and because we control the CSS, we can easily hide and show any part of the email, changing the content completely. If we style the kobold letter as an overlay, we can not only affect the forwarded email, but also (for example) replace any comments your manager might have had on the original mail, opening up even more opportunities for phishing.</p>
<h3 id="outlook-on-the-web">Outlook on the web<a aria-hidden="true" class="anchor-heading icon-link" href="#outlook-on-the-web"></a></h3>
<hr>
<p>This issue was reported to Microsoft on 05.03.2024.<br>
The planned release date and a draft of the following section were communicated to Microsoft on 20.03.2024.<br>
The report was marked as closed by Microsoft on 26.03.204 after deciding not to take any immediate action.</p>
<hr>
<p>In <em>Outlook on the web</em> (OWA) the situation is slightly more complicated, as it is a webmailer. Emails are contained in <code>&#x3C;div class="rps_78fa">&#x3C;/div></code>, but the exact class name will change. To prevent the CSS of emails to affect the style of the webmailer, Outlook modifies the email by prefixing all ids and classes with <code>x_</code> and adjust the CSS accordingly.</p>
<p>Considering all this, we get the following proof of concept:</p>
<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
      <span class="token selector"><span class="token class">.kobold-letter</span></span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token selector">body <span class="token combinator">></span> div <span class="token combinator">></span> <span class="token class">.kobold-letter</span></span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block <span class="token important">!important</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>This text is always visible.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kobold-letter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text will only appear after forwarding.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>When the email is displayed by OWA, the CSS will look like this:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">&#x3C;!--
  <span class="token class">.rps_78fa</span> <span class="token class">.x_kobold-letter</span></span>
  	<span class="token punctuation">{</span><span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.rps_78fa</span> <span class="token combinator">></span> div <span class="token combinator">></span> div <span class="token combinator">></span> <span class="token class">.x_kobold-letter</span></span>
  	<span class="token punctuation">{</span><span class="token property">display</span><span class="token punctuation">:</span>block<span class="token important">!important</span><span class="token punctuation">}</span>
  -->
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p>The email will be displayed as expected:</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-1.png">A simple email containing the sentence "This text is always visible."</a></p>
<h4 id="this-email-could-ask-for-a-harmless-favour">This email could ask for a harmless favour...<a aria-hidden="true" class="anchor-heading icon-link" href="#this-email-could-ask-for-a-harmless-favour"></a></h4>
<p>After forwarding, the kobold letter will be enclosed by another <code>&#x3C;div></code> and the CSS will be updated again:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
  <span class="token selector">&#x3C;!--
  <span class="token class">.rps_78fa</span> <span class="token class">.x_x_kobold-letter</span></span>
  	<span class="token punctuation">{</span><span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.rps_78fa</span> div <span class="token combinator">></span> div <span class="token combinator">></span> <span class="token class">.x_x_kobold-letter</span></span>
  	<span class="token punctuation">{</span><span class="token property">display</span><span class="token punctuation">:</span>block<span class="token important">!important</span><span class="token punctuation">}</span>
  -->
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p>Note that in the second rule, the <code>></code> between <code>.rps_78fa</code> and <code>div</code> has been dropped. This must be taken into account when creating more complicated selectors. Our proof of concept works as intended:</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-2.png">The sentence "This text will only appear after forwarding." is now visible.</a></p>
<h5 id="or-all-your-money">...or all your money.<a aria-hidden="true" class="anchor-heading icon-link" href="#or-all-your-money"></a></h5>
<p>The adjustments that OWA applies to the email do not interfere with the attack, but need to be considered when crafting a kobold letter. As we don’t have an easily recognizable anchor point, this can become a nuisance when trying to create a kobold letter that works for multiple clients at the same time.</p>
<h3 id="gmail">Gmail<a aria-hidden="true" class="anchor-heading icon-link" href="#gmail"></a></h3>
<hr>
<p>This issue was reported to Google on 05.03.2024.<br>
The planned release date and a draft of the following section were communicated to Google on 20.03.2024.</p>
<hr>
<p>So far, we could define kobold letters as elements that use CSS selectors to be shown or hidden depending on the context in which the email is displayed. By this definition, Gmail is technically not vulnerable to kobold letters because it strips all styling from the email when forwarding it.</p>
<p>This allows for an even simpler – albeit more limited – attack: It is now sufficient to hide the kobold letter with CSS, and it will automatically appear when forwarded. However, this does not allow the opposite behaviour, where the kobold letter is visible in the original email and invisible in the forwarded email.</p>
<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
      <span class="token selector"><span class="token class">.kobold-letter</span></span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token punctuation">></span></span>This text is always visible.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>kobold-letter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This text will only appear after forwarding.<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>This is aided by the fact that when the email is forwarded, the CSS is not removed until after it has been sent:</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-1.png">A simple email containing the sentence "This text is always visible."</a></p>
<h4 id="even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained">Even while commenting on the forwarded message, the illusion is maintained...<a aria-hidden="true" class="anchor-heading icon-link" href="#even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained"></a></h4>
<p>While the second paragraph was clearly not visible in the editor, it is in the resulting email:</p>
<p><a href="https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-2.png">The sentence "This text will only appear after forwarding." is now visible.</a></p>
<h4 id="but-in-the-end-it-will-betray-you">...but in the end it will betray you.<a aria-hidden="true" class="anchor-heading icon-link" href="#but-in-the-end-it-will-betray-you"></a></h4>
<p>While it is difficult to fix kobold letters in general without breaking too much, Google could mitigate the problem by removing the CSS already in the editor. This would at least allow the sender to detect the attack before forwarding the email.</p>
<h2 id="prior-work">Prior work<a aria-hidden="true" class="anchor-heading icon-link" href="#prior-work"></a></h2>
<p>The fact that this is possible in one way or another is neither surprising nor new. Therefore similar issues have been reported in the past:</p>
<ul>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1796180">Thunderbird - Modification of replied mail content without knowledge of replier of the mail using CSS</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1836276">Treat OpenPGP/SMIME email messages with certain CSS elements as unsigned</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1731198">Composition should use inline styling so that styles from quotes don’t leak into the message</a></li>
</ul>
<p>The novelty of kobold letters lies in the focus on a specific attack scenario, while looking at multiple email clients. This hopefully will help raise awareness of the risks associated with HTML emails and contribute to the discussion of what trade-offs are acceptable to mitigate these risks.</p>
<h2 id="outlook-not-the-software">Outlook (not the software)<a aria-hidden="true" class="anchor-heading icon-link" href="#outlook-not-the-software"></a></h2>
<p>Users can mitigate kobold letters by disabling HTML email altogether or viewing it in a restricted mode (e.g. “plain HTML” in Thunderbird). For email clients, it is more difficult to implement a mitigation, as preventing the use of <code>&#x3C;style></code><sup><a href="https://www.caniemail.com/features/html-style/">1</a></sup> would fix this, but would also break a lot of existing solutions in the email ecosystem. An implementation like the one Google already uses for Gmail could be a compromise that allows for stylized corporate newsletters while limiting the risks of HTML email.</p>
<p>Unfortunately, for the foreseeable future, it is sadly not realistic to expect email clients to implement robust mitigation. This means that it is up to the users to be aware of the dangers of HTML emails and to take the necessary precautions.</p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kobold-letters" title="Kobold letters">Kobold letters</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#thunderbird" title="Thunderbird">Thunderbird</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#this-email-may-look-harmless" title="This email may look harmless...">This email may look harmless...</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#until-it-has-been-forwarded" title="...until it has been forwarded.">...until it has been forwarded.</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#outlook-on-the-web" title="Outlook on the web">Outlook on the web</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#this-email-could-ask-for-a-harmless-favour" title="This email could ask for a harmless favour...">This email could ask for a harmless favour...</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#or-all-your-money" title="...or all your money.">...or all your money.</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#gmail" title="Gmail">Gmail</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained" title="Even while commenting on the forwarded message, the illusion is maintained...">Even while commenting on the forwarded message, the illusion is maintained...</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#but-in-the-end-it-will-betray-you" title="...but in the end it will betray you.">...but in the end it will betray you.</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#prior-work" title="Prior work">Prior work</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#outlook-not-the-software" title="Outlook (not the software)">Outlook (not the software)</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"rmfngm9qyklrcbqlsm3jt25","title":"Kobold Letters","desc":"","updated":1712289669134,"created":1712289415338,"custom":{},"fname":"dev.web.security.kobold-letters","type":"note","vault":{"fsPath":"vault"},"contentHash":"ec1b28e69b65e85a2385b323e9404d05","links":[],"anchors":{"kobold-letters":{"type":"header","text":"Kobold letters","value":"kobold-letters","line":18,"column":0,"depth":2},"thunderbird":{"type":"header","text":"Thunderbird","value":"thunderbird","line":28,"column":0,"depth":3},"this-email-may-look-harmless":{"type":"header","text":"This email may look harmless...","value":"this-email-may-look-harmless","line":68,"column":0,"depth":5},"until-it-has-been-forwarded":{"type":"header","text":"...until it has been forwarded.","value":"until-it-has-been-forwarded","line":74,"column":0,"depth":5},"outlook-on-the-web":{"type":"header","text":"Outlook on the web","value":"outlook-on-the-web","line":78,"column":0,"depth":3},"this-email-could-ask-for-a-harmless-favour":{"type":"header","text":"This email could ask for a harmless favour...","value":"this-email-could-ask-for-a-harmless-favour","line":131,"column":0,"depth":4},"or-all-your-money":{"type":"header","text":"...or all your money.","value":"or-all-your-money","line":150,"column":0,"depth":5},"gmail":{"type":"header","text":"Gmail","value":"gmail","line":154,"column":0,"depth":3},"even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained":{"type":"header","text":"Even while commenting on the forwarded message, the illusion is maintained...","value":"even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained","line":189,"column":0,"depth":4},"but-in-the-end-it-will-betray-you":{"type":"header","text":"...but in the end it will betray you.","value":"but-in-the-end-it-will-betray-you","line":195,"column":0,"depth":4},"prior-work":{"type":"header","text":"Prior work","value":"prior-work","line":199,"column":0,"depth":2},"outlook-not-the-software":{"type":"header","text":"Outlook (not the software)","value":"outlook-not-the-software","line":209,"column":0,"depth":2}},"children":[],"parent":"fm8vm79bnyq6fq1gu2oq2zr","data":{}},"body":"\u003ch1 id=\"kobold-letters\"\u003eKobold Letters\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#kobold-letters\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eWhy HTML emails are a risk to your organization\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/\"\u003ehttps://lutrasecurity.com/en/articles/kobold-letters/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAnyone who has had to deal with HTML emails on a technical level has probably reached the point where they wanted to quit their job or just set fire to all the mail clients due to their inconsistent implementations. But HTML emails are not just a source of frustration, they can also be a serious security risk.\u003c/p\u003e\n\u003cp\u003eImagine you receive an email forwarded by your manager asking you to wire a large sum of money to a bank account. Of course, you have heard of CEO fraud, so you double-check that the email really comes from your manager. It does, and it may even be cryptographically signed – if you do that in your company. However, you are still not convinced, so you call your manager to ensure that the email is legit. He confirms, so you transfer the money.\u003c/p\u003e\n\u003cp\u003eYet this would be the end of the article if this wasn’t a \u003cem\u003escam\u003c/em\u003e. So what went wrong?\u003c/p\u003e\n\u003ch2 id=\"kobold-letters-1\"\u003eKobold letters\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#kobold-letters-1\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe email your manager received and forwarded to you was something completely innocent, such as a potential customer asking a few questions. All that email was supposed to achieve was being forwarded to you. However, the moment the email appeared in your inbox, it changed. The innocent pretext disappeared and the real phishing email became visible. A phishing email you \u003cem\u003ehad\u003c/em\u003e to trust because you knew the sender and they even confirmed that they had forwarded it to you.\u003c/p\u003e\n\u003cp\u003eThis attack is possible because most email clients allow CSS to be used to style HTML emails. When an email is forwarded, the position of the original email in the DOM usually changes, allowing for CSS rules to be selectively applied only when an email has been forwarded.\u003c/p\u003e\n\u003cp\u003eAn attacker can use this to include elements in the email that appear or disappear depending on the context in which the email is viewed. Because they are usually invisible, only appear in certain circumstances, and can be used for all sorts of mischief, I’ll refer to these elements as \u003cem\u003ekobold letters\u003c/em\u003e, after the elusive sprites of mythology.\u003c/p\u003e\n\u003cp\u003eThis affects all types of email clients and webmailers that support HTML email. So pretty much all of them. For the moment, however, I’ll focus on selected clients to demonstrate the problem, and leave it to others (or future me) to extend the principle to other clients.\u003c/p\u003e\n\u003ch3 id=\"thunderbird\"\u003eThunderbird\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#thunderbird\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003eThis issue was reported to Mozilla on 05.03.2024.\u003cbr\u003e\nThe planned release date and a draft of the following section were communicated to Mozilla on 20.03.2024.\u003cbr\u003e\nPossible mitigations have been discussed but will not be implemented until a later date.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eExploiting this in Thunderbird is fairly straightforward. Thunderbird wraps emails in \u003ccode\u003e\u0026#x3C;div class=\"moz-text-html\" lang=\"x-unicode\"\u003e\u0026#x3C;/div\u003e\u003c/code\u003e and leaves them otherwise unchanged, making it a good example to demonstrate the principle. When forwarding an email, the quoted email will be enclosed in another \u003ccode\u003e\u0026#x3C;div\u003e\u0026#x3C;/div\u003e\u003c/code\u003e, moving it down one level in the DOM.\u003c/p\u003e\n\u003cp\u003eTaking this into account leads to the following proof of concept:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token doctype\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;!\u003c/span\u003e\u003cspan class=\"token doctype-tag\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"token name\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n      \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.kobold-letter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n      \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.moz-text-html\u003c/span\u003e \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token class\"\u003e.kobold-letter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e block \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text is always visible.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ekobold-letter\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text will only appear after forwarding.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe email contains two paragraphs, one that has no styling and should always be visible, and one that is hidden with \u003ccode\u003edisplay: none;\u003c/code\u003e. This is how it looks when the email is displayed in Thunderbird:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-1.png\"\u003eA simple email containing the sentence \"This text is always visible.\"\u003c/a\u003e\u003c/p\u003e\n\u003ch5 id=\"this-email-may-look-harmless\"\u003eThis email may look harmless...\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#this-email-may-look-harmless\"\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cp\u003eAs expected, only the paragraph “\u003cem\u003eThis text is always visible.\u003c/em\u003e” is shown. However, when we forward the email, the second paragraph becomes suddenly visible. Albeit only to the new recipient – the original recipient who forwarded the email remains unaware.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-2.png\"\u003eThe sentence \"This text will only appear after forwarding.\" is now visible.\u003c/a\u003e\u003c/p\u003e\n\u003ch5 id=\"until-it-has-been-forwarded\"\u003e...until it has been forwarded.\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#until-it-has-been-forwarded\"\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cp\u003eBecause we know exactly where each element will be in the DOM relative to \u003ccode\u003e.moz-text-html\u003c/code\u003e, and because we control the CSS, we can easily hide and show any part of the email, changing the content completely. If we style the kobold letter as an overlay, we can not only affect the forwarded email, but also (for example) replace any comments your manager might have had on the original mail, opening up even more opportunities for phishing.\u003c/p\u003e\n\u003ch3 id=\"outlook-on-the-web\"\u003eOutlook on the web\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#outlook-on-the-web\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003eThis issue was reported to Microsoft on 05.03.2024.\u003cbr\u003e\nThe planned release date and a draft of the following section were communicated to Microsoft on 20.03.2024.\u003cbr\u003e\nThe report was marked as closed by Microsoft on 26.03.204 after deciding not to take any immediate action.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eIn \u003cem\u003eOutlook on the web\u003c/em\u003e (OWA) the situation is slightly more complicated, as it is a webmailer. Emails are contained in \u003ccode\u003e\u0026#x3C;div class=\"rps_78fa\"\u003e\u0026#x3C;/div\u003e\u003c/code\u003e, but the exact class name will change. To prevent the CSS of emails to affect the style of the webmailer, Outlook modifies the email by prefixing all ids and classes with \u003ccode\u003ex_\u003c/code\u003e and adjust the CSS accordingly.\u003c/p\u003e\n\u003cp\u003eConsidering all this, we get the following proof of concept:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token doctype\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;!\u003c/span\u003e\u003cspan class=\"token doctype-tag\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"token name\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n      \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.kobold-letter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n      \u003cspan class=\"token selector\"\u003ebody \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token class\"\u003e.kobold-letter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e block \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text is always visible.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ekobold-letter\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text will only appear after forwarding.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhen the email is displayed by OWA, the CSS will look like this:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u0026#x3C;!--\n  \u003cspan class=\"token class\"\u003e.rps_78fa\u003c/span\u003e \u003cspan class=\"token class\"\u003e.x_kobold-letter\u003c/span\u003e\u003c/span\u003e\n  \t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003enone\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.rps_78fa\u003c/span\u003e \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token class\"\u003e.x_kobold-letter\u003c/span\u003e\u003c/span\u003e\n  \t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003eblock\u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  --\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe email will be displayed as expected:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-1.png\"\u003eA simple email containing the sentence \"This text is always visible.\"\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"this-email-could-ask-for-a-harmless-favour\"\u003eThis email could ask for a harmless favour...\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#this-email-could-ask-for-a-harmless-favour\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eAfter forwarding, the kobold letter will be enclosed by another \u003ccode\u003e\u0026#x3C;div\u003e\u003c/code\u003e and the CSS will be updated again:\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n  \u003cspan class=\"token selector\"\u003e\u0026#x3C;!--\n  \u003cspan class=\"token class\"\u003e.rps_78fa\u003c/span\u003e \u003cspan class=\"token class\"\u003e.x_x_kobold-letter\u003c/span\u003e\u003c/span\u003e\n  \t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003enone\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.rps_78fa\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e div \u003cspan class=\"token combinator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token class\"\u003e.x_x_kobold-letter\u003c/span\u003e\u003c/span\u003e\n  \t\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003eblock\u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  --\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNote that in the second rule, the \u003ccode\u003e\u003e\u003c/code\u003e between \u003ccode\u003e.rps_78fa\u003c/code\u003e and \u003ccode\u003ediv\u003c/code\u003e has been dropped. This must be taken into account when creating more complicated selectors. Our proof of concept works as intended:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-2.png\"\u003eThe sentence \"This text will only appear after forwarding.\" is now visible.\u003c/a\u003e\u003c/p\u003e\n\u003ch5 id=\"or-all-your-money\"\u003e...or all your money.\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#or-all-your-money\"\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cp\u003eThe adjustments that OWA applies to the email do not interfere with the attack, but need to be considered when crafting a kobold letter. As we don’t have an easily recognizable anchor point, this can become a nuisance when trying to create a kobold letter that works for multiple clients at the same time.\u003c/p\u003e\n\u003ch3 id=\"gmail\"\u003eGmail\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#gmail\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cp\u003eThis issue was reported to Google on 05.03.2024.\u003cbr\u003e\nThe planned release date and a draft of the following section were communicated to Google on 20.03.2024.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eSo far, we could define kobold letters as elements that use CSS selectors to be shown or hidden depending on the context in which the email is displayed. By this definition, Gmail is technically not vulnerable to kobold letters because it strips all styling from the email when forwarding it.\u003c/p\u003e\n\u003cp\u003eThis allows for an even simpler – albeit more limited – attack: It is now sufficient to hide the kobold letter with CSS, and it will automatically appear when forwarded. However, this does not allow the opposite behaviour, where the kobold letter is visible in the original email and invisible in the forwarded email.\u003c/p\u003e\n\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token doctype\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;!\u003c/span\u003e\u003cspan class=\"token doctype-tag\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"token name\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token style\"\u003e\u003cspan class=\"token language-css\"\u003e\n      \u003cspan class=\"token selector\"\u003e\u003cspan class=\"token class\"\u003e.kobold-letter\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003estyle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text is always visible.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;\u003c/span\u003ep\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003ekobold-letter\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eThis text will only appear after forwarding.\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ep\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ebody\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#x3C;/\u003c/span\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis is aided by the fact that when the email is forwarded, the CSS is not removed until after it has been sent:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-1.png\"\u003eA simple email containing the sentence \"This text is always visible.\"\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained\"\u003eEven while commenting on the forwarded message, the illusion is maintained...\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#even-while-commenting-on-the-forwarded-message-the-illusion-is-maintained\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eWhile the second paragraph was clearly not visible in the editor, it is in the resulting email:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-2.png\"\u003eThe sentence \"This text will only appear after forwarding.\" is now visible.\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"but-in-the-end-it-will-betray-you\"\u003e...but in the end it will betray you.\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#but-in-the-end-it-will-betray-you\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003eWhile it is difficult to fix kobold letters in general without breaking too much, Google could mitigate the problem by removing the CSS already in the editor. This would at least allow the sender to detect the attack before forwarding the email.\u003c/p\u003e\n\u003ch2 id=\"prior-work\"\u003ePrior work\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#prior-work\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe fact that this is possible in one way or another is neither surprising nor new. Therefore similar issues have been reported in the past:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1796180\"\u003eThunderbird - Modification of replied mail content without knowledge of replier of the mail using CSS\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1836276\"\u003eTreat OpenPGP/SMIME email messages with certain CSS elements as unsigned\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1731198\"\u003eComposition should use inline styling so that styles from quotes don’t leak into the message\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe novelty of kobold letters lies in the focus on a specific attack scenario, while looking at multiple email clients. This hopefully will help raise awareness of the risks associated with HTML emails and contribute to the discussion of what trade-offs are acceptable to mitigate these risks.\u003c/p\u003e\n\u003ch2 id=\"outlook-not-the-software\"\u003eOutlook (not the software)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#outlook-not-the-software\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eUsers can mitigate kobold letters by disabling HTML email altogether or viewing it in a restricted mode (e.g. “plain HTML” in Thunderbird). For email clients, it is more difficult to implement a mitigation, as preventing the use of \u003ccode\u003e\u0026#x3C;style\u003e\u003c/code\u003e\u003csup\u003e\u003ca href=\"https://www.caniemail.com/features/html-style/\"\u003e1\u003c/a\u003e\u003c/sup\u003e would fix this, but would also break a lot of existing solutions in the email ecosystem. An implementation like the one Google already uses for Gmail could be a compromise that allows for stylized corporate newsletters while limiting the risks of HTML email.\u003c/p\u003e\n\u003cp\u003eUnfortunately, for the foreseeable future, it is sadly not realistic to expect email clients to implement robust mitigation. This means that it is up to the users to be aware of the dangers of HTML emails and to take the necessary precautions.\u003c/p\u003e","noteIndex":{"id":"Iy0MoL0KnL55Br3AfTS2C","title":"Luke","desc":"","updated":1766965759366,"created":1644449449778,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"a724de3efd251cf89fe82a5860d9008b","links":[{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"life-tips","position":{"start":{"line":43,"column":5,"offset":2710},"end":{"line":43,"column":29,"offset":2734},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"life-tips","anchorHeader":"wodenokoto"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"read.2026.articles","alias":"What I read in 2026","position":{"start":{"line":72,"column":3,"offset":4440},"end":{"line":72,"column":45,"offset":4482},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"read.2026.articles"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"read.2025.articles","alias":"2025","position":{"start":{"line":73,"column":5,"offset":4487},"end":{"line":73,"column":32,"offset":4514},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"read.2025.articles"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"read.2024.articles","alias":"2024","position":{"start":{"line":74,"column":5,"offset":4519},"end":{"line":74,"column":32,"offset":4546},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"read.2024.articles"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"read.2023.articles","alias":"2023","position":{"start":{"line":75,"column":5,"offset":4551},"end":{"line":75,"column":32,"offset":4578},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"read.2023.articles"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"read.2022.articles","alias":"2022","position":{"start":{"line":76,"column":5,"offset":4583},"end":{"line":76,"column":32,"offset":4610},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"read.2022.articles"}},{"type":"wiki","from":{"fname":"root","id":"Iy0MoL0KnL55Br3AfTS2C","vaultName":"vault"},"value":"journal.what-i-struggled-brag-in","position":{"start":{"line":82,"column":3,"offset":4746},"end":{"line":82,"column":39,"offset":4782},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"journal.what-i-struggled-brag-in"}}],"anchors":{"what-i-read-in-past":{"type":"header","text":"What I read in past","value":"what-i-read-in-past","line":76,"column":0,"depth":2}},"children":["zd4mq442jike0pr0wba1u3m","6hzeqsofq67gdk88flxlkhp","778ijii93yu5uwnrwmn5zi4","g1fngdjl25nes6fs3lip602","ZbdkdApFqLdks4Moq92R9","uoc5hhki3o4py15cesddu8q","9qf7j06jtdkm6rnx9ymvwb0","5zn10cvj7ajy2gh2is5nqmg","4qo9ma0z0yu1czns6pxl7y5","ok0e729ho7o09xetujkxc0m","GR5x8HnNFEN6fU2UBSEIK","yirtnlj8q24yutcf3ss1xqy","eq0wc6t7wl2wv221yb68ro4","7x2fnv4j6gxts08qk0jguny","ettkt3iClONnxpbGwBVLl","7l4knev6v613tbuoskvmbdg","hvh5bud6yp7dc89tuh95tr9","4fvoqrplw0cweo554usbjos","f8qsfql0a9v8thpeo82udfa","1swsbrhqi9jk41v9eodyi5q","SQqYupi6EFddTerBA8RRD","hjNeNc1F2JUh0lTWanH4h","qf0l4wbrc9jgooyzexmbq5v","o7xruzrah5wzqetottecss7","z1zo2mp6ddji5p317i4x9xw","v06c2tjelh341x4resa50fh","0yqesk4rcffwgyuab5x8rfa","sy2vkbtyu671chkvgn1yt8j","ufixpmxoydiccoh59kphrib","alswadkx4wb05y1z9iwfzfv","1daut9dpw70xd0zh5a7j5p4"],"parent":null,"data":{},"body":"\nHi there 👋. I'm a Front-end developer.\n\n---\n\n- 현실은 인간의 연산으로 완전히 파악할 수 없는 복잡계. 주어진 상황과 능력으로 할 수 있는 최선의 적응은 단순함과 꾸준함.\n\n  - 파산을 면하는 선에서 여러가지를 해보고 자신에게 맞는 걸 위주로 꾸준히. 그를 위해 단순, 편안, 쾌적함이 필요.\n\n- 🥱 -\u003e 🤔💡🌱 - [On The Death of Daydreaming](https://www.afterbabel.com/p/on-the-death-of-daydreaming)\n  - boredom -\u003e easy fun -\u003e art -\u003e profit?\n\n\u003e I've often described my motivation for building software to others using imagery: I like to go find a secluded beach, build a large, magnificent sand castle, and then walk away. Will anyone notice? Probably not. Will the waves eventually destroy it? Yep. Did I still get immense satisfaction? Absolutely. - [aliasxneo](https://news.ycombinator.com/item?id=41497113)\n\n\u003e We love to see the process, not just the result. The imperfections in your work can be beautiful if they show your struggle for perfection, not a lack of care. - [ralphammer](https://ralphammer.com/is-perfection-boring/)\n\n\u003e Simplicity, even if it sacrifices some ideal functionality has better survival characteristics than the-right-thing. - [The Rise of Worse is Better](https://www.dreamsongs.com/RiseOfWorseIsBetter.html)\n\n\u003e [Roberto Blake was talking about making 100 crappy videos](https://www.youtube.com/watch?v=OnUBaQ1Sp_E) to get better over time. Putting in the reps and improving a little bit each time.\n\u003e\n\u003e Putting in the work without expecting any external reward at first (eg views, followers, likes, etc) will pay off in the long run. - [100 Scrappy Things](https://www.florin-pop.com/blog/100-scrappy-things/)\n\n\u003e Make the difficult habitual, the habitual easy, and the easy beautiful. - [Constantin S. Stanislavski](https://www.goodreads.com/quotes/7102271-make-the-difficult-habitual-the-habitual-easy-and-the-easy)\n\n\u003e A good match is a **structured** dance, where players aim to **score** while they are following well-defined **rules**. This **freedom within a structure** is what makes it fun. - [ralphammer](https://ralphammer.com/how-to-get-started/)\n\n- [Pivot Points](https://longform.asmartbear.com/pivot-points/)\n\n  - non-judgmental aspects of personality that can be strengths in some contexts and weaknesses in others\n  - Pivot Points are fixed in the short term\n\n- [Hedged Bets](https://longform.asmartbear.com/predict-the-future/#hedged-bets)\n  - trading slightly less maximum upside for predictable, net-positive outcomes.\n\n\u003e “Motivation often comes after starting, not before. Action produces momentum.”\n\u003e [When you start a new habit, it should take less than two minutes to do.](https://jamesclear.com/how-to-stop-procrastinating)\n\u003e\n\u003e - James Clear\n\n\u003e Focus is more about **not** keeping busy when you need to wait for something.  \n\u003e Eat the boredom for a minute.\n\u003e\n\u003e - [[life-tips#wodenokoto]]\n\n\u003e [4 minutes run hard enough to push heart rate to 90%, 3 minutes recover, repeat 4 times](https://news.ycombinator.com/item?id=34213181)\n\u003e\n\u003e - https://www.ntnu.edu/cerg/advice\n\u003e - [Get running with Couch to 5K](https://www.nhs.uk/live-well/exercise/running-and-aerobic-exercises/get-running-with-couch-to-5k/)\n\n\u003e [recommended routine - bodyweightfitness](https://www.reddit.com/r/bodyweightfitness/wiki/kb/recommended_routine/) - I Don't Have This Much Time!\n\u003e\n\u003e - Don't workout at all (saves anywhere from 20 to 60 minutes, but really, really, really, really, really, really, really, really, really not recommended)\n\n\u003e 도무지 읽히지 않는 책 앞에서 내가 택한 방법은 펼쳐진 페이지 앞에서 멍때리기이다. 다르게 표현하면 이렇다. 펼쳐진 두 페이지 앞에서 오래 머물기.\n\u003e\n\u003e 책을 펼쳐놓는 것으로 충분하다. 읽지 못해도 좋다. 매일 정해진 진도를 나가야 하는 학교 수업이 아니니까. 하지만 읽지 않아도 괜찮다고 해서 펼쳐두지조차 않으면 곤란하다. 가능한 한 자주 책을 펼쳐두도록 하자. 전혀 읽지 않고 멍하니 바라보고 있다가 다시 덮게 되더라도\n\u003e\n\u003e - 막막한 독서. 시로군. P.10~13\n\n\u003e I think it should be everyone's primary focus to sleep well, drink water, get outside, get active, and eat generally decently. I hate to say it, but if you're not eating a good amount of vegetables and fruit, decent protein, sleep, etc, no amount of XYZ will catch up to that detriment. - [CE02](https://news.ycombinator.com/item?id=35056071)\n\n\u003e My real battle is doing good versus doing nothing. - [Deirdre Sullivan](https://www.npr.org/2005/08/08/4785079/always-go-to-the-funeral)\n\n[Kind Engineering](https://kind.engineering/) - How To Engineer Kindness\n\n\u003e Sometimes magic is just someone spending more time on something than anyone else might reasonably expect. - [Teller](https://www.goodreads.com/quotes/6641527-sometimes-magic-is-just-someone-spending-more-time-on-something)\n\n---\n\n## What I read in past\n\n- [[What I read in 2026|read.2026.articles]]\n  - [[2025|read.2025.articles]]\n  - [[2024|read.2024.articles]]\n  - [[2023|read.2023.articles]]\n  - [[2022|read.2022.articles]]\n- 📝 [Gists](https://gist.github.com/Luke-SNAW)\n- 📜 [Journals](https://luke-snaw.github.io/Luke-SNAW__netlify-CMS.github.io/)\n\n---\n\n- [[journal.what-i-struggled-brag-in]]\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":false,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.115.0","enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Luke SNAW","description":"Personal knowledge space"},"github":{"enableEditLink":false,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://luke-snaw.github.io/","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"rmfngm9qyklrcbqlsm3jt25"},"buildId":"wirstT2ztC8OQsbzKjhvw","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>